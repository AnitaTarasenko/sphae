[2023:11:23 09:46:30] Copying system default config to ../nanopore/nanoporeSDSU.spae.out/sphae.config.yaml
[2023:11:23 09:46:30] Updating config file with new values
[2023:11:23 09:46:30] Writing config file to ../nanopore/nanoporeSDSU.spae.out/sphae.config.yaml
[2023:11:23 09:46:30] ------------------
[2023:11:23 09:46:30] | Runtime config |
[2023:11:23 09:46:30] ------------------

args:
  db_dir: null
  input: null
  output: null
  sequencing: null
db:
  models: https://zenodo.org/record/8198288/files/phynteny_models_v0.1.11.tar.gz
  pfam: ftp://ftp.ebi.ac.uk/pub/databases/Pfam/releases/
  pfam_file: Pfam35.0/Pfam-A.hmm.gz
params:
  flye: --nano-hq
  genomeSize: 44k
  medaka: r1041_e82_400bps_sup_v4.2.0
resources:
  bigjob:
    cpu: 32
    mem: 64000
    time: 480
  smalljob:
    cpu: 8
    mem: 16000
    time: 480
sphae:
  args:
    _input: ../nanopore/nanopore_sequences_SRA_bact
    conda_prefix: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda
    configfile: ../nanopore/nanoporeSDSU.spae.out/sphae.config.yaml
    db_dir: null
    host: null
    log: ../nanopore/nanoporeSDSU.spae.out/sphae.log
    output: ../nanopore/nanoporeSDSU.spae.out
    profile: null
    sequencing: longread
    snake_args:
    - -k
    snake_default:
    - --rerun-incomplete
    - --printshellcmds
    - --nolock
    - --show-failed-logs
    system_config: /scratch/user/nala0006/spae-paper/sphae/sphae/config/config.yaml
    temp_dir: null
    threads: 64
    use_conda: true
trimnami:
  host: null
  qc:
    subsample: --bases 100M

[2023:11:23 09:46:30] ---------------------
[2023:11:23 09:46:30] | Snakemake command |
[2023:11:23 09:46:30] ---------------------

snakemake -s /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/Snakefile --configfile ../nanopore/nanoporeSDSU.spae.out/sphae.config.yaml --cores 64 --use-conda --conda-prefix /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda --rerun-incomplete --printshellcmds --nolock --show-failed-logs -k
Config file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/../config/config.yaml is extended by additional config specified via the command line.
/home/nala0006/miniconda3/envs/sphae/lib/python3.11/site-packages/metasnek/fastq_finder.py:66: Warning: Possible orphaned paired read detected for Ecoli_33_1.fastq with tag _1.
  warnings.warn(
/home/nala0006/miniconda3/envs/sphae/lib/python3.11/site-packages/metasnek/fastq_finder.py:66: Warning: Possible orphaned paired read detected for CS-1_1.fastq with tag _1.
  warnings.warn(
/home/nala0006/miniconda3/envs/sphae/lib/python3.11/site-packages/metasnek/fastq_finder.py:66: Warning: Possible orphaned paired read detected for CS-2_12_2.fastq with tag _2.
  warnings.warn(
/home/nala0006/miniconda3/envs/sphae/lib/python3.11/site-packages/attrmap/attrmap.py:424: UserWarning: To reduce 'problematic' attributes, `keys` is deprecated, use `attrmap.utils.get_keys` instead.
  warn("To reduce 'problematic' attributes, "
Building DAG of jobs...
/home/nala0006/miniconda3/lib/python3.9/site-packages/requests/__init__.py:109: RequestsDependencyWarning: urllib3 (1.26.9) or chardet (5.2.0)/charset_normalizer (2.0.12) doesn't match a supported version!
  warnings.warn(
Creating conda environment sphae/workflow/envs/viralverify.yaml...
Downloading and installing remote packages.
Environment for /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/envs/viralverify.yaml created (location: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_)
Creating conda environment sphae/workflow/envs/trimnami.yaml...
Downloading and installing remote packages.
Environment for /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/envs/trimnami.yaml created (location: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_)
Creating conda environment sphae/workflow/envs/samtools.yaml...
Downloading and installing remote packages.
Environment for /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/envs/samtools.yaml created (location: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_)
Creating conda environment sphae/workflow/envs/medaka.yaml...
Downloading and installing remote packages.
Environment for /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/envs/medaka.yaml created (location: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_)
Creating conda environment sphae/workflow/envs/flye.yaml...
Downloading and installing remote packages.
Environment for /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/envs/flye.yaml created (location: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_)
Creating conda environment sphae/workflow/envs/graph.yaml...
Downloading and installing remote packages.
Environment for /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/envs/graph.yaml created (location: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_)
Using shell: /usr/bin/bash
Provided cores: 64
Rules claiming more threads will be scaled down.
Job stats:
job                         count
------------------------  -------
all                             1
checkv_flye_nano               63
components_flye_nano           63
flye                           63
genomes_extract_flye           63
genomes_flye                   63
join_assembly_stats_flye       63
medaka                         63
pharokka_flye                  63
phynteny_run_nanopore          63
rename_contigs_flye            63
summarize_longread             63
trimnami                        1
viralverify_flye_nano          63
write_samples_tsv               1
total                         759

Select jobs to execute...

[Thu Nov 23 09:55:57 2023]
localrule write_samples_tsv:
    output: ../nanopore/nanoporeSDSU.spae.out/temp/samples.reads.tsv
    jobid: 2
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/temp/samples.reads.tsv
    resources: tmpdir=/local/nala0006/2279907

Config file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/../config/config.yaml is extended by additional config specified via the command line.
/home/nala0006/miniconda3/envs/sphae/lib/python3.11/site-packages/metasnek/fastq_finder.py:66: Warning: Possible orphaned paired read detected for CS-1_1.fastq with tag _1.
  warnings.warn(
/home/nala0006/miniconda3/envs/sphae/lib/python3.11/site-packages/metasnek/fastq_finder.py:66: Warning: Possible orphaned paired read detected for Ecoli_33_1.fastq with tag _1.
  warnings.warn(
/home/nala0006/miniconda3/envs/sphae/lib/python3.11/site-packages/metasnek/fastq_finder.py:66: Warning: Possible orphaned paired read detected for CS-2_12_2.fastq with tag _2.
  warnings.warn(
/home/nala0006/miniconda3/envs/sphae/lib/python3.11/site-packages/attrmap/attrmap.py:424: UserWarning: To reduce 'problematic' attributes, `keys` is deprecated, use `attrmap.utils.get_keys` instead.
  warn("To reduce 'problematic' attributes, "
Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 64
Rules claiming more threads will be scaled down.
Select jobs to execute...
[Thu Nov 23 09:55:58 2023]
Finished job 2.
1 of 759 steps (0.1%) done
Select jobs to execute...

[Thu Nov 23 09:55:58 2023]
rule trimnami:
    input: ../nanopore/nanoporeSDSU.spae.out/temp/samples.reads.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_28_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_06_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_35_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_24_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_13_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_30_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bs_13_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_20_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_03_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_07_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_09_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_4_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_02_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_3_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_26_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_14_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_7_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_11_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_13_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_25_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_10_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Lg_25_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_14_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_16_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_24_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_17_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_01_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_33_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_1_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_6_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_29_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_12_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_39_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_32_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_31_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_6_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_23_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_10_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_37_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_03_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_15_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_15_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_9_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_36_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_12_2_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_8_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_13_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_07_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_4_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_34_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_09_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_04_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_27_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_05_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_33_1_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_18_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_18_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_06_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_19_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_3_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_05_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_12_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_19_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/logs/trimnami.log
    jobid: 1
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/trimnami_paired.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_13_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_15_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bs_13_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Lg_25_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_02_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_01_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_18_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_20_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_7_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_13_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_25_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_19_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_27_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_03_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_8_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_28_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_12_2_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_31_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_16_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_03_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_33_1_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_23_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_4_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_19_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_12_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_36_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_1_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_6_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_34_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_3_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_24_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_06_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_17_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_14_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_9_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_13_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_15_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_24_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_26_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_32_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_35_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_37_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_07_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_10_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_05_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_14_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_07_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_39_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_29_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_6_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_30_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_12_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_06_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_4_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_33_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_10_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_3_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_11_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_09_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_04_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_05_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_09_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_18_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/temp/samples.reads.tsv
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        trimnami run             --configfile ../nanopore/nanoporeSDSU.spae.out/sphae.config.yaml             --reads ../nanopore/nanoporeSDSU.spae.out/temp/samples.reads.tsv             --output ../nanopore/nanoporeSDSU.spae.out/PROCESSING             --subsample             filtlong                                       --log ../nanopore/nanoporeSDSU.spae.out/logs/trimnami.log
        
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_
[2023:11:23 09:55:58] Config file ../nanopore/nanoporeSDSU.spae.out/sphae.config.yaml already exists. Using existing config file.
[2023:11:23 09:55:58] Updating config file with new values
[2023:11:23 09:55:58] Writing config file to ../nanopore/nanoporeSDSU.spae.out/sphae.config.yaml
[2023:11:23 09:55:58] ------------------
[2023:11:23 09:55:58] | Runtime config |
[2023:11:23 09:55:58] ------------------

args:
  db_dir: null
  input: null
  output: null
  sequencing: null
db:
  models: https://zenodo.org/record/8198288/files/phynteny_models_v0.1.11.tar.gz
  pfam: ftp://ftp.ebi.ac.uk/pub/databases/Pfam/releases/
  pfam_file: Pfam35.0/Pfam-A.hmm.gz
params:
  flye: --nano-hq
  genomeSize: 44k
  medaka: r1041_e82_400bps_sup_v4.2.0
resources:
  bigjob:
    cpu: 32
    mem: 64000
    time: 480
  smalljob:
    cpu: 8
    mem: 16000
    time: 480
sphae:
  args:
    _input: ../nanopore/nanopore_sequences_SRA_bact
    conda_prefix: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda
    configfile: ../nanopore/nanoporeSDSU.spae.out/sphae.config.yaml
    db_dir: null
    host: null
    log: ../nanopore/nanoporeSDSU.spae.out/sphae.log
    output: ../nanopore/nanoporeSDSU.spae.out
    profile: null
    sequencing: longread
    snake_args:
    - -k
    snake_default:
    - --rerun-incomplete
    - --printshellcmds
    - --nolock
    - --show-failed-logs
    system_config: /scratch/user/nala0006/spae-paper/sphae/sphae/config/config.yaml
    temp_dir: null
    threads: 64
    use_conda: true
trimnami:
  args:
    fasta: false
    fastqc: false
    host: null
    log: ../nanopore/nanoporeSDSU.spae.out/logs/trimnami.log
    minimap: sr
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING
    reads: ../nanopore/nanoporeSDSU.spae.out/temp/samples.reads.tsv
    subsample: true
  host: null
  qc:
    subsample: --bases 100M

[2023:11:23 09:55:58] ---------------------
[2023:11:23 09:55:58] | Snakemake command |
[2023:11:23 09:55:58] ---------------------

snakemake -s /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/Snakefile --configfile ../nanopore/nanoporeSDSU.spae.out/sphae.config.yaml --cores 8 --use-conda --conda-prefix /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda --rerun-incomplete --printshellcmds --nolock --show-failed-logs filtlong
/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/Snakefile:33: SyntaxWarning: invalid escape sequence '\.'
  include: os.path.join("rules", "preflight.smk")
/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/Snakefile:34: SyntaxWarning: invalid escape sequence '\.'
  include: os.path.join("rules", "hostRemoval.smk")
Config file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/../config/config.yaml is extended by additional config specified via the command line.
Config file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/../config/system_config.yaml is extended by additional config specified via the command line.
Building DAG of jobs...
Creating conda environment sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/envs/rasusa.yaml...
Downloading and installing remote packages.
Environment for /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/envs/rasusa.yaml created (location: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_)
Creating conda environment sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/envs/filtlong.yaml...
Downloading and installing remote packages.
Environment for /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/envs/filtlong.yaml created (location: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_)
Using shell: /usr/bin/bash
Provided cores: 8
Rules claiming more threads will be scaled down.
Job stats:
job                count
---------------  -------
filtlong               1
filtlong_single       63
rasusa                63
sample_manifest        1
save_output           63
total                191

Select jobs to execute...

[Thu Nov 23 09:56:23 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Bf_10.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_10_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bf_10.log
    jobid: 118
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Bf_10.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_10_S.fastq.gz
    wildcards: sample=Bf_10
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Bf_10.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bf_10.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_10_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 09:57:20 2023]
Finished job 118.
1 of 191 steps (1%) done
Select jobs to execute...

[Thu Nov 23 09:57:20 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_10_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_10_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bf_10_S.log
    jobid: 117
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Bf_10_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_10_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_10_S.fastq.gz
    wildcards: dir=filtlong, file=Bf_10_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_10_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_10_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_10_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bf_10_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_10_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 09:57:53 2023]
Finished job 117.
2 of 191 steps (1%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_10_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 09:57:53 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_10_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_10_S.subsampled.fastq.gz
    jobid: 116
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_10_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_10_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Bf_10_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_10_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_10_S.subsampled.fastq.gz

[Thu Nov 23 09:57:53 2023]
localrule sample_manifest:
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv
    jobid: 4
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv
    resources: tmpdir=/local/nala0006/2279907

[Thu Nov 23 09:57:53 2023]
Finished job 116.
3 of 191 steps (2%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_10_S.subsampled.fastq.gz.
Select jobs to execute...
/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/Snakefile:33: SyntaxWarning: invalid escape sequence '\.'
  include: os.path.join("rules", "preflight.smk")
/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/Snakefile:34: SyntaxWarning: invalid escape sequence '\.'
  include: os.path.join("rules", "hostRemoval.smk")
Config file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/../config/config.yaml is extended by additional config specified via the command line.
Config file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/../config/system_config.yaml is extended by additional config specified via the command line.
Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 8
Rules claiming more threads will be scaled down.
Select jobs to execute...
[Thu Nov 23 09:57:53 2023]
Finished job 4.
4 of 191 steps (2%) done

[Thu Nov 23 09:57:53 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Bf_06.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_06_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bf_06.log
    jobid: 181
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Bf_06.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_06_S.fastq.gz
    wildcards: sample=Bf_06
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Bf_06.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bf_06.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_06_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 09:58:28 2023]
Finished job 181.
5 of 191 steps (3%) done
Select jobs to execute...

[Thu Nov 23 09:58:28 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_06_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_06_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bf_06_S.log
    jobid: 180
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Bf_06_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_06_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_06_S.fastq.gz
    wildcards: dir=filtlong, file=Bf_06_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_06_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_06_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_06_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bf_06_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_06_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 09:58:57 2023]
Finished job 180.
6 of 191 steps (3%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_06_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 09:58:57 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_06_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_06_S.subsampled.fastq.gz
    jobid: 179
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_06_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_06_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Bf_06_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_06_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_06_S.subsampled.fastq.gz
[Thu Nov 23 09:58:57 2023]
Finished job 179.
7 of 191 steps (4%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_06_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 09:58:57 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Bf_09.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_09_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bf_09.log
    jobid: 16
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Bf_09.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_09_S.fastq.gz
    wildcards: sample=Bf_09
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Bf_09.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bf_09.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_09_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 09:59:16 2023]
Finished job 16.
8 of 191 steps (4%) done
Select jobs to execute...

[Thu Nov 23 09:59:16 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_09_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_09_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bf_09_S.log
    jobid: 15
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Bf_09_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_09_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_09_S.fastq.gz
    wildcards: dir=filtlong, file=Bf_09_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_09_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_09_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_09_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bf_09_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_09_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 09:59:41 2023]
Finished job 15.
9 of 191 steps (5%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_09_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 09:59:41 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_09_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_09_S.subsampled.fastq.gz
    jobid: 14
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_09_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_09_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Bf_09_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_09_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_09_S.subsampled.fastq.gz
[Thu Nov 23 09:59:41 2023]
Finished job 14.
10 of 191 steps (5%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_09_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 09:59:41 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Bu_20.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_20_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bu_20.log
    jobid: 7
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Bu_20.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_20_S.fastq.gz
    wildcards: sample=Bu_20
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Bu_20.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bu_20.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_20_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:00:02 2023]
Finished job 7.
11 of 191 steps (6%) done
Select jobs to execute...

[Thu Nov 23 10:00:02 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_20_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_20_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bu_20_S.log
    jobid: 6
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Bu_20_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_20_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_20_S.fastq.gz
    wildcards: dir=filtlong, file=Bu_20_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_20_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_20_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_20_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bu_20_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_20_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:00:27 2023]
Finished job 6.
12 of 191 steps (6%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_20_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:00:27 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_20_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_20_S.subsampled.fastq.gz
    jobid: 5
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_20_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_20_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Bu_20_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_20_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_20_S.subsampled.fastq.gz
[Thu Nov 23 10:00:27 2023]
Finished job 5.
13 of 191 steps (7%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_20_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:00:27 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Bb_18.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_18_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bb_18.log
    jobid: 151
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Bb_18.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_18_S.fastq.gz
    wildcards: sample=Bb_18
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Bb_18.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bb_18.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_18_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:00:47 2023]
Finished job 151.
14 of 191 steps (7%) done
Select jobs to execute...

[Thu Nov 23 10:00:47 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_18_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_18_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bb_18_S.log
    jobid: 150
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Bb_18_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_18_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_18_S.fastq.gz
    wildcards: dir=filtlong, file=Bb_18_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_18_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_18_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_18_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bb_18_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_18_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:01:12 2023]
Finished job 150.
15 of 191 steps (8%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_18_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:01:12 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_18_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_18_S.subsampled.fastq.gz
    jobid: 149
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_18_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_18_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Bb_18_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_18_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_18_S.subsampled.fastq.gz
[Thu Nov 23 10:01:12 2023]
Finished job 149.
16 of 191 steps (8%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_18_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:01:12 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Bf_05.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_05_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bf_05.log
    jobid: 178
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Bf_05.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_05_S.fastq.gz
    wildcards: sample=Bf_05
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Bf_05.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bf_05.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_05_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:01:25 2023]
Finished job 178.
17 of 191 steps (9%) done
Select jobs to execute...

[Thu Nov 23 10:01:25 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_05_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_05_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bf_05_S.log
    jobid: 177
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Bf_05_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_05_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_05_S.fastq.gz
    wildcards: dir=filtlong, file=Bf_05_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_05_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_05_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_05_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bf_05_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_05_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:01:47 2023]
Finished job 177.
18 of 191 steps (9%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_05_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:01:47 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_05_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_05_S.subsampled.fastq.gz
    jobid: 176
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_05_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_05_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Bf_05_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_05_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_05_S.subsampled.fastq.gz
[Thu Nov 23 10:01:47 2023]
Finished job 176.
19 of 191 steps (10%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_05_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:01:47 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Bu_09.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_09_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bu_09.log
    jobid: 28
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Bu_09.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_09_S.fastq.gz
    wildcards: sample=Bu_09
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Bu_09.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bu_09.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_09_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:02:05 2023]
Finished job 28.
20 of 191 steps (10%) done
Select jobs to execute...

[Thu Nov 23 10:02:05 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_09_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_09_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bu_09_S.log
    jobid: 27
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Bu_09_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_09_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_09_S.fastq.gz
    wildcards: dir=filtlong, file=Bu_09_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_09_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_09_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_09_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bu_09_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_09_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:02:30 2023]
Finished job 27.
21 of 191 steps (11%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_09_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:02:30 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_09_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_09_S.subsampled.fastq.gz
    jobid: 26
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_09_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_09_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Bu_09_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_09_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_09_S.subsampled.fastq.gz
[Thu Nov 23 10:02:30 2023]
Finished job 26.
22 of 191 steps (12%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_09_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:02:30 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Ecoli_37.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_37_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Ecoli_37.log
    jobid: 166
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Ecoli_37.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_37_S.fastq.gz
    wildcards: sample=Ecoli_37
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Ecoli_37.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Ecoli_37.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_37_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:02:43 2023]
Finished job 166.
23 of 191 steps (12%) done
Select jobs to execute...

[Thu Nov 23 10:02:43 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_37_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_37_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Ecoli_37_S.log
    jobid: 165
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Ecoli_37_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_37_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_37_S.fastq.gz
    wildcards: dir=filtlong, file=Ecoli_37_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_37_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_37_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_37_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Ecoli_37_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_37_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:03:06 2023]
Finished job 165.
24 of 191 steps (13%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_37_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:03:06 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_37_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_37_S.subsampled.fastq.gz
    jobid: 164
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_37_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_37_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Ecoli_37_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_37_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_37_S.subsampled.fastq.gz
[Thu Nov 23 10:03:06 2023]
Finished job 164.
25 of 191 steps (13%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_37_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:03:06 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Ecoli_29.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_29_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Ecoli_29.log
    jobid: 136
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Ecoli_29.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_29_S.fastq.gz
    wildcards: sample=Ecoli_29
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Ecoli_29.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Ecoli_29.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_29_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:03:16 2023]
Finished job 136.
26 of 191 steps (14%) done
Select jobs to execute...

[Thu Nov 23 10:03:16 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_29_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_29_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Ecoli_29_S.log
    jobid: 135
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Ecoli_29_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_29_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_29_S.fastq.gz
    wildcards: dir=filtlong, file=Ecoli_29_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_29_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_29_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_29_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Ecoli_29_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_29_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:03:38 2023]
Finished job 135.
27 of 191 steps (14%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_29_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:03:38 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_29_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_29_S.subsampled.fastq.gz
    jobid: 134
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_29_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_29_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Ecoli_29_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_29_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_29_S.subsampled.fastq.gz
[Thu Nov 23 10:03:38 2023]
Finished job 134.
28 of 191 steps (15%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_29_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:03:38 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Ecoli_27.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_27_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Ecoli_27.log
    jobid: 25
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Ecoli_27.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_27_S.fastq.gz
    wildcards: sample=Ecoli_27
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Ecoli_27.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Ecoli_27.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_27_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:03:48 2023]
Finished job 25.
29 of 191 steps (15%) done
Select jobs to execute...

[Thu Nov 23 10:03:48 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_27_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_27_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Ecoli_27_S.log
    jobid: 24
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Ecoli_27_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_27_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_27_S.fastq.gz
    wildcards: dir=filtlong, file=Ecoli_27_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_27_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_27_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_27_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Ecoli_27_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_27_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:04:10 2023]
Finished job 24.
30 of 191 steps (16%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_27_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:04:10 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_27_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_27_S.subsampled.fastq.gz
    jobid: 23
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_27_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_27_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Ecoli_27_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_27_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_27_S.subsampled.fastq.gz
[Thu Nov 23 10:04:10 2023]
Finished job 23.
31 of 191 steps (16%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_27_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:04:10 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Bu_24.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_24_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bu_24.log
    jobid: 115
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Bu_24.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_24_S.fastq.gz
    wildcards: sample=Bu_24
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Bu_24.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bu_24.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_24_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:04:17 2023]
Finished job 115.
32 of 191 steps (17%) done
Select jobs to execute...

[Thu Nov 23 10:04:17 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_24_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_24_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bu_24_S.log
    jobid: 114
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Bu_24_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_24_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_24_S.fastq.gz
    wildcards: dir=filtlong, file=Bu_24_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_24_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_24_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_24_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bu_24_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_24_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:04:31 2023]
Finished job 114.
33 of 191 steps (17%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_24_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:04:31 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_24_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_24_S.subsampled.fastq.gz
    jobid: 113
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_24_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_24_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Bu_24_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_24_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_24_S.subsampled.fastq.gz
[Thu Nov 23 10:04:31 2023]
Finished job 113.
34 of 191 steps (18%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_24_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:04:31 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Bf_15.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_15_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bf_15.log
    jobid: 97
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Bf_15.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_15_S.fastq.gz
    wildcards: sample=Bf_15
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Bf_15.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bf_15.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_15_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:04:38 2023]
Finished job 97.
35 of 191 steps (18%) done
Select jobs to execute...

[Thu Nov 23 10:04:38 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_15_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_15_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bf_15_S.log
    jobid: 96
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Bf_15_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_15_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_15_S.fastq.gz
    wildcards: dir=filtlong, file=Bf_15_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_15_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_15_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_15_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bf_15_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_15_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:04:49 2023]
Finished job 96.
36 of 191 steps (19%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_15_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:04:49 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_15_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_15_S.subsampled.fastq.gz
    jobid: 95
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_15_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_15_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Bf_15_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_15_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_15_S.subsampled.fastq.gz
[Thu Nov 23 10:04:49 2023]
Finished job 95.
37 of 191 steps (19%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_15_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:04:49 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Bf_12.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_12_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bf_12.log
    jobid: 43
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Bf_12.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_12_S.fastq.gz
    wildcards: sample=Bf_12
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Bf_12.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bf_12.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_12_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:04:56 2023]
Finished job 43.
38 of 191 steps (20%) done
Select jobs to execute...

[Thu Nov 23 10:04:56 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_12_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_12_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bf_12_S.log
    jobid: 42
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Bf_12_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_12_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_12_S.fastq.gz
    wildcards: dir=filtlong, file=Bf_12_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_12_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_12_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_12_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bf_12_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_12_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:05:12 2023]
Finished job 42.
39 of 191 steps (20%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_12_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:05:12 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_12_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_12_S.subsampled.fastq.gz
    jobid: 41
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_12_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_12_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Bf_12_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_12_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_12_S.subsampled.fastq.gz
[Thu Nov 23 10:05:12 2023]
Finished job 41.
40 of 191 steps (21%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_12_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:05:12 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Ecoli_34.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_34_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Ecoli_34.log
    jobid: 10
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Ecoli_34.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_34_S.fastq.gz
    wildcards: sample=Ecoli_34
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Ecoli_34.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Ecoli_34.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_34_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:05:17 2023]
Finished job 10.
41 of 191 steps (21%) done
Select jobs to execute...

[Thu Nov 23 10:05:17 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_34_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_34_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Ecoli_34_S.log
    jobid: 9
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Ecoli_34_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_34_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_34_S.fastq.gz
    wildcards: dir=filtlong, file=Ecoli_34_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_34_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_34_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_34_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Ecoli_34_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_34_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:05:27 2023]
Finished job 9.
42 of 191 steps (22%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_34_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:05:27 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_34_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_34_S.subsampled.fastq.gz
    jobid: 8
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_34_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_34_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Ecoli_34_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_34_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_34_S.subsampled.fastq.gz
[Thu Nov 23 10:05:27 2023]
Finished job 8.
43 of 191 steps (23%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_34_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:05:27 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Bf_01.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_01_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bf_01.log
    jobid: 169
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Bf_01.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_01_S.fastq.gz
    wildcards: sample=Bf_01
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Bf_01.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bf_01.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_01_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:05:32 2023]
Finished job 169.
44 of 191 steps (23%) done
Select jobs to execute...

[Thu Nov 23 10:05:32 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_01_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_01_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bf_01_S.log
    jobid: 168
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Bf_01_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_01_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_01_S.fastq.gz
    wildcards: dir=filtlong, file=Bf_01_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_01_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_01_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_01_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bf_01_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_01_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:05:39 2023]
Finished job 168.
45 of 191 steps (24%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_01_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:05:39 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_01_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_01_S.subsampled.fastq.gz
    jobid: 167
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_01_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_01_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Bf_01_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_01_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_01_S.subsampled.fastq.gz
[Thu Nov 23 10:05:39 2023]
Finished job 167.
46 of 191 steps (24%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_01_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:05:39 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Bf_04.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_04_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bf_04.log
    jobid: 172
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Bf_04.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_04_S.fastq.gz
    wildcards: sample=Bf_04
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Bf_04.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bf_04.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_04_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:05:44 2023]
Finished job 172.
47 of 191 steps (25%) done
Select jobs to execute...

[Thu Nov 23 10:05:44 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_04_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_04_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bf_04_S.log
    jobid: 171
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Bf_04_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_04_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_04_S.fastq.gz
    wildcards: dir=filtlong, file=Bf_04_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_04_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_04_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_04_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bf_04_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_04_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:05:53 2023]
Finished job 171.
48 of 191 steps (25%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_04_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:05:53 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_04_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_04_S.subsampled.fastq.gz
    jobid: 170
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_04_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_04_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Bf_04_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_04_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_04_S.subsampled.fastq.gz
[Thu Nov 23 10:05:53 2023]
Finished job 170.
49 of 191 steps (26%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_04_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:05:53 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Eu_3.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_3_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Eu_3.log
    jobid: 121
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Eu_3.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_3_S.fastq.gz
    wildcards: sample=Eu_3
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Eu_3.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Eu_3.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_3_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:05:58 2023]
Finished job 121.
50 of 191 steps (26%) done
Select jobs to execute...

[Thu Nov 23 10:05:58 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_3_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_3_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Eu_3_S.log
    jobid: 120
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Eu_3_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_3_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_3_S.fastq.gz
    wildcards: dir=filtlong, file=Eu_3_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_3_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_3_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_3_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Eu_3_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_3_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:06:09 2023]
Finished job 120.
51 of 191 steps (27%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_3_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:06:09 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_3_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_3_S.subsampled.fastq.gz
    jobid: 119
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_3_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_3_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Eu_3_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_3_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_3_S.subsampled.fastq.gz
[Thu Nov 23 10:06:09 2023]
Finished job 119.
52 of 191 steps (27%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_3_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:06:09 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Bb_19.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_19_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bb_19.log
    jobid: 91
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Bb_19.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_19_S.fastq.gz
    wildcards: sample=Bb_19
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Bb_19.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bb_19.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_19_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:06:14 2023]
Finished job 91.
53 of 191 steps (28%) done
Select jobs to execute...

[Thu Nov 23 10:06:14 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_19_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_19_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bb_19_S.log
    jobid: 90
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Bb_19_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_19_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_19_S.fastq.gz
    wildcards: dir=filtlong, file=Bb_19_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_19_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_19_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_19_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bb_19_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_19_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:06:26 2023]
Finished job 90.
54 of 191 steps (28%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_19_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:06:26 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_19_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_19_S.subsampled.fastq.gz
    jobid: 89
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_19_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_19_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Bb_19_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_19_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_19_S.subsampled.fastq.gz
[Thu Nov 23 10:06:26 2023]
Finished job 89.
55 of 191 steps (29%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_19_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:06:26 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Bu_30.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_30_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bu_30.log
    jobid: 49
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Bu_30.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_30_S.fastq.gz
    wildcards: sample=Bu_30
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Bu_30.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bu_30.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_30_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:06:30 2023]
Finished job 49.
56 of 191 steps (29%) done
Select jobs to execute...

[Thu Nov 23 10:06:30 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_30_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_30_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bu_30_S.log
    jobid: 48
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Bu_30_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_30_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_30_S.fastq.gz
    wildcards: dir=filtlong, file=Bu_30_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_30_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_30_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_30_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bu_30_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_30_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:06:38 2023]
Finished job 48.
57 of 191 steps (30%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_30_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:06:38 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_30_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_30_S.subsampled.fastq.gz
    jobid: 47
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_30_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_30_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Bu_30_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_30_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_30_S.subsampled.fastq.gz
[Thu Nov 23 10:06:38 2023]
Finished job 47.
58 of 191 steps (30%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_30_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:06:38 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Bf_14.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_14_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bf_14.log
    jobid: 175
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Bf_14.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_14_S.fastq.gz
    wildcards: sample=Bf_14
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Bf_14.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bf_14.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_14_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:06:41 2023]
Finished job 175.
59 of 191 steps (31%) done
Select jobs to execute...

[Thu Nov 23 10:06:41 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_14_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_14_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bf_14_S.log
    jobid: 174
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Bf_14_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_14_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_14_S.fastq.gz
    wildcards: dir=filtlong, file=Bf_14_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_14_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_14_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_14_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bf_14_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_14_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:06:47 2023]
Finished job 174.
60 of 191 steps (31%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_14_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:06:47 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_14_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_14_S.subsampled.fastq.gz
    jobid: 173
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_14_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_14_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Bf_14_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_14_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_14_S.subsampled.fastq.gz
[Thu Nov 23 10:06:47 2023]
Finished job 173.
61 of 191 steps (32%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_14_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:06:47 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Bf_07.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_07_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bf_07.log
    jobid: 100
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Bf_07.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_07_S.fastq.gz
    wildcards: sample=Bf_07
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Bf_07.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bf_07.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_07_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:06:51 2023]
Finished job 100.
62 of 191 steps (32%) done
Select jobs to execute...

[Thu Nov 23 10:06:51 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_07_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_07_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bf_07_S.log
    jobid: 99
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Bf_07_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_07_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_07_S.fastq.gz
    wildcards: dir=filtlong, file=Bf_07_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_07_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_07_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_07_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bf_07_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_07_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:06:59 2023]
Finished job 99.
63 of 191 steps (33%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_07_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:06:59 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_07_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_07_S.subsampled.fastq.gz
    jobid: 98
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_07_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_07_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Bf_07_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_07_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_07_S.subsampled.fastq.gz
[Thu Nov 23 10:06:59 2023]
Finished job 98.
64 of 191 steps (34%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_07_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:06:59 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Bu_14.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_14_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bu_14.log
    jobid: 79
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Bu_14.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_14_S.fastq.gz
    wildcards: sample=Bu_14
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Bu_14.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bu_14.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_14_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:07:03 2023]
Finished job 79.
65 of 191 steps (34%) done
Select jobs to execute...

[Thu Nov 23 10:07:03 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_14_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_14_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bu_14_S.log
    jobid: 78
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Bu_14_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_14_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_14_S.fastq.gz
    wildcards: dir=filtlong, file=Bu_14_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_14_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_14_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_14_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bu_14_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_14_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:07:12 2023]
Finished job 78.
66 of 191 steps (35%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_14_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:07:12 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_14_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_14_S.subsampled.fastq.gz
    jobid: 77
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_14_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_14_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Bu_14_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_14_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_14_S.subsampled.fastq.gz
[Thu Nov 23 10:07:12 2023]
Finished job 77.
67 of 191 steps (35%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_14_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:07:12 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Ecoli_31.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_31_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Ecoli_31.log
    jobid: 37
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Ecoli_31.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_31_S.fastq.gz
    wildcards: sample=Ecoli_31
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Ecoli_31.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Ecoli_31.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_31_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:07:16 2023]
Finished job 37.
68 of 191 steps (36%) done
Select jobs to execute...

[Thu Nov 23 10:07:16 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_31_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_31_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Ecoli_31_S.log
    jobid: 36
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Ecoli_31_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_31_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_31_S.fastq.gz
    wildcards: dir=filtlong, file=Ecoli_31_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_31_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_31_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_31_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Ecoli_31_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_31_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:07:24 2023]
Finished job 36.
69 of 191 steps (36%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_31_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:07:24 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_31_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_31_S.subsampled.fastq.gz
    jobid: 35
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_31_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_31_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Ecoli_31_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_31_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_31_S.subsampled.fastq.gz
[Thu Nov 23 10:07:24 2023]
Finished job 35.
70 of 191 steps (37%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_31_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:07:24 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Bu_19.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_19_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bu_19.log
    jobid: 40
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Bu_19.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_19_S.fastq.gz
    wildcards: sample=Bu_19
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Bu_19.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bu_19.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_19_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:07:28 2023]
Finished job 40.
71 of 191 steps (37%) done
Select jobs to execute...

[Thu Nov 23 10:07:28 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_19_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_19_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bu_19_S.log
    jobid: 39
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Bu_19_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_19_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_19_S.fastq.gz
    wildcards: dir=filtlong, file=Bu_19_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_19_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_19_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_19_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bu_19_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_19_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:07:37 2023]
Finished job 39.
72 of 191 steps (38%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_19_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:07:37 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_19_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_19_S.subsampled.fastq.gz
    jobid: 38
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_19_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_19_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Bu_19_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_19_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_19_S.subsampled.fastq.gz
[Thu Nov 23 10:07:37 2023]
Finished job 38.
73 of 191 steps (38%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_19_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:07:37 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Bf_03.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_03_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bf_03.log
    jobid: 88
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Bf_03.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_03_S.fastq.gz
    wildcards: sample=Bf_03
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Bf_03.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bf_03.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_03_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:07:40 2023]
Finished job 88.
74 of 191 steps (39%) done
Select jobs to execute...

[Thu Nov 23 10:07:40 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_03_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_03_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bf_03_S.log
    jobid: 87
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Bf_03_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_03_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_03_S.fastq.gz
    wildcards: dir=filtlong, file=Bf_03_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_03_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_03_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_03_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bf_03_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_03_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:07:45 2023]
Finished job 87.
75 of 191 steps (39%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_03_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:07:45 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_03_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_03_S.subsampled.fastq.gz
    jobid: 86
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_03_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_03_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Bf_03_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_03_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_03_S.subsampled.fastq.gz
[Thu Nov 23 10:07:45 2023]
Finished job 86.
76 of 191 steps (40%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_03_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:07:45 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Ecoli_17.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_17_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Ecoli_17.log
    jobid: 22
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Ecoli_17.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_17_S.fastq.gz
    wildcards: sample=Ecoli_17
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Ecoli_17.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Ecoli_17.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_17_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:07:49 2023]
Finished job 22.
77 of 191 steps (40%) done
Select jobs to execute...

[Thu Nov 23 10:07:49 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_17_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_17_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Ecoli_17_S.log
    jobid: 21
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Ecoli_17_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_17_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_17_S.fastq.gz
    wildcards: dir=filtlong, file=Ecoli_17_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_17_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_17_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_17_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Ecoli_17_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_17_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:07:56 2023]
Finished job 21.
78 of 191 steps (41%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_17_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:07:56 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_17_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_17_S.subsampled.fastq.gz
    jobid: 20
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_17_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_17_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Ecoli_17_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_17_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_17_S.subsampled.fastq.gz
[Thu Nov 23 10:07:56 2023]
Finished job 20.
79 of 191 steps (41%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_17_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:07:56 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Bf_13.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_13_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bf_13.log
    jobid: 127
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Bf_13.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_13_S.fastq.gz
    wildcards: sample=Bf_13
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Bf_13.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bf_13.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_13_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:07:59 2023]
Finished job 127.
80 of 191 steps (42%) done
Select jobs to execute...

[Thu Nov 23 10:07:59 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_13_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_13_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bf_13_S.log
    jobid: 126
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Bf_13_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_13_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_13_S.fastq.gz
    wildcards: dir=filtlong, file=Bf_13_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_13_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_13_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_13_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bf_13_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_13_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:08:03 2023]
Finished job 126.
81 of 191 steps (42%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_13_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:03 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_13_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_13_S.subsampled.fastq.gz
    jobid: 125
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_13_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_13_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Bf_13_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_13_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_13_S.subsampled.fastq.gz
[Thu Nov 23 10:08:03 2023]
Finished job 125.
82 of 191 steps (43%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bf_13_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:03 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Bb_16.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_16_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bb_16.log
    jobid: 55
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Bb_16.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_16_S.fastq.gz
    wildcards: sample=Bb_16
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Bb_16.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bb_16.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_16_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:08:06 2023]
Finished job 55.
83 of 191 steps (43%) done
Select jobs to execute...

[Thu Nov 23 10:08:06 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_16_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_16_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bb_16_S.log
    jobid: 54
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Bb_16_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_16_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_16_S.fastq.gz
    wildcards: dir=filtlong, file=Bb_16_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_16_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_16_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_16_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bb_16_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_16_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:08:12 2023]
Finished job 54.
84 of 191 steps (44%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_16_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:12 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_16_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_16_S.subsampled.fastq.gz
    jobid: 53
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_16_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_16_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Bb_16_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_16_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_16_S.subsampled.fastq.gz
[Thu Nov 23 10:08:12 2023]
Finished job 53.
85 of 191 steps (45%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_16_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:12 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Bb_15.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_15_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bb_15.log
    jobid: 70
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Bb_15.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_15_S.fastq.gz
    wildcards: sample=Bb_15
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Bb_15.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bb_15.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_15_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:08:14 2023]
Finished job 70.
86 of 191 steps (45%) done
Select jobs to execute...

[Thu Nov 23 10:08:14 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_15_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_15_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bb_15_S.log
    jobid: 69
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Bb_15_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_15_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_15_S.fastq.gz
    wildcards: dir=filtlong, file=Bb_15_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_15_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_15_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_15_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bb_15_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_15_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:08:19 2023]
Finished job 69.
87 of 191 steps (46%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_15_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:19 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_15_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_15_S.subsampled.fastq.gz
    jobid: 68
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_15_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_15_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Bb_15_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_15_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_15_S.subsampled.fastq.gz
[Thu Nov 23 10:08:19 2023]
Finished job 68.
88 of 191 steps (46%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bb_15_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:19 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Bu_18.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_18_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bu_18.log
    jobid: 85
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Bu_18.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_18_S.fastq.gz
    wildcards: sample=Bu_18
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Bu_18.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bu_18.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_18_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:08:21 2023]
Finished job 85.
89 of 191 steps (47%) done
Select jobs to execute...

[Thu Nov 23 10:08:21 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_18_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_18_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bu_18_S.log
    jobid: 84
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Bu_18_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_18_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_18_S.fastq.gz
    wildcards: dir=filtlong, file=Bu_18_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_18_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_18_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_18_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bu_18_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_18_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:08:24 2023]
Finished job 84.
90 of 191 steps (47%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_18_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:24 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_18_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_18_S.subsampled.fastq.gz
    jobid: 83
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_18_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_18_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Bu_18_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_18_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_18_S.subsampled.fastq.gz
[Thu Nov 23 10:08:24 2023]
Finished job 83.
91 of 191 steps (48%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_18_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:24 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Ecoli_32.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_32_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Ecoli_32.log
    jobid: 19
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Ecoli_32.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_32_S.fastq.gz
    wildcards: sample=Ecoli_32
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Ecoli_32.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Ecoli_32.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_32_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:08:25 2023]
Finished job 19.
92 of 191 steps (48%) done
Select jobs to execute...

[Thu Nov 23 10:08:25 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_32_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_32_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Ecoli_32_S.log
    jobid: 18
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Ecoli_32_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_32_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_32_S.fastq.gz
    wildcards: dir=filtlong, file=Ecoli_32_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_32_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_32_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_32_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Ecoli_32_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_32_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:08:27 2023]
Finished job 18.
93 of 191 steps (49%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_32_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:27 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_32_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_32_S.subsampled.fastq.gz
    jobid: 17
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_32_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_32_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Ecoli_32_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_32_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_32_S.subsampled.fastq.gz
[Thu Nov 23 10:08:27 2023]
Finished job 17.
94 of 191 steps (49%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_32_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:27 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/CS-2_12_2.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_12_2_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.CS-2_12_2.log
    jobid: 184
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.CS-2_12_2.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_12_2_S.fastq.gz
    wildcards: sample=CS-2_12_2
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/CS-2_12_2.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.CS-2_12_2.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_12_2_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:08:28 2023]
Finished job 184.
95 of 191 steps (50%) done
Select jobs to execute...

[Thu Nov 23 10:08:28 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_12_2_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_12_2_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.CS-2_12_2_S.log
    jobid: 183
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.CS-2_12_2_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_12_2_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_12_2_S.fastq.gz
    wildcards: dir=filtlong, file=CS-2_12_2_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_12_2_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_12_2_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_12_2_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.CS-2_12_2_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_12_2_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:08:29 2023]
Finished job 183.
96 of 191 steps (50%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_12_2_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:29 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_12_2_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_12_2_S.subsampled.fastq.gz
    jobid: 182
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_12_2_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_12_2_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=CS-2_12_2_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_12_2_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_12_2_S.subsampled.fastq.gz
[Thu Nov 23 10:08:30 2023]
Finished job 182.
97 of 191 steps (51%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_12_2_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:30 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Ecoli_36.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_36_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Ecoli_36.log
    jobid: 76
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Ecoli_36.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_36_S.fastq.gz
    wildcards: sample=Ecoli_36
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Ecoli_36.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Ecoli_36.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_36_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:08:30 2023]
Finished job 76.
98 of 191 steps (51%) done
Select jobs to execute...

[Thu Nov 23 10:08:30 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_36_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_36_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Ecoli_36_S.log
    jobid: 75
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Ecoli_36_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_36_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_36_S.fastq.gz
    wildcards: dir=filtlong, file=Ecoli_36_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_36_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_36_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_36_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Ecoli_36_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_36_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:08:31 2023]
Finished job 75.
99 of 191 steps (52%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_36_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:31 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_36_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_36_S.subsampled.fastq.gz
    jobid: 74
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_36_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_36_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Ecoli_36_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_36_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_36_S.subsampled.fastq.gz
[Thu Nov 23 10:08:31 2023]
Finished job 74.
100 of 191 steps (52%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_36_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:31 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/CS-2_11.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_11_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.CS-2_11.log
    jobid: 34
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.CS-2_11.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_11_S.fastq.gz
    wildcards: sample=CS-2_11
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/CS-2_11.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.CS-2_11.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_11_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:08:31 2023]
Finished job 34.
101 of 191 steps (53%) done
Select jobs to execute...

[Thu Nov 23 10:08:31 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_11_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_11_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.CS-2_11_S.log
    jobid: 33
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.CS-2_11_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_11_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_11_S.fastq.gz
    wildcards: dir=filtlong, file=CS-2_11_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_11_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_11_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_11_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.CS-2_11_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_11_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:08:32 2023]
Finished job 33.
102 of 191 steps (53%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_11_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:32 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_11_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_11_S.subsampled.fastq.gz
    jobid: 32
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_11_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_11_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=CS-2_11_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_11_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_11_S.subsampled.fastq.gz
[Thu Nov 23 10:08:32 2023]
Finished job 32.
103 of 191 steps (54%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_11_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:32 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Bs_13.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bs_13_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bs_13.log
    jobid: 142
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Bs_13.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bs_13_S.fastq.gz
    wildcards: sample=Bs_13
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Bs_13.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bs_13.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bs_13_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:08:32 2023]
Finished job 142.
104 of 191 steps (54%) done
Select jobs to execute...

[Thu Nov 23 10:08:32 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bs_13_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bs_13_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bs_13_S.log
    jobid: 141
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Bs_13_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bs_13_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bs_13_S.fastq.gz
    wildcards: dir=filtlong, file=Bs_13_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bs_13_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bs_13_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bs_13_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bs_13_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bs_13_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:08:33 2023]
Finished job 141.
105 of 191 steps (55%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bs_13_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:33 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bs_13_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bs_13_S.subsampled.fastq.gz
    jobid: 140
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bs_13_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bs_13_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Bs_13_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bs_13_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bs_13_S.subsampled.fastq.gz
[Thu Nov 23 10:08:33 2023]
Finished job 140.
106 of 191 steps (55%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bs_13_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:33 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Bu_07.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_07_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bu_07.log
    jobid: 31
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Bu_07.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_07_S.fastq.gz
    wildcards: sample=Bu_07
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Bu_07.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bu_07.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_07_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:08:33 2023]
Finished job 31.
107 of 191 steps (56%) done
Select jobs to execute...

[Thu Nov 23 10:08:33 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_07_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_07_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bu_07_S.log
    jobid: 30
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Bu_07_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_07_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_07_S.fastq.gz
    wildcards: dir=filtlong, file=Bu_07_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_07_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_07_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_07_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bu_07_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_07_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:08:33 2023]
Finished job 30.
108 of 191 steps (57%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_07_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:33 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_07_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_07_S.subsampled.fastq.gz
    jobid: 29
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_07_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_07_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Bu_07_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_07_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_07_S.subsampled.fastq.gz
[Thu Nov 23 10:08:33 2023]
Finished job 29.
109 of 191 steps (57%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_07_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:33 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Ecoli_35.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_35_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Ecoli_35.log
    jobid: 61
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Ecoli_35.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_35_S.fastq.gz
    wildcards: sample=Ecoli_35
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Ecoli_35.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Ecoli_35.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_35_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:08:34 2023]
Finished job 61.
110 of 191 steps (58%) done
Select jobs to execute...

[Thu Nov 23 10:08:34 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_35_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_35_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Ecoli_35_S.log
    jobid: 60
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Ecoli_35_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_35_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_35_S.fastq.gz
    wildcards: dir=filtlong, file=Ecoli_35_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_35_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_35_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_35_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Ecoli_35_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_35_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:08:34 2023]
Finished job 60.
111 of 191 steps (58%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_35_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:34 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_35_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_35_S.subsampled.fastq.gz
    jobid: 59
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_35_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_35_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Ecoli_35_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_35_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_35_S.subsampled.fastq.gz
[Thu Nov 23 10:08:34 2023]
Finished job 59.
112 of 191 steps (59%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_35_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:34 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Eu_4.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_4_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Eu_4.log
    jobid: 106
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Eu_4.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_4_S.fastq.gz
    wildcards: sample=Eu_4
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Eu_4.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Eu_4.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_4_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:08:34 2023]
Finished job 106.
113 of 191 steps (59%) done
Select jobs to execute...

[Thu Nov 23 10:08:34 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_4_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_4_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Eu_4_S.log
    jobid: 105
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Eu_4_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_4_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_4_S.fastq.gz
    wildcards: dir=filtlong, file=Eu_4_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_4_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_4_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_4_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Eu_4_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_4_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:08:35 2023]
Finished job 105.
114 of 191 steps (60%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_4_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:35 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_4_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_4_S.subsampled.fastq.gz
    jobid: 104
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_4_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_4_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Eu_4_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_4_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_4_S.subsampled.fastq.gz
[Thu Nov 23 10:08:35 2023]
Finished job 104.
115 of 191 steps (60%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_4_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:35 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Eu_6.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_6_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Eu_6.log
    jobid: 58
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Eu_6.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_6_S.fastq.gz
    wildcards: sample=Eu_6
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Eu_6.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Eu_6.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_6_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:08:35 2023]
Finished job 58.
116 of 191 steps (61%) done
Select jobs to execute...

[Thu Nov 23 10:08:35 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_6_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_6_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Eu_6_S.log
    jobid: 57
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Eu_6_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_6_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_6_S.fastq.gz
    wildcards: dir=filtlong, file=Eu_6_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_6_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_6_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_6_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Eu_6_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_6_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:08:35 2023]
Finished job 57.
117 of 191 steps (61%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_6_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:35 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_6_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_6_S.subsampled.fastq.gz
    jobid: 56
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_6_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_6_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Eu_6_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_6_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_6_S.subsampled.fastq.gz
[Thu Nov 23 10:08:35 2023]
Finished job 56.
118 of 191 steps (62%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Eu_6_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:35 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Ecoli_28.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_28_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Ecoli_28.log
    jobid: 130
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Ecoli_28.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_28_S.fastq.gz
    wildcards: sample=Ecoli_28
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Ecoli_28.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Ecoli_28.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_28_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:08:36 2023]
Finished job 130.
119 of 191 steps (62%) done
Select jobs to execute...

[Thu Nov 23 10:08:36 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_28_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_28_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Ecoli_28_S.log
    jobid: 129
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Ecoli_28_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_28_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_28_S.fastq.gz
    wildcards: dir=filtlong, file=Ecoli_28_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_28_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_28_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_28_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Ecoli_28_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_28_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:08:36 2023]
Finished job 129.
120 of 191 steps (63%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_28_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:36 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_28_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_28_S.subsampled.fastq.gz
    jobid: 128
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_28_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_28_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Ecoli_28_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_28_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_28_S.subsampled.fastq.gz
[Thu Nov 23 10:08:36 2023]
Finished job 128.
121 of 191 steps (63%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_28_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:36 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Ec_23.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_23_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Ec_23.log
    jobid: 190
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Ec_23.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_23_S.fastq.gz
    wildcards: sample=Ec_23
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Ec_23.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Ec_23.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_23_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:08:36 2023]
Finished job 190.
122 of 191 steps (64%) done
Select jobs to execute...

[Thu Nov 23 10:08:36 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_23_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_23_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Ec_23_S.log
    jobid: 189
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Ec_23_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_23_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_23_S.fastq.gz
    wildcards: dir=filtlong, file=Ec_23_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_23_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_23_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_23_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Ec_23_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_23_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:08:36 2023]
Finished job 189.
123 of 191 steps (64%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_23_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:36 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_23_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_23_S.subsampled.fastq.gz
    jobid: 188
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_23_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_23_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Ec_23_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_23_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_23_S.subsampled.fastq.gz
[Thu Nov 23 10:08:36 2023]
Finished job 188.
124 of 191 steps (65%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_23_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:36 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Bu_03.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_03_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bu_03.log
    jobid: 3
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Bu_03.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_03_S.fastq.gz
    wildcards: sample=Bu_03
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Bu_03.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bu_03.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_03_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:08:37 2023]
Finished job 3.
125 of 191 steps (65%) done
Select jobs to execute...

[Thu Nov 23 10:08:37 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_03_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_03_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bu_03_S.log
    jobid: 2
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Bu_03_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_03_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_03_S.fastq.gz
    wildcards: dir=filtlong, file=Bu_03_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_03_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_03_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_03_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bu_03_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_03_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:08:37 2023]
Finished job 2.
126 of 191 steps (66%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_03_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:37 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_03_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_03_S.subsampled.fastq.gz
    jobid: 1
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_03_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_03_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Bu_03_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_03_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_03_S.subsampled.fastq.gz
[Thu Nov 23 10:08:37 2023]
Finished job 1.
127 of 191 steps (66%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_03_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:37 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Bu_05.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_05_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bu_05.log
    jobid: 163
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Bu_05.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_05_S.fastq.gz
    wildcards: sample=Bu_05
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Bu_05.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bu_05.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_05_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:08:37 2023]
Finished job 163.
128 of 191 steps (67%) done
Select jobs to execute...

[Thu Nov 23 10:08:37 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_05_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_05_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bu_05_S.log
    jobid: 162
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Bu_05_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_05_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_05_S.fastq.gz
    wildcards: dir=filtlong, file=Bu_05_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_05_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_05_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_05_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bu_05_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_05_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:08:37 2023]
Finished job 162.
129 of 191 steps (68%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_05_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:37 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_05_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_05_S.subsampled.fastq.gz
    jobid: 161
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_05_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_05_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Bu_05_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_05_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_05_S.subsampled.fastq.gz
[Thu Nov 23 10:08:38 2023]
Finished job 161.
130 of 191 steps (68%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_05_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:38 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Ec_24.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_24_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Ec_24.log
    jobid: 82
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Ec_24.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_24_S.fastq.gz
    wildcards: sample=Ec_24
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Ec_24.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Ec_24.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_24_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:08:38 2023]
Finished job 82.
131 of 191 steps (69%) done
Select jobs to execute...

[Thu Nov 23 10:08:38 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_24_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_24_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Ec_24_S.log
    jobid: 81
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Ec_24_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_24_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_24_S.fastq.gz
    wildcards: dir=filtlong, file=Ec_24_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_24_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_24_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_24_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Ec_24_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_24_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:08:38 2023]
Finished job 81.
132 of 191 steps (69%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_24_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:38 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_24_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_24_S.subsampled.fastq.gz
    jobid: 80
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_24_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_24_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Ec_24_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_24_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_24_S.subsampled.fastq.gz
[Thu Nov 23 10:08:38 2023]
Finished job 80.
133 of 191 steps (70%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_24_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:38 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Ecoli_33.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_33_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Ecoli_33.log
    jobid: 139
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Ecoli_33.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_33_S.fastq.gz
    wildcards: sample=Ecoli_33
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Ecoli_33.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Ecoli_33.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_33_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:08:38 2023]
Finished job 139.
134 of 191 steps (70%) done
Select jobs to execute...

[Thu Nov 23 10:08:38 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_33_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_33_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Ecoli_33_S.log
    jobid: 138
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Ecoli_33_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_33_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_33_S.fastq.gz
    wildcards: dir=filtlong, file=Ecoli_33_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_33_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_33_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_33_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Ecoli_33_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_33_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:08:39 2023]
Finished job 138.
135 of 191 steps (71%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_33_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:39 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_33_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_33_S.subsampled.fastq.gz
    jobid: 137
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_33_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_33_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Ecoli_33_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_33_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_33_S.subsampled.fastq.gz
[Thu Nov 23 10:08:39 2023]
Finished job 137.
136 of 191 steps (71%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_33_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:39 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Bu_02.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_02_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bu_02.log
    jobid: 133
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Bu_02.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_02_S.fastq.gz
    wildcards: sample=Bu_02
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Bu_02.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bu_02.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_02_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:08:39 2023]
Finished job 133.
137 of 191 steps (72%) done
Select jobs to execute...

[Thu Nov 23 10:08:39 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_02_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_02_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bu_02_S.log
    jobid: 132
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Bu_02_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_02_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_02_S.fastq.gz
    wildcards: dir=filtlong, file=Bu_02_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_02_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_02_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_02_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bu_02_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_02_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:08:39 2023]
Finished job 132.
138 of 191 steps (72%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_02_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:39 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_02_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_02_S.subsampled.fastq.gz
    jobid: 131
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_02_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_02_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Bu_02_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_02_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_02_S.subsampled.fastq.gz
[Thu Nov 23 10:08:39 2023]
Finished job 131.
139 of 191 steps (73%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_02_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:39 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/CS-2_12.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_12_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.CS-2_12.log
    jobid: 160
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.CS-2_12.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_12_S.fastq.gz
    wildcards: sample=CS-2_12
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/CS-2_12.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.CS-2_12.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_12_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:08:39 2023]
Finished job 160.
140 of 191 steps (73%) done
Select jobs to execute...

[Thu Nov 23 10:08:39 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_12_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_12_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.CS-2_12_S.log
    jobid: 159
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.CS-2_12_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_12_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_12_S.fastq.gz
    wildcards: dir=filtlong, file=CS-2_12_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_12_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_12_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_12_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.CS-2_12_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_12_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:08:39 2023]
Finished job 159.
141 of 191 steps (74%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_12_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:39 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_12_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_12_S.subsampled.fastq.gz
    jobid: 158
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_12_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_12_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=CS-2_12_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_12_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_12_S.subsampled.fastq.gz
[Thu Nov 23 10:08:40 2023]
Finished job 158.
142 of 191 steps (74%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_12_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:40 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/CS-2_13.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_13_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.CS-2_13.log
    jobid: 148
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.CS-2_13.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_13_S.fastq.gz
    wildcards: sample=CS-2_13
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/CS-2_13.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.CS-2_13.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_13_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:08:40 2023]
Finished job 148.
143 of 191 steps (75%) done
Select jobs to execute...

[Thu Nov 23 10:08:40 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_13_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_13_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.CS-2_13_S.log
    jobid: 147
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.CS-2_13_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_13_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_13_S.fastq.gz
    wildcards: dir=filtlong, file=CS-2_13_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_13_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_13_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_13_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.CS-2_13_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_13_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:08:40 2023]
Finished job 147.
144 of 191 steps (75%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_13_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:40 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_13_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_13_S.subsampled.fastq.gz
    jobid: 146
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_13_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_13_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=CS-2_13_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_13_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_13_S.subsampled.fastq.gz
[Thu Nov 23 10:08:40 2023]
Finished job 146.
145 of 191 steps (76%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-2_13_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:40 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Ec_25.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_25_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Ec_25.log
    jobid: 109
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Ec_25.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_25_S.fastq.gz
    wildcards: sample=Ec_25
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Ec_25.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Ec_25.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_25_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:08:40 2023]
Finished job 109.
146 of 191 steps (76%) done
Select jobs to execute...

[Thu Nov 23 10:08:40 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_25_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_25_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Ec_25_S.log
    jobid: 108
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Ec_25_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_25_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_25_S.fastq.gz
    wildcards: dir=filtlong, file=Ec_25_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_25_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_25_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_25_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Ec_25_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_25_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:08:40 2023]
Finished job 108.
147 of 191 steps (77%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_25_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:40 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_25_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_25_S.subsampled.fastq.gz
    jobid: 107
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_25_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_25_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Ec_25_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_25_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_25_S.subsampled.fastq.gz
[Thu Nov 23 10:08:40 2023]
Finished job 107.
148 of 191 steps (77%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ec_25_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:40 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/CS-1_10.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_10_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.CS-1_10.log
    jobid: 103
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.CS-1_10.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_10_S.fastq.gz
    wildcards: sample=CS-1_10
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/CS-1_10.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.CS-1_10.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_10_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:08:41 2023]
Finished job 103.
149 of 191 steps (78%) done
Select jobs to execute...

[Thu Nov 23 10:08:41 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_10_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_10_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.CS-1_10_S.log
    jobid: 102
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.CS-1_10_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_10_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_10_S.fastq.gz
    wildcards: dir=filtlong, file=CS-1_10_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_10_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_10_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_10_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.CS-1_10_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_10_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:08:41 2023]
Finished job 102.
150 of 191 steps (79%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_10_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:41 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_10_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_10_S.subsampled.fastq.gz
    jobid: 101
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_10_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_10_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=CS-1_10_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_10_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_10_S.subsampled.fastq.gz
[Thu Nov 23 10:08:41 2023]
Finished job 101.
151 of 191 steps (79%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_10_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:41 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Bu_06.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_06_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bu_06.log
    jobid: 157
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Bu_06.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_06_S.fastq.gz
    wildcards: sample=Bu_06
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Bu_06.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bu_06.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_06_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:08:41 2023]
Finished job 157.
152 of 191 steps (80%) done
Select jobs to execute...

[Thu Nov 23 10:08:41 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_06_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_06_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bu_06_S.log
    jobid: 156
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Bu_06_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_06_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_06_S.fastq.gz
    wildcards: dir=filtlong, file=Bu_06_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_06_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_06_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_06_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bu_06_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_06_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:08:41 2023]
Finished job 156.
153 of 191 steps (80%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_06_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:41 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_06_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_06_S.subsampled.fastq.gz
    jobid: 155
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_06_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_06_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Bu_06_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_06_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_06_S.subsampled.fastq.gz
[Thu Nov 23 10:08:41 2023]
Finished job 155.
154 of 191 steps (81%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_06_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:41 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/CS-1_9.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_9_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.CS-1_9.log
    jobid: 64
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.CS-1_9.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_9_S.fastq.gz
    wildcards: sample=CS-1_9
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/CS-1_9.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.CS-1_9.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_9_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:08:42 2023]
Finished job 64.
155 of 191 steps (81%) done
Select jobs to execute...

[Thu Nov 23 10:08:42 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_9_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_9_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.CS-1_9_S.log
    jobid: 63
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.CS-1_9_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_9_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_9_S.fastq.gz
    wildcards: dir=filtlong, file=CS-1_9_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_9_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_9_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_9_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.CS-1_9_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_9_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:08:42 2023]
Finished job 63.
156 of 191 steps (82%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_9_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:42 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_9_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_9_S.subsampled.fastq.gz
    jobid: 62
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_9_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_9_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=CS-1_9_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_9_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_9_S.subsampled.fastq.gz
[Thu Nov 23 10:08:42 2023]
Finished job 62.
157 of 191 steps (82%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_9_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:42 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Ecoli_39.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_39_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Ecoli_39.log
    jobid: 112
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Ecoli_39.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_39_S.fastq.gz
    wildcards: sample=Ecoli_39
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Ecoli_39.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Ecoli_39.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_39_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:08:42 2023]
Finished job 112.
158 of 191 steps (83%) done
Select jobs to execute...

[Thu Nov 23 10:08:42 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_39_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_39_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Ecoli_39_S.log
    jobid: 111
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Ecoli_39_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_39_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_39_S.fastq.gz
    wildcards: dir=filtlong, file=Ecoli_39_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_39_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_39_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_39_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Ecoli_39_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_39_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:08:42 2023]
Finished job 111.
159 of 191 steps (83%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_39_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:42 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_39_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_39_S.subsampled.fastq.gz
    jobid: 110
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_39_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_39_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Ecoli_39_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_39_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_39_S.subsampled.fastq.gz
[Thu Nov 23 10:08:42 2023]
Finished job 110.
160 of 191 steps (84%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_39_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:42 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Ecoli_26.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_26_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Ecoli_26.log
    jobid: 67
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Ecoli_26.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_26_S.fastq.gz
    wildcards: sample=Ecoli_26
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Ecoli_26.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Ecoli_26.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_26_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:08:42 2023]
Finished job 67.
161 of 191 steps (84%) done
Select jobs to execute...

[Thu Nov 23 10:08:42 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_26_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_26_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Ecoli_26_S.log
    jobid: 66
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Ecoli_26_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_26_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_26_S.fastq.gz
    wildcards: dir=filtlong, file=Ecoli_26_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_26_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_26_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_26_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Ecoli_26_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_26_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:08:43 2023]
Finished job 66.
162 of 191 steps (85%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_26_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:43 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_26_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_26_S.subsampled.fastq.gz
    jobid: 65
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_26_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_26_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Ecoli_26_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_26_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_26_S.subsampled.fastq.gz
[Thu Nov 23 10:08:43 2023]
Finished job 65.
163 of 191 steps (85%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_26_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:43 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Ecoli_33_1.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_33_1_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Ecoli_33_1.log
    jobid: 73
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Ecoli_33_1.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_33_1_S.fastq.gz
    wildcards: sample=Ecoli_33_1
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Ecoli_33_1.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Ecoli_33_1.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_33_1_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:08:43 2023]
Finished job 73.
164 of 191 steps (86%) done
Select jobs to execute...

[Thu Nov 23 10:08:43 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_33_1_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_33_1_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Ecoli_33_1_S.log
    jobid: 72
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Ecoli_33_1_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_33_1_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_33_1_S.fastq.gz
    wildcards: dir=filtlong, file=Ecoli_33_1_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_33_1_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_33_1_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_33_1_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Ecoli_33_1_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_33_1_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:08:43 2023]
Finished job 72.
165 of 191 steps (86%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_33_1_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:43 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Bu_13.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_13_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bu_13.log
    jobid: 124
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Bu_13.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_13_S.fastq.gz
    wildcards: sample=Bu_13
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Bu_13.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Bu_13.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_13_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:08:43 2023]
Finished job 124.
166 of 191 steps (87%) done
Select jobs to execute...

[Thu Nov 23 10:08:43 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_13_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_13_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bu_13_S.log
    jobid: 123
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Bu_13_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_13_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_13_S.fastq.gz
    wildcards: dir=filtlong, file=Bu_13_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_13_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_13_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_13_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Bu_13_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_13_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:08:43 2023]
Finished job 123.
167 of 191 steps (87%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_13_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:43 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_33_1_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_33_1_S.subsampled.fastq.gz
    jobid: 71
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_33_1_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_33_1_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Ecoli_33_1_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_33_1_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_33_1_S.subsampled.fastq.gz

[Thu Nov 23 10:08:43 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_13_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_13_S.subsampled.fastq.gz
    jobid: 122
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_13_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_13_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Bu_13_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_13_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_13_S.subsampled.fastq.gz
[Thu Nov 23 10:08:43 2023]
Finished job 71.
168 of 191 steps (88%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Ecoli_33_1_S.subsampled.fastq.gz.
Select jobs to execute...
[Thu Nov 23 10:08:43 2023]
Finished job 122.
169 of 191 steps (88%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Bu_13_S.subsampled.fastq.gz.

[Thu Nov 23 10:08:43 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/CS-1_7.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_7_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.CS-1_7.log
    jobid: 13
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.CS-1_7.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_7_S.fastq.gz
    wildcards: sample=CS-1_7
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/CS-1_7.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.CS-1_7.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_7_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:08:44 2023]
Finished job 13.
170 of 191 steps (89%) done
Select jobs to execute...

[Thu Nov 23 10:08:44 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_7_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_7_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.CS-1_7_S.log
    jobid: 12
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.CS-1_7_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_7_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_7_S.fastq.gz
    wildcards: dir=filtlong, file=CS-1_7_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_7_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_7_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_7_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.CS-1_7_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_7_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:08:44 2023]
Finished job 12.
171 of 191 steps (90%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_7_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:44 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_7_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_7_S.subsampled.fastq.gz
    jobid: 11
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_7_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_7_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=CS-1_7_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_7_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_7_S.subsampled.fastq.gz
[Thu Nov 23 10:08:44 2023]
Finished job 11.
172 of 191 steps (90%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_7_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:44 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/Lg_25.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Lg_25_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Lg_25.log
    jobid: 187
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.Lg_25.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Lg_25_S.fastq.gz
    wildcards: sample=Lg_25
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/Lg_25.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.Lg_25.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Lg_25_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:08:44 2023]
Finished job 187.
173 of 191 steps (91%) done
Select jobs to execute...

[Thu Nov 23 10:08:44 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Lg_25_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Lg_25_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Lg_25_S.log
    jobid: 186
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.Lg_25_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Lg_25_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Lg_25_S.fastq.gz
    wildcards: dir=filtlong, file=Lg_25_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Lg_25_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Lg_25_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Lg_25_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.Lg_25_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Lg_25_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:08:44 2023]
Finished job 186.
174 of 191 steps (91%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Lg_25_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:44 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Lg_25_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Lg_25_S.subsampled.fastq.gz
    jobid: 185
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Lg_25_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Lg_25_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=Lg_25_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Lg_25_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Lg_25_S.subsampled.fastq.gz
[Thu Nov 23 10:08:44 2023]
Finished job 185.
175 of 191 steps (92%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/Lg_25_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:44 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/CS-1_4.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_4_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.CS-1_4.log
    jobid: 52
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.CS-1_4.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_4_S.fastq.gz
    wildcards: sample=CS-1_4
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/CS-1_4.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.CS-1_4.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_4_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:08:44 2023]
Finished job 52.
176 of 191 steps (92%) done
Select jobs to execute...

[Thu Nov 23 10:08:44 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_4_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_4_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.CS-1_4_S.log
    jobid: 51
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.CS-1_4_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_4_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_4_S.fastq.gz
    wildcards: dir=filtlong, file=CS-1_4_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_4_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_4_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_4_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.CS-1_4_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_4_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:08:45 2023]
Finished job 51.
177 of 191 steps (93%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_4_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:45 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_4_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_4_S.subsampled.fastq.gz
    jobid: 50
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_4_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_4_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=CS-1_4_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_4_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_4_S.subsampled.fastq.gz
[Thu Nov 23 10:08:45 2023]
Finished job 50.
178 of 191 steps (93%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_4_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:45 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/CS-1_3.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_3_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.CS-1_3.log
    jobid: 46
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.CS-1_3.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_3_S.fastq.gz
    wildcards: sample=CS-1_3
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/CS-1_3.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.CS-1_3.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_3_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:08:45 2023]
Finished job 46.
179 of 191 steps (94%) done
Select jobs to execute...

[Thu Nov 23 10:08:45 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_3_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_3_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.CS-1_3_S.log
    jobid: 45
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.CS-1_3_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_3_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_3_S.fastq.gz
    wildcards: dir=filtlong, file=CS-1_3_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_3_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_3_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_3_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.CS-1_3_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_3_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:08:45 2023]
Finished job 45.
180 of 191 steps (94%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_3_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:45 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_3_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_3_S.subsampled.fastq.gz
    jobid: 44
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_3_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_3_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=CS-1_3_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_3_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_3_S.subsampled.fastq.gz
[Thu Nov 23 10:08:45 2023]
Finished job 44.
181 of 191 steps (95%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_3_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:45 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/CS-1_6.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_6_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.CS-1_6.log
    jobid: 145
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.CS-1_6.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_6_S.fastq.gz
    wildcards: sample=CS-1_6
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/CS-1_6.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.CS-1_6.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_6_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:08:45 2023]
Finished job 145.
182 of 191 steps (95%) done
Select jobs to execute...

[Thu Nov 23 10:08:45 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_6_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_6_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.CS-1_6_S.log
    jobid: 144
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.CS-1_6_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_6_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_6_S.fastq.gz
    wildcards: dir=filtlong, file=CS-1_6_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_6_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_6_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_6_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.CS-1_6_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_6_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:08:45 2023]
Finished job 144.
183 of 191 steps (96%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_6_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:45 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_6_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_6_S.subsampled.fastq.gz
    jobid: 143
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_6_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_6_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=CS-1_6_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_6_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_6_S.subsampled.fastq.gz
[Thu Nov 23 10:08:46 2023]
Finished job 143.
184 of 191 steps (96%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_6_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:46 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/CS-1_1.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_1_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.CS-1_1.log
    jobid: 154
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.CS-1_1.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_1_S.fastq.gz
    wildcards: sample=CS-1_1
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/CS-1_1.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.CS-1_1.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_1_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:08:46 2023]
Finished job 154.
185 of 191 steps (97%) done
Select jobs to execute...

[Thu Nov 23 10:08:46 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_1_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_1_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.CS-1_1_S.log
    jobid: 153
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.CS-1_1_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_1_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_1_S.fastq.gz
    wildcards: dir=filtlong, file=CS-1_1_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_1_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_1_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_1_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.CS-1_1_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_1_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:08:46 2023]
Finished job 153.
186 of 191 steps (97%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_1_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:46 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_1_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_1_S.subsampled.fastq.gz
    jobid: 152
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_1_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_1_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=CS-1_1_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_1_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_1_S.subsampled.fastq.gz
[Thu Nov 23 10:08:46 2023]
Finished job 152.
187 of 191 steps (98%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_1_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:46 2023]
rule filtlong_single:
    input: ../nanopore/nanopore_sequences_SRA_bact/CS-1_8.fastq
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_8_S.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.CS-1_8.log
    jobid: 94
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/filtlong_single.CS-1_8.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_8_S.fastq.gz
    wildcards: sample=CS-1_8
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

filtlong --min_length 1000 --keep_percent 95 ../nanopore/nanopore_sequences_SRA_bact/CS-1_8.fastq 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/filtlong_single.CS-1_8.log | gzip -1 > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_8_S.fastq.gz; 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/189bfb8a55aabf7a7f7de612e1d5ad7b_
[Thu Nov 23 10:08:46 2023]
Finished job 94.
188 of 191 steps (98%) done
Select jobs to execute...

[Thu Nov 23 10:08:46 2023]
rule rasusa:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_8_S.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_8_S.subsampled.fastq.gz
    log: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.CS-1_8_S.log
    jobid: 93
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/benchmarks/rasusa_single.filtlong.CS-1_8_S.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_8_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_8_S.fastq.gz
    wildcards: dir=filtlong, file=CS-1_8_S
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, mem=16000MB, time=04:00:00

if (( $(wc -c ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_8_S.fastq.gz | awk '{print$1}') > 200 )); then rasusa -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_8_S.fastq.gz -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_8_S.subsampled.fastq.gz -O g --bases 100M 2> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/logs/rasusa_single.filtlong.CS-1_8_S.log; else touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_8_S.subsampled.fastq.gz; fi 
Activating conda environment: sphae/workflow/conda/47e9b570ab6c6c16502f2b57f20ac3b3_/lib/python3.12/site-packages/trimnami/workflow/conda/63176bee18ae0be59e0769f2725f7382_
[Thu Nov 23 10:08:46 2023]
Finished job 93.
189 of 191 steps (99%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_8_S.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:46 2023]
localrule save_output:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_8_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_8_S.subsampled.fastq.gz
    jobid: 92
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_8_S.subsampled.fastq.gz; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_8_S.subsampled.fastq.gz
    wildcards: dir=filtlong, file=CS-1_8_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

ln ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_8_S.subsampled.fastq.gz ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_8_S.subsampled.fastq.gz
[Thu Nov 23 10:08:46 2023]
Finished job 92.
190 of 191 steps (99%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/PROCESSING/temp/filtlong/CS-1_8_S.subsampled.fastq.gz.
Select jobs to execute...

[Thu Nov 23 10:08:46 2023]
localrule filtlong:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_03_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_20_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_34_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_7_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_09_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_32_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_17_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_27_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_09_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_07_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_11_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_31_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_19_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_12_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_3_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_30_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_4_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_16_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_6_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_35_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_9_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_26_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_15_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_33_1_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_36_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_14_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_24_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_18_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_03_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_19_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_8_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_15_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_07_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_10_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_4_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_25_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_39_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_24_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_10_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_3_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_13_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_13_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_28_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_02_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_29_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_33_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bs_13_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_6_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_13_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_18_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_1_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_06_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_12_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_05_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_37_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_01_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_04_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_14_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_05_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_06_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_12_2_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Lg_25_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_23_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv
    jobid: 0
    reason: Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_8_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_13_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_11_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_12_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_18_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_29_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_24_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_34_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_16_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_12_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_06_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_6_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_12_2_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_14_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_02_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_39_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_13_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_10_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_28_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_19_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_13_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_04_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_07_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_19_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_9_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bs_13_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_05_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/samples.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_15_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_32_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_31_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_23_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_36_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_09_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_20_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_30_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_33_1_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_15_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_18_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_6_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_03_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_09_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_3_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_10_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_1_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Lg_25_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_33_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_03_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_05_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_14_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_3_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_7_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_4_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_4_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_35_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_25_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_24_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_01_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_26_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_27_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_37_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_06_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_17_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_07_S.subsampled.fastq.gz
    resources: tmpdir=/local/nala0006/2279907

[Thu Nov 23 10:08:46 2023]
Finished job 0.
191 of 191 steps (100%) done
Complete log: .snakemake/log/2023-11-23T095559.118444.snakemake.log
cat .snakemake/log/2023-11-23T095559.118444.snakemake.log >> ../nanopore/nanoporeSDSU.spae.out/logs/trimnami.log
[2023:11:23 10:08:46] Snakemake finished successfully
[Thu Nov 23 10:08:47 2023]
Finished job 1.
2 of 759 steps (0.3%) done
Removing temporary output ../nanopore/nanoporeSDSU.spae.out/temp/samples.reads.tsv.
Select jobs to execute...

[Thu Nov 23 10:08:47 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_10_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bf_10.log
    jobid: 40
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Bf_10.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/assembly_info.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_10_S.subsampled.fastq.gz
    wildcards: sample=Bf_10
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_10_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bf_10.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_

[Thu Nov 23 10:08:47 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_09_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bf_09.log
    jobid: 53
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Bf_09.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/flye.log; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_09_S.subsampled.fastq.gz
    wildcards: sample=Bf_09
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_09_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bf_09.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:10:29 2023]
Finished job 53.
3 of 759 steps (0.4%) done
Select jobs to execute...

[Thu Nov 23 10:10:29 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_09-sr/Bf_09_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Bf_09.log
    jobid: 746
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_09-sr/Bf_09_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/flye.log
    wildcards: sample=Bf_09
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_09-sr/Bf_09-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_09-sr/Bf_09-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/Bf_09_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/Bf_09_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_09-sr/Bf_09_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_09-sr/Bf_09.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_09-sr/Bf_09_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_09-sr/Bf_09.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/Bf_09_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_09-sr/Bf_09_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_09-sr/Bf_09-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_09-sr/Bf_09_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_09-sr/Bf_09-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_09-sr/Bf_09_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_09-sr/Bf_09-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_09-sr/Bf_09_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/Bf_09_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_09-sr/Bf_09_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_09-sr/Bf_09-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_09-sr/Bf_09_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_09-sr/Bf_09-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_09-sr/Bf_09_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_09-sr/Bf_09-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_09-sr/Bf_09_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/Bf_09_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_09-sr/Bf_09_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/Bf_09_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_09-sr/Bf_09_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/Bf_09_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_09-sr/Bf_09_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_09-sr/Bf_09_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_09-sr/Bf_09_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_09-sr/Bf_09_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_09-sr/Bf_09_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_09-sr/Bf_09_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_09-sr/Bf_09_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/Bf_09_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_09-sr/Bf_09_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_09-sr/Bf_09_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Bf_09" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_09-sr/Bf_09_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_09-sr/Bf_09_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Bf_09" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_09-sr/Bf_09_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_09-sr/Bf_09_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Bf_09" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_09-sr/Bf_09_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_09-sr/Bf_09_summary.txt
        fi
        

[Thu Nov 23 10:10:29 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bf_09.log
    jobid: 305
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Bf_09.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/assembly.fasta
    wildcards: sample=Bf_09
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bf_09.log
        fi
        
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_

[Thu Nov 23 10:10:29 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Bf_09.log
    jobid: 230
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Bf_09.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/assembly_graph.gfa
    wildcards: sample=Bf_09
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:10:29 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bf_09.log
    jobid: 229
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Bf_09.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/assembly.fasta
    wildcards: sample=Bf_09
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bf_09.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_
[Thu Nov 23 10:10:29 2023]
Finished job 746.
4 of 759 steps (1%) done
Select jobs to execute...
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpqjgkr8_f.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:10:30 2023]
Finished job 230.
5 of 759 steps (1%) done
[Thu Nov 23 10:10:42 2023]
Finished job 305.
6 of 759 steps (1%) done
[Thu Nov 23 10:10:54 2023]
Finished job 40.
7 of 759 steps (1%) done

[Thu Nov 23 10:10:54 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bf_10.log
    jobid: 292
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Bf_10.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/assembly.fasta
    wildcards: sample=Bf_10
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bf_10.log
        fi
        

Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_
[Thu Nov 23 10:10:54 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Bf_10.log
    jobid: 204
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Bf_10.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/assembly_graph.gfa
    wildcards: sample=Bf_10
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:10:54 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_09_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bf_09.log
    jobid: 116
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Bf_09.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_09_S.subsampled.fastq.gz
    wildcards: sample=Bf_09
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_09_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bf_09.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/consensus.fasta
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_

[Thu Nov 23 10:10:54 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bf_10.log
    jobid: 203
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Bf_10.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/assembly.fasta
    wildcards: sample=Bf_10
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bf_10.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpo7wik5d1.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:10:55 2023]
Finished job 204.
8 of 759 steps (1%) done
Select jobs to execute...

[Thu Nov 23 10:10:55 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_10-sr/Bf_10_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Bf_10.log
    jobid: 733
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_10-sr/Bf_10_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/flye.log
    wildcards: sample=Bf_10
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_10-sr/Bf_10-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_10-sr/Bf_10-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/Bf_10_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/Bf_10_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_10-sr/Bf_10_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_10-sr/Bf_10.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_10-sr/Bf_10_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_10-sr/Bf_10.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/Bf_10_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_10-sr/Bf_10_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_10-sr/Bf_10-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_10-sr/Bf_10_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_10-sr/Bf_10-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_10-sr/Bf_10_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_10-sr/Bf_10-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_10-sr/Bf_10_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/Bf_10_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_10-sr/Bf_10_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_10-sr/Bf_10-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_10-sr/Bf_10_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_10-sr/Bf_10-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_10-sr/Bf_10_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_10-sr/Bf_10-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_10-sr/Bf_10_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/Bf_10_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_10-sr/Bf_10_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/Bf_10_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_10-sr/Bf_10_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/Bf_10_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_10-sr/Bf_10_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_10-sr/Bf_10_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_10-sr/Bf_10_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_10-sr/Bf_10_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_10-sr/Bf_10_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_10-sr/Bf_10_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_10-sr/Bf_10_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/Bf_10_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_10-sr/Bf_10_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_10-sr/Bf_10_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Bf_10" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_10-sr/Bf_10_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_10-sr/Bf_10_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Bf_10" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_10-sr/Bf_10_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_10-sr/Bf_10_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Bf_10" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_10-sr/Bf_10_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_10-sr/Bf_10_summary.txt
        fi
        
[Thu Nov 23 10:10:55 2023]
Finished job 733.
9 of 759 steps (1%) done
Select jobs to execute...
[Thu Nov 23 10:11:06 2023]
Finished job 292.
10 of 759 steps (1%) done
[Thu Nov 23 10:11:15 2023]
Finished job 229.
11 of 759 steps (1%) done

[Thu Nov 23 10:11:15 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_09-assembly-stats_flye.csv
    jobid: 368
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_09-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/checkv/quality_summary.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/graph_seq_details_flye.tsv
    wildcards: sample=Bf_09
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp3dccyno_.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:11:16 2023]
Finished job 368.
12 of 759 steps (2%) done
Select jobs to execute...

[Thu Nov 23 10:11:16 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_09-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_09-sr/Bf_09-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Bf_09.log
    jobid: 482
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_09-sr/Bf_09-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_09-assembly-stats_flye.csv
    wildcards: sample=Bf_09
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpwizzkzhl.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:11:17 2023]
Finished job 482.
13 of 759 steps (2%) done
Select jobs to execute...

[Thu Nov 23 10:11:17 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_09-sr/Bf_09-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_09-sr/Bf_09.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Bf_09.log
    jobid: 481
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_09-sr/Bf_09.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_09-sr/Bf_09-genome-candidates.csv
    wildcards: sample=Bf_09
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_09-sr/Bf_09-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_09-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_09-sr/Bf_09.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_09-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_09-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_09-sr/Bf_09.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:11:18 2023]
Finished job 481.
14 of 759 steps (2%) done
Select jobs to execute...

[Thu Nov 23 10:11:18 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_09-sr/Bf_09.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_09-sr/Bf_09_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_09-sr/Bf_09_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Bf_09.log
    jobid: 608
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_09-sr/Bf_09_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_09-sr/Bf_09.fasta
    wildcards: sample=Bf_09
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp8ic87xr9.rename_genomes.py
[Thu Nov 23 10:11:18 2023]
Finished job 608.
15 of 759 steps (2%) done
Select jobs to execute...

[Thu Nov 23 10:11:18 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_09-sr/Bf_09_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/Bf_09.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/Bf_09_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/Bf_09_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/Bf_09_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/Bf_09_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/Bf_09_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_09.log
    jobid: 607
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/Bf_09_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/Bf_09_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/Bf_09_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/Bf_09.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/Bf_09_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/Bf_09_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/top_hits_vfdb.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_09-sr/Bf_09_genome.fasta
    wildcards: sample=Bf_09
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_09-sr/Bf_09_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_09-sr/Bf_09_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bf_09                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_09.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/Bf_09_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_09-sr/Bf_09_genome.fasta -n Bf_09_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr -p Bf_09 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:11:18 2023]
Error in rule pharokka_flye:
    jobid: 607
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_09-sr/Bf_09_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/Bf_09.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/Bf_09_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/Bf_09_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/Bf_09_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/Bf_09_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/Bf_09_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_09.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_09-sr/Bf_09_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_09-sr/Bf_09_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bf_09                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_09.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr/Bf_09_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_09-sr/Bf_09_genome.fasta -n Bf_09_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_09-sr -p Bf_09 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_09.log not found.

Select jobs to execute...
[Thu Nov 23 10:11:35 2023]
Finished job 203.
16 of 759 steps (2%) done

[Thu Nov 23 10:11:35 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_10_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bf_10.log
    jobid: 103
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Bf_10.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_10_S.subsampled.fastq.gz
    wildcards: sample=Bf_10
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_10_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bf_10.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:11:37 2023]
Finished job 116.
17 of 759 steps (2%) done
Select jobs to execute...

[Thu Nov 23 10:11:37 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_37_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Ecoli_37.log
    jobid: 41
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Ecoli_37.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/assembly_graph.gfa; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_37_S.subsampled.fastq.gz
    wildcards: sample=Ecoli_37
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_37_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Ecoli_37.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:12:17 2023]
Finished job 103.
18 of 759 steps (2%) done
Select jobs to execute...

[Thu Nov 23 10:12:17 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_09_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bu_09.log
    jobid: 13
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Bu_09.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/flye.log; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_09_S.subsampled.fastq.gz
    wildcards: sample=Bu_09
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_09_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bu_09.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:13:30 2023]
Finished job 13.
19 of 759 steps (3%) done
Select jobs to execute...

[Thu Nov 23 10:13:30 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_09-sr/Bu_09_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Bu_09.log
    jobid: 706
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_09-sr/Bu_09_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/flye.log
    wildcards: sample=Bu_09
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_09-sr/Bu_09-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_09-sr/Bu_09-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/Bu_09_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/Bu_09_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_09-sr/Bu_09_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_09-sr/Bu_09.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_09-sr/Bu_09_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_09-sr/Bu_09.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/Bu_09_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_09-sr/Bu_09_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_09-sr/Bu_09-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_09-sr/Bu_09_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_09-sr/Bu_09-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_09-sr/Bu_09_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_09-sr/Bu_09-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_09-sr/Bu_09_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/Bu_09_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_09-sr/Bu_09_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_09-sr/Bu_09-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_09-sr/Bu_09_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_09-sr/Bu_09-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_09-sr/Bu_09_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_09-sr/Bu_09-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_09-sr/Bu_09_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/Bu_09_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_09-sr/Bu_09_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/Bu_09_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_09-sr/Bu_09_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/Bu_09_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_09-sr/Bu_09_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_09-sr/Bu_09_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_09-sr/Bu_09_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_09-sr/Bu_09_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_09-sr/Bu_09_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_09-sr/Bu_09_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_09-sr/Bu_09_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/Bu_09_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_09-sr/Bu_09_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_09-sr/Bu_09_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Bu_09" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_09-sr/Bu_09_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_09-sr/Bu_09_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Bu_09" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_09-sr/Bu_09_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_09-sr/Bu_09_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Bu_09" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_09-sr/Bu_09_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_09-sr/Bu_09_summary.txt
        fi
        

[Thu Nov 23 10:13:30 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Bu_09.log
    jobid: 150
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Bu_09.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/assembly_info.txt
    wildcards: sample=Bu_09
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:13:30 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_10-assembly-stats_flye.csv
    jobid: 355
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_10-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/checkv/quality_summary.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/graph_seq_details_flye.tsv
    wildcards: sample=Bf_10
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_

[Thu Nov 23 10:13:30 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bu_09.log
    jobid: 149
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Bu_09.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/assembly.fasta
    wildcards: sample=Bu_09
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bu_09.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_

[Thu Nov 23 10:13:30 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bu_09.log
    jobid: 265
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Bu_09.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/assembly.fasta
    wildcards: sample=Bu_09
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bu_09.log
        fi
        
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_
[Thu Nov 23 10:13:30 2023]
Finished job 706.
20 of 759 steps (3%) done
Select jobs to execute...
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpx348ny3c.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp7g8q538s.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:13:31 2023]
Finished job 150.
21 of 759 steps (3%) done
[Thu Nov 23 10:13:31 2023]
Finished job 355.
22 of 759 steps (3%) done

[Thu Nov 23 10:13:31 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_10-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_10-sr/Bf_10-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Bf_10.log
    jobid: 456
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_10-sr/Bf_10-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_10-assembly-stats_flye.csv
    wildcards: sample=Bf_10
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpqjni23qs.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:13:32 2023]
Finished job 456.
23 of 759 steps (3%) done
Select jobs to execute...

[Thu Nov 23 10:13:32 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_10-sr/Bf_10-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_10-sr/Bf_10.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Bf_10.log
    jobid: 455
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_10-sr/Bf_10.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_10-sr/Bf_10-genome-candidates.csv
    wildcards: sample=Bf_10
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_10-sr/Bf_10-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_10-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_10-sr/Bf_10.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_10-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_10-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_10-sr/Bf_10.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:13:33 2023]
Finished job 455.
24 of 759 steps (3%) done
Select jobs to execute...

[Thu Nov 23 10:13:33 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_10-sr/Bf_10.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_10-sr/Bf_10_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_10-sr/Bf_10_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Bf_10.log
    jobid: 582
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_10-sr/Bf_10_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_10-sr/Bf_10.fasta
    wildcards: sample=Bf_10
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp7nk0qlqx.rename_genomes.py
[Thu Nov 23 10:13:33 2023]
Finished job 582.
25 of 759 steps (3%) done
Select jobs to execute...

[Thu Nov 23 10:13:33 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_10-sr/Bf_10_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/Bf_10.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/Bf_10_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/Bf_10_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/Bf_10_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/Bf_10_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/Bf_10_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_10.log
    jobid: 581
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/Bf_10.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/Bf_10_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/Bf_10_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/Bf_10_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/Bf_10_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/Bf_10_top_hits_mash_inphared.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_10-sr/Bf_10_genome.fasta
    wildcards: sample=Bf_10
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_10-sr/Bf_10_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_10-sr/Bf_10_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bf_10                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_10.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/Bf_10_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_10-sr/Bf_10_genome.fasta -n Bf_10_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr -p Bf_10 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:13:34 2023]
Error in rule pharokka_flye:
    jobid: 581
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_10-sr/Bf_10_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/Bf_10.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/Bf_10_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/Bf_10_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/Bf_10_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/Bf_10_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/Bf_10_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_10.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_10-sr/Bf_10_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_10-sr/Bf_10_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bf_10                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_10.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr/Bf_10_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_10-sr/Bf_10_genome.fasta -n Bf_10_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_10-sr -p Bf_10 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_10.log not found.

Select jobs to execute...
[Thu Nov 23 10:13:42 2023]
Finished job 265.
26 of 759 steps (3%) done
[Thu Nov 23 10:13:57 2023]
Finished job 41.
27 of 759 steps (4%) done

[Thu Nov 23 10:13:57 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Ecoli_37.log
    jobid: 205
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Ecoli_37.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/assembly.fasta
    wildcards: sample=Ecoli_37
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Ecoli_37.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_

[Thu Nov 23 10:13:57 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Ecoli_37.log
    jobid: 293
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Ecoli_37.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/assembly.fasta
    wildcards: sample=Ecoli_37
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Ecoli_37.log
        fi
        

Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_
[Thu Nov 23 10:13:57 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Ecoli_37.log
    jobid: 206
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Ecoli_37.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/assembly_graph.gfa
    wildcards: sample=Ecoli_37
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:13:57 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_37_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ecoli_37.log
    jobid: 104
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Ecoli_37.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_37_S.subsampled.fastq.gz
    wildcards: sample=Ecoli_37
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_37_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ecoli_37.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmppcsrbzka.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:13:58 2023]
Finished job 206.
28 of 759 steps (4%) done
Select jobs to execute...

[Thu Nov 23 10:13:58 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_37-sr/Ecoli_37_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Ecoli_37.log
    jobid: 734
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_37-sr/Ecoli_37_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/flye.log
    wildcards: sample=Ecoli_37
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_37-sr/Ecoli_37-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_37-sr/Ecoli_37-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/Ecoli_37_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/Ecoli_37_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_37-sr/Ecoli_37_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_37-sr/Ecoli_37.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_37-sr/Ecoli_37_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_37-sr/Ecoli_37.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/Ecoli_37_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_37-sr/Ecoli_37_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_37-sr/Ecoli_37-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_37-sr/Ecoli_37_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_37-sr/Ecoli_37-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_37-sr/Ecoli_37_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_37-sr/Ecoli_37-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_37-sr/Ecoli_37_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/Ecoli_37_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_37-sr/Ecoli_37_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_37-sr/Ecoli_37-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_37-sr/Ecoli_37_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_37-sr/Ecoli_37-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_37-sr/Ecoli_37_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_37-sr/Ecoli_37-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_37-sr/Ecoli_37_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/Ecoli_37_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_37-sr/Ecoli_37_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/Ecoli_37_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_37-sr/Ecoli_37_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/Ecoli_37_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_37-sr/Ecoli_37_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_37-sr/Ecoli_37_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_37-sr/Ecoli_37_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_37-sr/Ecoli_37_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_37-sr/Ecoli_37_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_37-sr/Ecoli_37_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_37-sr/Ecoli_37_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/Ecoli_37_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_37-sr/Ecoli_37_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_37-sr/Ecoli_37_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Ecoli_37" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_37-sr/Ecoli_37_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_37-sr/Ecoli_37_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Ecoli_37" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_37-sr/Ecoli_37_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_37-sr/Ecoli_37_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Ecoli_37" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_37-sr/Ecoli_37_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_37-sr/Ecoli_37_summary.txt
        fi
        
[Thu Nov 23 10:13:58 2023]
Finished job 734.
29 of 759 steps (4%) done
Select jobs to execute...
[Thu Nov 23 10:14:09 2023]
Finished job 149.
30 of 759 steps (4%) done

[Thu Nov 23 10:14:09 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bu_09-assembly-stats_flye.csv
    jobid: 328
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bu_09-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/checkv/quality_summary.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/graph_seq_details_flye.tsv
    wildcards: sample=Bu_09
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:14:10 2023]
Finished job 293.
31 of 759 steps (4%) done
Select jobs to execute...
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp3ukn2w1o.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:14:11 2023]
Finished job 328.
32 of 759 steps (4%) done

[Thu Nov 23 10:14:11 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bu_09-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_09-sr/Bu_09-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Bu_09.log
    jobid: 402
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_09-sr/Bu_09-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bu_09-assembly-stats_flye.csv
    wildcards: sample=Bu_09
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpfysbc4oa.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:14:12 2023]
Finished job 402.
33 of 759 steps (4%) done
Select jobs to execute...

[Thu Nov 23 10:14:12 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_09-sr/Bu_09-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_09-sr/Bu_09.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Bu_09.log
    jobid: 401
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_09-sr/Bu_09.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_09-sr/Bu_09-genome-candidates.csv
    wildcards: sample=Bu_09
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_09-sr/Bu_09-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_09-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_09-sr/Bu_09.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_09-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_09-sr/Bu_09.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:14:12 2023]
Finished job 401.
34 of 759 steps (4%) done
Select jobs to execute...

[Thu Nov 23 10:14:12 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_09-sr/Bu_09.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_09-sr/Bu_09_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_09-sr/Bu_09_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Bu_09.log
    jobid: 528
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_09-sr/Bu_09_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_09-sr/Bu_09.fasta
    wildcards: sample=Bu_09
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpkv4cu7rm.rename_genomes.py
[Thu Nov 23 10:14:12 2023]
Finished job 528.
35 of 759 steps (5%) done
Select jobs to execute...

[Thu Nov 23 10:14:12 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_09-sr/Bu_09_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/Bu_09.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/Bu_09_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/Bu_09_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/Bu_09_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/Bu_09_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/Bu_09_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_09.log
    jobid: 527
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/Bu_09_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/Bu_09.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/Bu_09_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/Bu_09_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/Bu_09_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/Bu_09_top_hits_mash_inphared.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_09-sr/Bu_09_genome.fasta
    wildcards: sample=Bu_09
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_09-sr/Bu_09_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_09-sr/Bu_09_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bu_09                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_09.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/Bu_09_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_09-sr/Bu_09_genome.fasta -n Bu_09_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr -p Bu_09 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:14:13 2023]
Error in rule pharokka_flye:
    jobid: 527
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_09-sr/Bu_09_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/Bu_09.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/Bu_09_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/Bu_09_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/Bu_09_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/Bu_09_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/Bu_09_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_09.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_09-sr/Bu_09_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_09-sr/Bu_09_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bu_09                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_09.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr/Bu_09_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_09-sr/Bu_09_genome.fasta -n Bu_09_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_09-sr -p Bu_09 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_09.log not found.

Select jobs to execute...
[Thu Nov 23 10:14:21 2023]
Finished job 104.
36 of 759 steps (5%) done

[Thu Nov 23 10:14:21 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_09_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_09.log
    jobid: 76
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Bu_09.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_09_S.subsampled.fastq.gz
    wildcards: sample=Bu_09
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_09_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_09.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_09-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:14:37 2023]
Finished job 76.
37 of 759 steps (5%) done
Select jobs to execute...

[Thu Nov 23 10:14:37 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_20_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bu_20.log
    jobid: 10
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Bu_20.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/assembly_info.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_20_S.subsampled.fastq.gz
    wildcards: sample=Bu_20
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_20_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bu_20.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:14:41 2023]
Finished job 205.
38 of 759 steps (5%) done
Select jobs to execute...

[Thu Nov 23 10:14:41 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_06_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bf_06.log
    jobid: 4
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Bf_06.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/assembly.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_06_S.subsampled.fastq.gz
    wildcards: sample=Bf_06
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_06_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bf_06.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:15:29 2023]
Finished job 10.
39 of 759 steps (5%) done
Select jobs to execute...

[Thu Nov 23 10:15:29 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_20-sr/Bu_20_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Bu_20.log
    jobid: 703
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_20-sr/Bu_20_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/flye.log
    wildcards: sample=Bu_20
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_20-sr/Bu_20-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_20-sr/Bu_20-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/Bu_20_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/Bu_20_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_20-sr/Bu_20_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_20-sr/Bu_20.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_20-sr/Bu_20_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_20-sr/Bu_20.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/Bu_20_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_20-sr/Bu_20_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_20-sr/Bu_20-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_20-sr/Bu_20_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_20-sr/Bu_20-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_20-sr/Bu_20_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_20-sr/Bu_20-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_20-sr/Bu_20_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/Bu_20_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_20-sr/Bu_20_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_20-sr/Bu_20-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_20-sr/Bu_20_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_20-sr/Bu_20-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_20-sr/Bu_20_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_20-sr/Bu_20-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_20-sr/Bu_20_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/Bu_20_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_20-sr/Bu_20_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/Bu_20_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_20-sr/Bu_20_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/Bu_20_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_20-sr/Bu_20_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_20-sr/Bu_20_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_20-sr/Bu_20_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_20-sr/Bu_20_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_20-sr/Bu_20_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_20-sr/Bu_20_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_20-sr/Bu_20_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/Bu_20_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_20-sr/Bu_20_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_20-sr/Bu_20_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Bu_20" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_20-sr/Bu_20_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_20-sr/Bu_20_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Bu_20" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_20-sr/Bu_20_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_20-sr/Bu_20_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Bu_20" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_20-sr/Bu_20_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_20-sr/Bu_20_summary.txt
        fi
        

[Thu Nov 23 10:15:29 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_37-assembly-stats_flye.csv
    jobid: 356
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_37-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/checkv/quality_summary.tsv
    wildcards: sample=Ecoli_37
    resources: tmpdir=/local/nala0006/2279907

[Thu Nov 23 10:15:29 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bu_20.log
    jobid: 262
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Bu_20.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/assembly.fasta
    wildcards: sample=Bu_20
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bu_20.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_

Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_
[Thu Nov 23 10:15:29 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bu_20.log
    jobid: 143
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Bu_20.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/assembly.fasta
    wildcards: sample=Bu_20
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bu_20.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_

[Thu Nov 23 10:15:29 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Bu_20.log
    jobid: 144
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Bu_20.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/assembly_info.txt
    wildcards: sample=Bu_20
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:15:29 2023]
Finished job 703.
40 of 759 steps (5%) done
Select jobs to execute...
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpujyqi1fi.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpnz3gcr28.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:15:30 2023]
Finished job 144.
41 of 759 steps (5%) done
[Thu Nov 23 10:15:30 2023]
Finished job 356.
42 of 759 steps (6%) done

[Thu Nov 23 10:15:30 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_37-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_37-sr/Ecoli_37-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Ecoli_37.log
    jobid: 458
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_37-sr/Ecoli_37-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_37-assembly-stats_flye.csv
    wildcards: sample=Ecoli_37
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp8kpia9c1.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:15:32 2023]
Finished job 458.
43 of 759 steps (6%) done
Select jobs to execute...

[Thu Nov 23 10:15:32 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_37-sr/Ecoli_37-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_37-sr/Ecoli_37.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Ecoli_37.log
    jobid: 457
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_37-sr/Ecoli_37.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_37-sr/Ecoli_37-genome-candidates.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/assembly.fasta
    wildcards: sample=Ecoli_37
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_37-sr/Ecoli_37-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_37-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_37-sr/Ecoli_37.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_37-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_37-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_37-sr/Ecoli_37.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:15:32 2023]
Finished job 457.
44 of 759 steps (6%) done
Select jobs to execute...

[Thu Nov 23 10:15:32 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_37-sr/Ecoli_37.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_37-sr/Ecoli_37_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_37-sr/Ecoli_37_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Ecoli_37.log
    jobid: 584
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_37-sr/Ecoli_37_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_37-sr/Ecoli_37.fasta
    wildcards: sample=Ecoli_37
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmplhg3945z.rename_genomes.py
[Thu Nov 23 10:15:32 2023]
Finished job 584.
45 of 759 steps (6%) done
Select jobs to execute...

[Thu Nov 23 10:15:32 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_37-sr/Ecoli_37_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/Ecoli_37.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/Ecoli_37_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/Ecoli_37_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/Ecoli_37_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/Ecoli_37_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/Ecoli_37_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_37.log
    jobid: 583
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/Ecoli_37_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/Ecoli_37_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/Ecoli_37_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/Ecoli_37_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/Ecoli_37.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/Ecoli_37_top_hits_mash_inphared.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_37-sr/Ecoli_37_genome.fasta
    wildcards: sample=Ecoli_37
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_37-sr/Ecoli_37_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_37-sr/Ecoli_37_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Ecoli_37                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_37.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/Ecoli_37_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_37-sr/Ecoli_37_genome.fasta -n Ecoli_37_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr -p Ecoli_37 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:15:33 2023]
Error in rule pharokka_flye:
    jobid: 583
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_37-sr/Ecoli_37_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/Ecoli_37.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/Ecoli_37_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/Ecoli_37_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/Ecoli_37_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/Ecoli_37_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/Ecoli_37_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_37.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_37-sr/Ecoli_37_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_37-sr/Ecoli_37_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Ecoli_37                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_37.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr/Ecoli_37_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_37-sr/Ecoli_37_genome.fasta -n Ecoli_37_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_37-sr -p Ecoli_37 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_37.log not found.

Select jobs to execute...
[Thu Nov 23 10:15:42 2023]
Finished job 262.
46 of 759 steps (6%) done
[Thu Nov 23 10:16:10 2023]
Finished job 143.
47 of 759 steps (6%) done

[Thu Nov 23 10:16:10 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_20_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_20.log
    jobid: 73
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Bu_20.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_20_S.subsampled.fastq.gz
    wildcards: sample=Bu_20
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_20_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_20.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:17:19 2023]
Finished job 4.
48 of 759 steps (6%) done
Select jobs to execute...

[Thu Nov 23 10:17:19 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_06-sr/Bf_06_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Bf_06.log
    jobid: 697
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_06-sr/Bf_06_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/flye.log
    wildcards: sample=Bf_06
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_06-sr/Bf_06-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_06-sr/Bf_06-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/Bf_06_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/Bf_06_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_06-sr/Bf_06_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_06-sr/Bf_06.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_06-sr/Bf_06_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_06-sr/Bf_06.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/Bf_06_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_06-sr/Bf_06_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_06-sr/Bf_06-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_06-sr/Bf_06_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_06-sr/Bf_06-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_06-sr/Bf_06_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_06-sr/Bf_06-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_06-sr/Bf_06_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/Bf_06_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_06-sr/Bf_06_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_06-sr/Bf_06-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_06-sr/Bf_06_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_06-sr/Bf_06-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_06-sr/Bf_06_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_06-sr/Bf_06-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_06-sr/Bf_06_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/Bf_06_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_06-sr/Bf_06_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/Bf_06_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_06-sr/Bf_06_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/Bf_06_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_06-sr/Bf_06_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_06-sr/Bf_06_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_06-sr/Bf_06_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_06-sr/Bf_06_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_06-sr/Bf_06_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_06-sr/Bf_06_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_06-sr/Bf_06_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/Bf_06_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_06-sr/Bf_06_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_06-sr/Bf_06_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Bf_06" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_06-sr/Bf_06_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_06-sr/Bf_06_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Bf_06" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_06-sr/Bf_06_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_06-sr/Bf_06_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Bf_06" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_06-sr/Bf_06_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_06-sr/Bf_06_summary.txt
        fi
        

[Thu Nov 23 10:17:19 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Bf_06.log
    jobid: 132
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Bf_06.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/assembly.fasta
    wildcards: sample=Bf_06
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:17:19 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bu_20-assembly-stats_flye.csv
    jobid: 325
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bu_20-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/checkv/quality_summary.tsv
    wildcards: sample=Bu_20
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_

[Thu Nov 23 10:17:19 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bf_06.log
    jobid: 131
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Bf_06.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/assembly.fasta
    wildcards: sample=Bf_06
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bf_06.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_

[Thu Nov 23 10:17:19 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bf_06.log
    jobid: 256
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Bf_06.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/assembly.fasta
    wildcards: sample=Bf_06
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bf_06.log
        fi
        
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_
[Thu Nov 23 10:17:19 2023]
Finished job 697.
49 of 759 steps (6%) done
Select jobs to execute...
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpwydr6cgc.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmphrrb70y8.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:17:20 2023]
Finished job 132.
50 of 759 steps (7%) done
[Thu Nov 23 10:17:20 2023]
Finished job 325.
51 of 759 steps (7%) done

[Thu Nov 23 10:17:20 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bu_20-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_20-sr/Bu_20-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Bu_20.log
    jobid: 396
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_20-sr/Bu_20-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bu_20-assembly-stats_flye.csv
    wildcards: sample=Bu_20
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp916bxmgw.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:17:21 2023]
Finished job 396.
52 of 759 steps (7%) done
Select jobs to execute...

[Thu Nov 23 10:17:21 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_20-sr/Bu_20-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_20-sr/Bu_20.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Bu_20.log
    jobid: 395
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_20-sr/Bu_20.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_20-sr/Bu_20-genome-candidates.csv
    wildcards: sample=Bu_20
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_20-sr/Bu_20-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_20-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_20-sr/Bu_20.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_20-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_20-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_20-sr/Bu_20.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:17:22 2023]
Finished job 395.
53 of 759 steps (7%) done
Select jobs to execute...

[Thu Nov 23 10:17:22 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_20-sr/Bu_20.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_20-sr/Bu_20_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_20-sr/Bu_20_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Bu_20.log
    jobid: 522
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_20-sr/Bu_20_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_20-sr/Bu_20.fasta
    wildcards: sample=Bu_20
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpcmtnmod3.rename_genomes.py
[Thu Nov 23 10:17:22 2023]
Finished job 522.
54 of 759 steps (7%) done
Select jobs to execute...

[Thu Nov 23 10:17:22 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_20-sr/Bu_20_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/Bu_20.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/Bu_20_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/Bu_20_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/Bu_20_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/Bu_20_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/Bu_20_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_20.log
    jobid: 521
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/Bu_20_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/Bu_20_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/Bu_20_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/Bu_20_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/Bu_20_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/Bu_20.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/top_hits_vfdb.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_20-sr/Bu_20_genome.fasta
    wildcards: sample=Bu_20
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_20-sr/Bu_20_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_20-sr/Bu_20_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bu_20                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_20.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/Bu_20_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_20-sr/Bu_20_genome.fasta -n Bu_20_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr -p Bu_20 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:17:22 2023]
Error in rule pharokka_flye:
    jobid: 521
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_20-sr/Bu_20_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/Bu_20.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/Bu_20_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/Bu_20_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/Bu_20_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/Bu_20_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/Bu_20_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_20.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_20-sr/Bu_20_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_20-sr/Bu_20_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bu_20                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_20.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr/Bu_20_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_20-sr/Bu_20_genome.fasta -n Bu_20_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_20-sr -p Bu_20 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_20.log not found.

Select jobs to execute...
[Thu Nov 23 10:17:31 2023]
Finished job 256.
55 of 759 steps (7%) done
[Thu Nov 23 10:17:46 2023]
Finished job 73.
56 of 759 steps (7%) done

[Thu Nov 23 10:17:46 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_06_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bf_06.log
    jobid: 67
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Bf_06.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_06_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/assembly.fasta
    wildcards: sample=Bf_06
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_06_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bf_06.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:18:00 2023]
Finished job 131.
57 of 759 steps (8%) done
Select jobs to execute...

[Thu Nov 23 10:18:00 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_18_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bb_18.log
    jobid: 58
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Bb_18.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/flye.log; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_18_S.subsampled.fastq.gz
    wildcards: sample=Bb_18
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_18_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bb_18.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:18:20 2023]
Finished job 58.
58 of 759 steps (8%) done
Select jobs to execute...

[Thu Nov 23 10:18:20 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_18-sr/Bb_18_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Bb_18.log
    jobid: 751
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_18-sr/Bb_18_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/flye.log
    wildcards: sample=Bb_18
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_18-sr/Bb_18-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_18-sr/Bb_18-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/Bb_18_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/Bb_18_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_18-sr/Bb_18_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_18-sr/Bb_18.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_18-sr/Bb_18_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_18-sr/Bb_18.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/Bb_18_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_18-sr/Bb_18_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_18-sr/Bb_18-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_18-sr/Bb_18_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_18-sr/Bb_18-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_18-sr/Bb_18_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_18-sr/Bb_18-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_18-sr/Bb_18_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/Bb_18_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_18-sr/Bb_18_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_18-sr/Bb_18-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_18-sr/Bb_18_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_18-sr/Bb_18-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_18-sr/Bb_18_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_18-sr/Bb_18-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_18-sr/Bb_18_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/Bb_18_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_18-sr/Bb_18_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/Bb_18_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_18-sr/Bb_18_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/Bb_18_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_18-sr/Bb_18_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_18-sr/Bb_18_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_18-sr/Bb_18_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_18-sr/Bb_18_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_18-sr/Bb_18_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_18-sr/Bb_18_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_18-sr/Bb_18_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/Bb_18_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_18-sr/Bb_18_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_18-sr/Bb_18_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Bb_18" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_18-sr/Bb_18_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_18-sr/Bb_18_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Bb_18" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_18-sr/Bb_18_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_18-sr/Bb_18_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Bb_18" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_18-sr/Bb_18_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_18-sr/Bb_18_summary.txt
        fi
        

[Thu Nov 23 10:18:20 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bb_18.log
    jobid: 239
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Bb_18.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/assembly.fasta
    wildcards: sample=Bb_18
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bb_18.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_

[Thu Nov 23 10:18:20 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bb_18.log
    jobid: 310
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Bb_18.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/assembly.fasta
    wildcards: sample=Bb_18
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bb_18.log
        fi
        
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_

[Thu Nov 23 10:18:20 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_06-assembly-stats_flye.csv
    jobid: 319
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_06-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/checkv/quality_summary.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/assembly_result_table.csv
    wildcards: sample=Bf_06
    resources: tmpdir=/local/nala0006/2279907

[Thu Nov 23 10:18:20 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Bb_18.log
    jobid: 240
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Bb_18.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/assembly_graph.gfa
    wildcards: sample=Bb_18
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:18:20 2023]
Finished job 751.
59 of 759 steps (8%) done
Select jobs to execute...
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmplu0dhoc3.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpraw7odh6.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:18:22 2023]
Finished job 240.
60 of 759 steps (8%) done
[Thu Nov 23 10:18:22 2023]
Finished job 319.
61 of 759 steps (8%) done

[Thu Nov 23 10:18:22 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_06-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_06-sr/Bf_06-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Bf_06.log
    jobid: 384
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_06-sr/Bf_06-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_06-assembly-stats_flye.csv
    wildcards: sample=Bf_06
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpieq2nw1o.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:18:23 2023]
Finished job 384.
62 of 759 steps (8%) done
Select jobs to execute...

[Thu Nov 23 10:18:23 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_06-sr/Bf_06-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_06-sr/Bf_06.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Bf_06.log
    jobid: 383
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_06-sr/Bf_06.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_06-sr/Bf_06-genome-candidates.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/assembly.fasta
    wildcards: sample=Bf_06
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_06-sr/Bf_06-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_06-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_06-sr/Bf_06.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_06-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_06-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_06-sr/Bf_06.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:18:23 2023]
Finished job 383.
63 of 759 steps (8%) done
Select jobs to execute...

[Thu Nov 23 10:18:23 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_06-sr/Bf_06.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_06-sr/Bf_06_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_06-sr/Bf_06_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Bf_06.log
    jobid: 510
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_06-sr/Bf_06_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_06-sr/Bf_06.fasta
    wildcards: sample=Bf_06
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpbhu2mdqz.rename_genomes.py
[Thu Nov 23 10:18:24 2023]
Finished job 510.
64 of 759 steps (8%) done
Select jobs to execute...

[Thu Nov 23 10:18:24 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_06-sr/Bf_06_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/Bf_06.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/Bf_06_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/Bf_06_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/Bf_06_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/Bf_06_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/Bf_06_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_06.log
    jobid: 509
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/Bf_06_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/Bf_06_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/Bf_06_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/Bf_06_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/Bf_06.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/Bf_06_top_hits_mash_inphared.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_06-sr/Bf_06_genome.fasta
    wildcards: sample=Bf_06
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_06-sr/Bf_06_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_06-sr/Bf_06_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bf_06                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_06.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/Bf_06_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_06-sr/Bf_06_genome.fasta -n Bf_06_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr -p Bf_06 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:18:24 2023]
Error in rule pharokka_flye:
    jobid: 509
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_06-sr/Bf_06_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/Bf_06.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/Bf_06_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/Bf_06_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/Bf_06_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/Bf_06_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/Bf_06_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_06.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_06-sr/Bf_06_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_06-sr/Bf_06_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bf_06                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_06.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr/Bf_06_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_06-sr/Bf_06_genome.fasta -n Bf_06_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_06-sr -p Bf_06 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_06.log not found.

Select jobs to execute...
[Thu Nov 23 10:18:42 2023]
Finished job 310.
65 of 759 steps (9%) done
[Thu Nov 23 10:19:53 2023]
Finished job 239.
66 of 759 steps (9%) done

[Thu Nov 23 10:19:53 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_18_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bb_18.log
    jobid: 121
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Bb_18.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_18_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/assembly.fasta
    wildcards: sample=Bb_18
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_18_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bb_18.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:19:56 2023]
Finished job 67.
67 of 759 steps (9%) done
Select jobs to execute...

[Thu Nov 23 10:19:56 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_29_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Ecoli_29.log
    jobid: 33
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Ecoli_29.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/assembly_graph.gfa; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_29_S.subsampled.fastq.gz
    wildcards: sample=Ecoli_29
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_29_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Ecoli_29.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:20:20 2023]
Finished job 121.
68 of 759 steps (9%) done
Select jobs to execute...

[Thu Nov 23 10:20:20 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_05_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bf_05.log
    jobid: 63
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Bf_05.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/assembly_info.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_05_S.subsampled.fastq.gz
    wildcards: sample=Bf_05
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_05_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bf_05.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:21:56 2023]
Finished job 63.
69 of 759 steps (9%) done
Select jobs to execute...

[Thu Nov 23 10:21:56 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_05-sr/Bf_05_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Bf_05.log
    jobid: 756
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_05-sr/Bf_05_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/flye.log
    wildcards: sample=Bf_05
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_05-sr/Bf_05-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_05-sr/Bf_05-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/Bf_05_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/Bf_05_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_05-sr/Bf_05_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_05-sr/Bf_05.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_05-sr/Bf_05_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_05-sr/Bf_05.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/Bf_05_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_05-sr/Bf_05_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_05-sr/Bf_05-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_05-sr/Bf_05_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_05-sr/Bf_05-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_05-sr/Bf_05_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_05-sr/Bf_05-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_05-sr/Bf_05_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/Bf_05_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_05-sr/Bf_05_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_05-sr/Bf_05-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_05-sr/Bf_05_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_05-sr/Bf_05-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_05-sr/Bf_05_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_05-sr/Bf_05-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_05-sr/Bf_05_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/Bf_05_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_05-sr/Bf_05_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/Bf_05_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_05-sr/Bf_05_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/Bf_05_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_05-sr/Bf_05_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_05-sr/Bf_05_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_05-sr/Bf_05_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_05-sr/Bf_05_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_05-sr/Bf_05_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_05-sr/Bf_05_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_05-sr/Bf_05_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/Bf_05_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_05-sr/Bf_05_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_05-sr/Bf_05_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Bf_05" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_05-sr/Bf_05_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_05-sr/Bf_05_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Bf_05" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_05-sr/Bf_05_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_05-sr/Bf_05_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Bf_05" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_05-sr/Bf_05_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_05-sr/Bf_05_summary.txt
        fi
        

[Thu Nov 23 10:21:56 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Bf_05.log
    jobid: 250
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Bf_05.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/assembly_info.txt
    wildcards: sample=Bf_05
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:21:56 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bf_05.log
    jobid: 315
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Bf_05.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/assembly.fasta
    wildcards: sample=Bf_05
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bf_05.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_

[Thu Nov 23 10:21:56 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bb_18-assembly-stats_flye.csv
    jobid: 373
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bb_18-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/checkv/quality_summary.tsv
    wildcards: sample=Bb_18
    resources: tmpdir=/local/nala0006/2279907

[Thu Nov 23 10:21:56 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bf_05.log
    jobid: 249
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Bf_05.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/assembly.fasta
    wildcards: sample=Bf_05
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bf_05.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_
[Thu Nov 23 10:21:56 2023]
Finished job 756.
70 of 759 steps (9%) done
Select jobs to execute...
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpyq2xjli6.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp64c5pzq1.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:21:57 2023]
Finished job 250.
71 of 759 steps (9%) done
[Thu Nov 23 10:21:57 2023]
Finished job 373.
72 of 759 steps (9%) done

[Thu Nov 23 10:21:57 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bb_18-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_18-sr/Bb_18-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Bb_18.log
    jobid: 492
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_18-sr/Bb_18-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bb_18-assembly-stats_flye.csv
    wildcards: sample=Bb_18
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpr8o2tmqc.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:21:58 2023]
Finished job 492.
73 of 759 steps (10%) done
Select jobs to execute...

[Thu Nov 23 10:21:58 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_18-sr/Bb_18-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_18-sr/Bb_18.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Bb_18.log
    jobid: 491
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_18-sr/Bb_18.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_18-sr/Bb_18-genome-candidates.csv
    wildcards: sample=Bb_18
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_18-sr/Bb_18-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_18-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_18-sr/Bb_18.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_18-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_18-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_18-sr/Bb_18.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:21:58 2023]
Finished job 491.
74 of 759 steps (10%) done
Select jobs to execute...

[Thu Nov 23 10:21:58 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_18-sr/Bb_18.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_18-sr/Bb_18_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_18-sr/Bb_18_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Bb_18.log
    jobid: 618
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_18-sr/Bb_18_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_18-sr/Bb_18.fasta
    wildcards: sample=Bb_18
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpxom7w6h9.rename_genomes.py
[Thu Nov 23 10:21:59 2023]
Finished job 618.
75 of 759 steps (10%) done
Select jobs to execute...

[Thu Nov 23 10:21:59 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_18-sr/Bb_18_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/Bb_18.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/Bb_18_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/Bb_18_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/Bb_18_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/Bb_18_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/Bb_18_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bb_18.log
    jobid: 617
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/Bb_18_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/Bb_18_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/Bb_18_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/Bb_18_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/Bb_18.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/Bb_18_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/top_hits_vfdb.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_18-sr/Bb_18_genome.fasta
    wildcards: sample=Bb_18
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_18-sr/Bb_18_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_18-sr/Bb_18_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bb_18                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bb_18.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/Bb_18_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_18-sr/Bb_18_genome.fasta -n Bb_18_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr -p Bb_18 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:21:59 2023]
Error in rule pharokka_flye:
    jobid: 617
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_18-sr/Bb_18_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/Bb_18.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/Bb_18_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/Bb_18_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/Bb_18_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/Bb_18_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/Bb_18_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bb_18.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_18-sr/Bb_18_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_18-sr/Bb_18_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bb_18                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bb_18.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr/Bb_18_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_18-sr/Bb_18_genome.fasta -n Bb_18_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_18-sr -p Bb_18 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bb_18.log not found.

Select jobs to execute...
[Thu Nov 23 10:22:08 2023]
Finished job 315.
76 of 759 steps (10%) done
[Thu Nov 23 10:22:22 2023]
Finished job 33.
77 of 759 steps (10%) done

[Thu Nov 23 10:22:22 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_29_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ecoli_29.log
    jobid: 96
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Ecoli_29.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_29_S.subsampled.fastq.gz
    wildcards: sample=Ecoli_29
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_29_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ecoli_29.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/consensus.fasta
        fi
        

Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:22:22 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Ecoli_29.log
    jobid: 189
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Ecoli_29.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/assembly.fasta
    wildcards: sample=Ecoli_29
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Ecoli_29.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_

[Thu Nov 23 10:22:22 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Ecoli_29.log
    jobid: 190
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Ecoli_29.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/assembly_graph.gfa
    wildcards: sample=Ecoli_29
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:22:22 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Ecoli_29.log
    jobid: 285
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Ecoli_29.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/assembly.fasta
    wildcards: sample=Ecoli_29
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Ecoli_29.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp4ccptczf.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:22:23 2023]
Finished job 190.
78 of 759 steps (10%) done
Select jobs to execute...

[Thu Nov 23 10:22:23 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_29-sr/Ecoli_29_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Ecoli_29.log
    jobid: 726
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_29-sr/Ecoli_29_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/flye.log
    wildcards: sample=Ecoli_29
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_29-sr/Ecoli_29-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_29-sr/Ecoli_29-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/Ecoli_29_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/Ecoli_29_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_29-sr/Ecoli_29_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_29-sr/Ecoli_29.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_29-sr/Ecoli_29_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_29-sr/Ecoli_29.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/Ecoli_29_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_29-sr/Ecoli_29_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_29-sr/Ecoli_29-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_29-sr/Ecoli_29_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_29-sr/Ecoli_29-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_29-sr/Ecoli_29_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_29-sr/Ecoli_29-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_29-sr/Ecoli_29_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/Ecoli_29_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_29-sr/Ecoli_29_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_29-sr/Ecoli_29-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_29-sr/Ecoli_29_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_29-sr/Ecoli_29-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_29-sr/Ecoli_29_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_29-sr/Ecoli_29-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_29-sr/Ecoli_29_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/Ecoli_29_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_29-sr/Ecoli_29_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/Ecoli_29_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_29-sr/Ecoli_29_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/Ecoli_29_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_29-sr/Ecoli_29_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_29-sr/Ecoli_29_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_29-sr/Ecoli_29_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_29-sr/Ecoli_29_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_29-sr/Ecoli_29_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_29-sr/Ecoli_29_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_29-sr/Ecoli_29_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/Ecoli_29_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_29-sr/Ecoli_29_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_29-sr/Ecoli_29_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Ecoli_29" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_29-sr/Ecoli_29_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_29-sr/Ecoli_29_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Ecoli_29" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_29-sr/Ecoli_29_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_29-sr/Ecoli_29_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Ecoli_29" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_29-sr/Ecoli_29_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_29-sr/Ecoli_29_summary.txt
        fi
        
[Thu Nov 23 10:22:23 2023]
Finished job 726.
79 of 759 steps (10%) done
Select jobs to execute...
[Thu Nov 23 10:22:35 2023]
Finished job 285.
80 of 759 steps (11%) done
[Thu Nov 23 10:22:37 2023]
Finished job 249.
81 of 759 steps (11%) done

[Thu Nov 23 10:22:37 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_05-assembly-stats_flye.csv
    jobid: 378
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_05-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/checkv/quality_summary.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/assembly_result_table.csv
    wildcards: sample=Bf_05
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmphc1x2l_f.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:22:38 2023]
Finished job 378.
82 of 759 steps (11%) done
Select jobs to execute...

[Thu Nov 23 10:22:38 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_05-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_05-sr/Bf_05-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Bf_05.log
    jobid: 502
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_05-sr/Bf_05-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_05-assembly-stats_flye.csv
    wildcards: sample=Bf_05
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp_9l_x2j2.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:22:39 2023]
Finished job 502.
83 of 759 steps (11%) done
Select jobs to execute...

[Thu Nov 23 10:22:39 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_05-sr/Bf_05-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_05-sr/Bf_05.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Bf_05.log
    jobid: 501
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_05-sr/Bf_05.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_05-sr/Bf_05-genome-candidates.csv
    wildcards: sample=Bf_05
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_05-sr/Bf_05-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_05-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_05-sr/Bf_05.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_05-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_05-sr/Bf_05.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:22:39 2023]
Finished job 501.
84 of 759 steps (11%) done
Select jobs to execute...

[Thu Nov 23 10:22:39 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_05-sr/Bf_05.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_05-sr/Bf_05_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_05-sr/Bf_05_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Bf_05.log
    jobid: 628
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_05-sr/Bf_05_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_05-sr/Bf_05.fasta
    wildcards: sample=Bf_05
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpf4gm2puf.rename_genomes.py
[Thu Nov 23 10:22:40 2023]
Finished job 628.
85 of 759 steps (11%) done
Select jobs to execute...

[Thu Nov 23 10:22:40 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_05-sr/Bf_05_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/Bf_05.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/Bf_05_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/Bf_05_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/Bf_05_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/Bf_05_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/Bf_05_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_05.log
    jobid: 627
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/Bf_05.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/Bf_05_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/Bf_05_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/Bf_05_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/Bf_05_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/Bf_05_pharokka_plot.png; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_05-sr/Bf_05_genome.fasta
    wildcards: sample=Bf_05
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_05-sr/Bf_05_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_05-sr/Bf_05_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bf_05                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_05.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/Bf_05_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_05-sr/Bf_05_genome.fasta -n Bf_05_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr -p Bf_05 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:22:40 2023]
Error in rule pharokka_flye:
    jobid: 627
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_05-sr/Bf_05_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/Bf_05.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/Bf_05_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/Bf_05_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/Bf_05_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/Bf_05_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/Bf_05_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_05.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_05-sr/Bf_05_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_05-sr/Bf_05_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bf_05                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_05.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr/Bf_05_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_05-sr/Bf_05_genome.fasta -n Bf_05_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_05-sr -p Bf_05 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_05.log not found.

Select jobs to execute...
[Thu Nov 23 10:22:44 2023]
Finished job 96.
86 of 759 steps (11%) done

[Thu Nov 23 10:22:44 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_05_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bf_05.log
    jobid: 126
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Bf_05.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_05_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/assembly.fasta
    wildcards: sample=Bf_05
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_05_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bf_05.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_05-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:23:01 2023]
Finished job 126.
87 of 759 steps (11%) done
Select jobs to execute...

[Thu Nov 23 10:23:01 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_27_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Ecoli_27.log
    jobid: 55
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Ecoli_27.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/assembly.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_27_S.subsampled.fastq.gz
    wildcards: sample=Ecoli_27
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_27_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Ecoli_27.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:23:05 2023]
Finished job 189.
88 of 759 steps (12%) done
Select jobs to execute...

[Thu Nov 23 10:23:05 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_12_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bf_12.log
    jobid: 34
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Bf_12.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/assembly_info.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_12_S.subsampled.fastq.gz
    wildcards: sample=Bf_12
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_12_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bf_12.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:24:50 2023]
Finished job 34.
89 of 759 steps (12%) done
Select jobs to execute...

[Thu Nov 23 10:24:50 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_12-sr/Bf_12_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Bf_12.log
    jobid: 727
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_12-sr/Bf_12_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/flye.log
    wildcards: sample=Bf_12
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_12-sr/Bf_12-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_12-sr/Bf_12-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/Bf_12_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/Bf_12_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_12-sr/Bf_12_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_12-sr/Bf_12.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_12-sr/Bf_12_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_12-sr/Bf_12.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/Bf_12_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_12-sr/Bf_12_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_12-sr/Bf_12-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_12-sr/Bf_12_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_12-sr/Bf_12-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_12-sr/Bf_12_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_12-sr/Bf_12-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_12-sr/Bf_12_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/Bf_12_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_12-sr/Bf_12_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_12-sr/Bf_12-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_12-sr/Bf_12_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_12-sr/Bf_12-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_12-sr/Bf_12_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_12-sr/Bf_12-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_12-sr/Bf_12_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/Bf_12_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_12-sr/Bf_12_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/Bf_12_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_12-sr/Bf_12_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/Bf_12_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_12-sr/Bf_12_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_12-sr/Bf_12_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_12-sr/Bf_12_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_12-sr/Bf_12_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_12-sr/Bf_12_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_12-sr/Bf_12_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_12-sr/Bf_12_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/Bf_12_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_12-sr/Bf_12_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_12-sr/Bf_12_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Bf_12" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_12-sr/Bf_12_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_12-sr/Bf_12_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Bf_12" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_12-sr/Bf_12_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_12-sr/Bf_12_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Bf_12" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_12-sr/Bf_12_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_12-sr/Bf_12_summary.txt
        fi
        

[Thu Nov 23 10:24:50 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bf_12.log
    jobid: 286
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Bf_12.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/assembly.fasta
    wildcards: sample=Bf_12
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bf_12.log
        fi
        
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_

[Thu Nov 23 10:24:50 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Bf_12.log
    jobid: 192
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Bf_12.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/assembly_info.txt
    wildcards: sample=Bf_12
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:24:50 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_29-assembly-stats_flye.csv
    jobid: 348
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_29-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/checkv/quality_summary.tsv
    wildcards: sample=Ecoli_29
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_

[Thu Nov 23 10:24:50 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bf_12.log
    jobid: 191
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Bf_12.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/assembly.fasta
    wildcards: sample=Bf_12
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bf_12.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_
[Thu Nov 23 10:24:50 2023]
Finished job 727.
90 of 759 steps (12%) done
Select jobs to execute...
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp2kjuni4u.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp7dnyfb2k.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:24:52 2023]
Finished job 192.
91 of 759 steps (12%) done
[Thu Nov 23 10:24:52 2023]
Finished job 348.
92 of 759 steps (12%) done

[Thu Nov 23 10:24:52 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_29-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_29-sr/Ecoli_29-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Ecoli_29.log
    jobid: 442
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_29-sr/Ecoli_29-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_29-assembly-stats_flye.csv
    wildcards: sample=Ecoli_29
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpuf5telys.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:24:53 2023]
Finished job 442.
93 of 759 steps (12%) done
Select jobs to execute...

[Thu Nov 23 10:24:53 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_29-sr/Ecoli_29-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_29-sr/Ecoli_29.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Ecoli_29.log
    jobid: 441
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_29-sr/Ecoli_29.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_29-sr/Ecoli_29-genome-candidates.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/assembly.fasta
    wildcards: sample=Ecoli_29
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_29-sr/Ecoli_29-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_29-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_29-sr/Ecoli_29.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_29-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_29-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_29-sr/Ecoli_29.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:24:53 2023]
Finished job 441.
94 of 759 steps (12%) done
Select jobs to execute...

[Thu Nov 23 10:24:53 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_29-sr/Ecoli_29.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_29-sr/Ecoli_29_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_29-sr/Ecoli_29_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Ecoli_29.log
    jobid: 568
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_29-sr/Ecoli_29_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_29-sr/Ecoli_29.fasta
    wildcards: sample=Ecoli_29
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpe6v822el.rename_genomes.py
[Thu Nov 23 10:24:54 2023]
Finished job 568.
95 of 759 steps (13%) done
Select jobs to execute...

[Thu Nov 23 10:24:54 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_29-sr/Ecoli_29_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/Ecoli_29.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/Ecoli_29_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/Ecoli_29_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/Ecoli_29_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/Ecoli_29_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/Ecoli_29_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_29.log
    jobid: 567
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/Ecoli_29_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/Ecoli_29_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/Ecoli_29.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/Ecoli_29_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/Ecoli_29_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/Ecoli_29_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/top_hits_vfdb.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_29-sr/Ecoli_29_genome.fasta
    wildcards: sample=Ecoli_29
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_29-sr/Ecoli_29_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_29-sr/Ecoli_29_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Ecoli_29                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_29.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/Ecoli_29_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_29-sr/Ecoli_29_genome.fasta -n Ecoli_29_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr -p Ecoli_29 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:24:54 2023]
Error in rule pharokka_flye:
    jobid: 567
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_29-sr/Ecoli_29_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/Ecoli_29.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/Ecoli_29_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/Ecoli_29_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/Ecoli_29_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/Ecoli_29_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/Ecoli_29_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_29.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_29-sr/Ecoli_29_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_29-sr/Ecoli_29_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Ecoli_29                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_29.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr/Ecoli_29_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_29-sr/Ecoli_29_genome.fasta -n Ecoli_29_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_29-sr -p Ecoli_29 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_29.log not found.

Select jobs to execute...
[Thu Nov 23 10:25:03 2023]
Finished job 286.
96 of 759 steps (13%) done
[Thu Nov 23 10:25:22 2023]
Finished job 55.
97 of 759 steps (13%) done

[Thu Nov 23 10:25:22 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Ecoli_27.log
    jobid: 233
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Ecoli_27.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/assembly.fasta
    wildcards: sample=Ecoli_27
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Ecoli_27.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_

[Thu Nov 23 10:25:22 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Ecoli_27.log
    jobid: 234
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Ecoli_27.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/assembly.fasta
    wildcards: sample=Ecoli_27
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:25:22 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_27_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ecoli_27.log
    jobid: 118
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Ecoli_27.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_27_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/assembly.fasta
    wildcards: sample=Ecoli_27
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_27_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ecoli_27.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/consensus.fasta
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_

[Thu Nov 23 10:25:22 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Ecoli_27.log
    jobid: 307
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Ecoli_27.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/assembly.fasta
    wildcards: sample=Ecoli_27
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Ecoli_27.log
        fi
        
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpajevykhe.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:25:23 2023]
Finished job 234.
98 of 759 steps (13%) done
Select jobs to execute...

[Thu Nov 23 10:25:23 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_27-sr/Ecoli_27_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Ecoli_27.log
    jobid: 748
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_27-sr/Ecoli_27_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/flye.log
    wildcards: sample=Ecoli_27
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_27-sr/Ecoli_27-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_27-sr/Ecoli_27-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/Ecoli_27_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/Ecoli_27_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_27-sr/Ecoli_27_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_27-sr/Ecoli_27.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_27-sr/Ecoli_27_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_27-sr/Ecoli_27.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/Ecoli_27_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_27-sr/Ecoli_27_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_27-sr/Ecoli_27-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_27-sr/Ecoli_27_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_27-sr/Ecoli_27-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_27-sr/Ecoli_27_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_27-sr/Ecoli_27-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_27-sr/Ecoli_27_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/Ecoli_27_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_27-sr/Ecoli_27_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_27-sr/Ecoli_27-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_27-sr/Ecoli_27_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_27-sr/Ecoli_27-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_27-sr/Ecoli_27_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_27-sr/Ecoli_27-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_27-sr/Ecoli_27_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/Ecoli_27_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_27-sr/Ecoli_27_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/Ecoli_27_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_27-sr/Ecoli_27_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/Ecoli_27_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_27-sr/Ecoli_27_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_27-sr/Ecoli_27_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_27-sr/Ecoli_27_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_27-sr/Ecoli_27_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_27-sr/Ecoli_27_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_27-sr/Ecoli_27_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_27-sr/Ecoli_27_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/Ecoli_27_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_27-sr/Ecoli_27_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_27-sr/Ecoli_27_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Ecoli_27" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_27-sr/Ecoli_27_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_27-sr/Ecoli_27_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Ecoli_27" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_27-sr/Ecoli_27_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_27-sr/Ecoli_27_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Ecoli_27" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_27-sr/Ecoli_27_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_27-sr/Ecoli_27_summary.txt
        fi
        
[Thu Nov 23 10:25:23 2023]
Finished job 748.
99 of 759 steps (13%) done
Select jobs to execute...
[Thu Nov 23 10:25:32 2023]
Finished job 191.
100 of 759 steps (13%) done

[Thu Nov 23 10:25:32 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_12-assembly-stats_flye.csv
    jobid: 349
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_12-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/checkv/quality_summary.tsv
    wildcards: sample=Bf_12
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpcasgxttg.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:25:33 2023]
Finished job 349.
101 of 759 steps (13%) done
Select jobs to execute...

[Thu Nov 23 10:25:33 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_12-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_12-sr/Bf_12-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Bf_12.log
    jobid: 444
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_12-sr/Bf_12-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_12-assembly-stats_flye.csv
    wildcards: sample=Bf_12
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp9dvpa8cb.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:25:34 2023]
Finished job 307.
102 of 759 steps (13%) done
Select jobs to execute...
[Thu Nov 23 10:25:35 2023]
Finished job 444.
103 of 759 steps (14%) done

[Thu Nov 23 10:25:35 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_12-sr/Bf_12-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_12-sr/Bf_12.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Bf_12.log
    jobid: 443
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_12-sr/Bf_12.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_12-sr/Bf_12-genome-candidates.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/assembly.fasta
    wildcards: sample=Bf_12
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_12-sr/Bf_12-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_12-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_12-sr/Bf_12.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_12-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_12-sr/Bf_12.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:25:35 2023]
Finished job 443.
104 of 759 steps (14%) done
Select jobs to execute...

[Thu Nov 23 10:25:35 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_12-sr/Bf_12.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_12-sr/Bf_12_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_12-sr/Bf_12_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Bf_12.log
    jobid: 570
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_12-sr/Bf_12_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_12-sr/Bf_12.fasta
    wildcards: sample=Bf_12
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp_61o_9mw.rename_genomes.py
[Thu Nov 23 10:25:35 2023]
Finished job 570.
105 of 759 steps (14%) done
Select jobs to execute...

[Thu Nov 23 10:25:35 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_12-sr/Bf_12_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/Bf_12.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/Bf_12_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/Bf_12_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/Bf_12_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/Bf_12_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/Bf_12_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_12.log
    jobid: 569
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/Bf_12_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/Bf_12_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/Bf_12_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/Bf_12_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/Bf_12_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/Bf_12.gbk; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_12-sr/Bf_12_genome.fasta
    wildcards: sample=Bf_12
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_12-sr/Bf_12_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_12-sr/Bf_12_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bf_12                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_12.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/Bf_12_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_12-sr/Bf_12_genome.fasta -n Bf_12_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr -p Bf_12 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:25:36 2023]
Error in rule pharokka_flye:
    jobid: 569
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_12-sr/Bf_12_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/Bf_12.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/Bf_12_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/Bf_12_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/Bf_12_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/Bf_12_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/Bf_12_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_12.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_12-sr/Bf_12_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_12-sr/Bf_12_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bf_12                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_12.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr/Bf_12_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_12-sr/Bf_12_genome.fasta -n Bf_12_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_12-sr -p Bf_12 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_12.log not found.

Select jobs to execute...
[Thu Nov 23 10:25:46 2023]
Finished job 118.
106 of 759 steps (14%) done

[Thu Nov 23 10:25:46 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_12_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bf_12.log
    jobid: 97
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Bf_12.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_12_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/assembly.fasta
    wildcards: sample=Bf_12
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_12_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bf_12.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_12-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:26:05 2023]
Finished job 233.
107 of 759 steps (14%) done
Select jobs to execute...

[Thu Nov 23 10:26:05 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_24_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bu_24.log
    jobid: 6
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Bu_24.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/flye.log; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_24_S.subsampled.fastq.gz
    wildcards: sample=Bu_24
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_24_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bu_24.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:27:27 2023]
Finished job 6.
108 of 759 steps (14%) done
Select jobs to execute...

[Thu Nov 23 10:27:27 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_24-sr/Bu_24_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Bu_24.log
    jobid: 699
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_24-sr/Bu_24_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/flye.log
    wildcards: sample=Bu_24
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_24-sr/Bu_24-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_24-sr/Bu_24-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/Bu_24_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/Bu_24_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_24-sr/Bu_24_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_24-sr/Bu_24.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_24-sr/Bu_24_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_24-sr/Bu_24.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/Bu_24_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_24-sr/Bu_24_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_24-sr/Bu_24-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_24-sr/Bu_24_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_24-sr/Bu_24-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_24-sr/Bu_24_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_24-sr/Bu_24-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_24-sr/Bu_24_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/Bu_24_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_24-sr/Bu_24_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_24-sr/Bu_24-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_24-sr/Bu_24_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_24-sr/Bu_24-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_24-sr/Bu_24_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_24-sr/Bu_24-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_24-sr/Bu_24_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/Bu_24_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_24-sr/Bu_24_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/Bu_24_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_24-sr/Bu_24_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/Bu_24_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_24-sr/Bu_24_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_24-sr/Bu_24_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_24-sr/Bu_24_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_24-sr/Bu_24_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_24-sr/Bu_24_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_24-sr/Bu_24_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_24-sr/Bu_24_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/Bu_24_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_24-sr/Bu_24_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_24-sr/Bu_24_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Bu_24" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_24-sr/Bu_24_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_24-sr/Bu_24_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Bu_24" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_24-sr/Bu_24_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_24-sr/Bu_24_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Bu_24" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_24-sr/Bu_24_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_24-sr/Bu_24_summary.txt
        fi
        

[Thu Nov 23 10:27:27 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bu_24.log
    jobid: 258
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Bu_24.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/assembly.fasta
    wildcards: sample=Bu_24
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bu_24.log
        fi
        
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_

[Thu Nov 23 10:27:27 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Bu_24.log
    jobid: 136
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Bu_24.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/assembly.fasta
    wildcards: sample=Bu_24
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:27:27 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bu_24.log
    jobid: 135
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Bu_24.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/assembly.fasta
    wildcards: sample=Bu_24
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bu_24.log
        fi
        

[Thu Nov 23 10:27:28 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_27-assembly-stats_flye.csv
    jobid: 370
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_27-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/checkv/quality_summary.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/assembly_result_table.csv
    wildcards: sample=Ecoli_27
    resources: tmpdir=/local/nala0006/2279907
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:27:28 2023]
Finished job 699.
109 of 759 steps (14%) done
Select jobs to execute...
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpb2bds6fk.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmprb3lkv1l.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:27:29 2023]
Finished job 97.
110 of 759 steps (14%) done

[Thu Nov 23 10:27:29 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_24_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_24.log
    jobid: 69
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Bu_24.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_24_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/assembly.fasta
    wildcards: sample=Bu_24
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_24_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_24.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:27:29 2023]
Finished job 136.
111 of 759 steps (15%) done
Select jobs to execute...
[Thu Nov 23 10:27:29 2023]
Finished job 370.
112 of 759 steps (15%) done

[Thu Nov 23 10:27:29 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_27-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_27-sr/Ecoli_27-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Ecoli_27.log
    jobid: 486
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_27-sr/Ecoli_27-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_27-assembly-stats_flye.csv
    wildcards: sample=Ecoli_27
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp4iovuxnp.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:27:30 2023]
Finished job 486.
113 of 759 steps (15%) done
Select jobs to execute...

[Thu Nov 23 10:27:30 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_27-sr/Ecoli_27-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_27-sr/Ecoli_27.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Ecoli_27.log
    jobid: 485
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_27-sr/Ecoli_27.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_27-sr/Ecoli_27-genome-candidates.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/assembly.fasta
    wildcards: sample=Ecoli_27
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_27-sr/Ecoli_27-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_27-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_27-sr/Ecoli_27.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_27-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_27-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_27-sr/Ecoli_27.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:27:30 2023]
Finished job 485.
114 of 759 steps (15%) done
Select jobs to execute...

[Thu Nov 23 10:27:30 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_27-sr/Ecoli_27.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_27-sr/Ecoli_27_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_27-sr/Ecoli_27_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Ecoli_27.log
    jobid: 612
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_27-sr/Ecoli_27_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_27-sr/Ecoli_27.fasta
    wildcards: sample=Ecoli_27
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp1yqm54p9.rename_genomes.py
[Thu Nov 23 10:27:31 2023]
Finished job 612.
115 of 759 steps (15%) done
Select jobs to execute...

[Thu Nov 23 10:27:31 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_27-sr/Ecoli_27_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/Ecoli_27.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/Ecoli_27_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/Ecoli_27_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/Ecoli_27_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/Ecoli_27_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/Ecoli_27_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_27.log
    jobid: 611
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/Ecoli_27_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/Ecoli_27.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/Ecoli_27_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/Ecoli_27_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/Ecoli_27_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/Ecoli_27_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/top_hits_vfdb.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_27-sr/Ecoli_27_genome.fasta
    wildcards: sample=Ecoli_27
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_27-sr/Ecoli_27_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_27-sr/Ecoli_27_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Ecoli_27                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_27.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/Ecoli_27_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_27-sr/Ecoli_27_genome.fasta -n Ecoli_27_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr -p Ecoli_27 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:27:31 2023]
Error in rule pharokka_flye:
    jobid: 611
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_27-sr/Ecoli_27_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/Ecoli_27.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/Ecoli_27_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/Ecoli_27_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/Ecoli_27_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/Ecoli_27_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/Ecoli_27_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_27.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_27-sr/Ecoli_27_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_27-sr/Ecoli_27_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Ecoli_27                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_27.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr/Ecoli_27_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_27-sr/Ecoli_27_genome.fasta -n Ecoli_27_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_27-sr -p Ecoli_27 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_27.log not found.

Select jobs to execute...
[Thu Nov 23 10:27:39 2023]
Finished job 258.
116 of 759 steps (15%) done
[Thu Nov 23 10:27:44 2023]
Finished job 69.
117 of 759 steps (15%) done

[Thu Nov 23 10:27:44 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_3_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Eu_3.log
    jobid: 16
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Eu_3.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/flye.log; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_3_S.subsampled.fastq.gz
    wildcards: sample=Eu_3
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_3_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Eu_3.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:27:56 2023]
Finished job 16.
118 of 759 steps (16%) done
Select jobs to execute...

[Thu Nov 23 10:27:56 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Eu_3.log
    jobid: 156
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Eu_3.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/assembly_info.txt
    wildcards: sample=Eu_3
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:27:56 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Eu_3.log
    jobid: 268
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Eu_3.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/assembly.fasta
    wildcards: sample=Eu_3
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Eu_3.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_

[Thu Nov 23 10:27:56 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_3_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Eu_3.log
    jobid: 79
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Eu_3.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_3_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/assembly.fasta
    wildcards: sample=Eu_3
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_3_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Eu_3.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_

[Thu Nov 23 10:27:56 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Eu_3.log
    jobid: 155
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Eu_3.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/assembly.fasta
    wildcards: sample=Eu_3
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Eu_3.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpd4rud32n.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:27:57 2023]
Finished job 156.
119 of 759 steps (16%) done
Select jobs to execute...

[Thu Nov 23 10:27:57 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_3-sr/Eu_3_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Eu_3.log
    jobid: 709
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_3-sr/Eu_3_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/flye.log
    wildcards: sample=Eu_3
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_3-sr/Eu_3-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_3-sr/Eu_3-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/Eu_3_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/Eu_3_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_3-sr/Eu_3_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_3-sr/Eu_3.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_3-sr/Eu_3_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_3-sr/Eu_3.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/Eu_3_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_3-sr/Eu_3_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_3-sr/Eu_3-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_3-sr/Eu_3_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_3-sr/Eu_3-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_3-sr/Eu_3_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_3-sr/Eu_3-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_3-sr/Eu_3_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/Eu_3_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_3-sr/Eu_3_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_3-sr/Eu_3-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_3-sr/Eu_3_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_3-sr/Eu_3-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_3-sr/Eu_3_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_3-sr/Eu_3-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_3-sr/Eu_3_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/Eu_3_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_3-sr/Eu_3_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/Eu_3_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_3-sr/Eu_3_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/Eu_3_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_3-sr/Eu_3_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_3-sr/Eu_3_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_3-sr/Eu_3_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_3-sr/Eu_3_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_3-sr/Eu_3_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_3-sr/Eu_3_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_3-sr/Eu_3_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/Eu_3_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_3-sr/Eu_3_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_3-sr/Eu_3_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Eu_3" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_3-sr/Eu_3_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_3-sr/Eu_3_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Eu_3" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_3-sr/Eu_3_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_3-sr/Eu_3_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Eu_3" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_3-sr/Eu_3_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_3-sr/Eu_3_summary.txt
        fi
        
[Thu Nov 23 10:27:58 2023]
Finished job 709.
120 of 759 steps (16%) done
Select jobs to execute...
[Thu Nov 23 10:28:07 2023]
Finished job 135.
121 of 759 steps (16%) done

[Thu Nov 23 10:28:07 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bu_24-assembly-stats_flye.csv
    jobid: 321
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bu_24-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/checkv/quality_summary.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/graph_seq_details_flye.tsv
    wildcards: sample=Bu_24
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp1q7iba6x.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:28:08 2023]
Finished job 321.
122 of 759 steps (16%) done
Select jobs to execute...

[Thu Nov 23 10:28:08 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bu_24-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_24-sr/Bu_24-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Bu_24.log
    jobid: 388
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_24-sr/Bu_24-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bu_24-assembly-stats_flye.csv
    wildcards: sample=Bu_24
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpr8pcomqe.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:28:10 2023]
Finished job 388.
123 of 759 steps (16%) done
Select jobs to execute...

[Thu Nov 23 10:28:10 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_24-sr/Bu_24-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_24-sr/Bu_24.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Bu_24.log
    jobid: 387
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_24-sr/Bu_24.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_24-sr/Bu_24-genome-candidates.csv
    wildcards: sample=Bu_24
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_24-sr/Bu_24-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_24-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_24-sr/Bu_24.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_24-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_24-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_24-sr/Bu_24.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:28:10 2023]
Finished job 387.
124 of 759 steps (16%) done
Select jobs to execute...

[Thu Nov 23 10:28:10 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_24-sr/Bu_24.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_24-sr/Bu_24_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_24-sr/Bu_24_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Bu_24.log
    jobid: 514
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_24-sr/Bu_24_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_24-sr/Bu_24.fasta
    wildcards: sample=Bu_24
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpre9rsd7u.rename_genomes.py
[Thu Nov 23 10:28:10 2023]
Finished job 514.
125 of 759 steps (16%) done
Select jobs to execute...

[Thu Nov 23 10:28:10 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_24-sr/Bu_24_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/Bu_24.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/Bu_24_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/Bu_24_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/Bu_24_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/Bu_24_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/Bu_24_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_24.log
    jobid: 513
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/Bu_24_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/Bu_24_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/Bu_24_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/Bu_24_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/Bu_24_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/Bu_24.gbk; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_24-sr/Bu_24_genome.fasta
    wildcards: sample=Bu_24
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_24-sr/Bu_24_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_24-sr/Bu_24_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bu_24                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_24.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/Bu_24_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_24-sr/Bu_24_genome.fasta -n Bu_24_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr -p Bu_24 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:28:11 2023]
Error in rule pharokka_flye:
    jobid: 513
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_24-sr/Bu_24_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/Bu_24.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/Bu_24_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/Bu_24_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/Bu_24_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/Bu_24_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/Bu_24_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_24.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_24-sr/Bu_24_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_24-sr/Bu_24_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bu_24                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_24.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr/Bu_24_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_24-sr/Bu_24_genome.fasta -n Bu_24_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_24-sr -p Bu_24 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_24.log not found.

Select jobs to execute...
[Thu Nov 23 10:28:11 2023]
Finished job 268.
126 of 759 steps (17%) done
[Thu Nov 23 10:28:14 2023]
Finished job 79.
127 of 759 steps (17%) done

[Thu Nov 23 10:28:14 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_19_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bb_19.log
    jobid: 65
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Bb_19.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/assembly_info.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_19_S.subsampled.fastq.gz
    wildcards: sample=Bb_19
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_19_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bb_19.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:28:31 2023]
Finished job 65.
128 of 759 steps (17%) done
Select jobs to execute...

[Thu Nov 23 10:28:31 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_19_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bb_19.log
    jobid: 128
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Bb_19.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_19_S.subsampled.fastq.gz
    wildcards: sample=Bb_19
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_19_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bb_19.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_

[Thu Nov 23 10:28:31 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bb_19.log
    jobid: 317
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Bb_19.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/assembly.fasta
    wildcards: sample=Bb_19
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bb_19.log
        fi
        
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_

[Thu Nov 23 10:28:31 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bb_19.log
    jobid: 253
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Bb_19.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/assembly.fasta
    wildcards: sample=Bb_19
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bb_19.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_

[Thu Nov 23 10:28:31 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Bb_19.log
    jobid: 254
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Bb_19.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/assembly_info.txt
    wildcards: sample=Bb_19
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpwuhrgqut.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:28:32 2023]
Finished job 254.
129 of 759 steps (17%) done
Select jobs to execute...

[Thu Nov 23 10:28:32 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_19-sr/Bb_19_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Bb_19.log
    jobid: 758
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_19-sr/Bb_19_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/flye.log
    wildcards: sample=Bb_19
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_19-sr/Bb_19-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_19-sr/Bb_19-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/Bb_19_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/Bb_19_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_19-sr/Bb_19_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_19-sr/Bb_19.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_19-sr/Bb_19_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_19-sr/Bb_19.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/Bb_19_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_19-sr/Bb_19_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_19-sr/Bb_19-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_19-sr/Bb_19_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_19-sr/Bb_19-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_19-sr/Bb_19_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_19-sr/Bb_19-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_19-sr/Bb_19_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/Bb_19_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_19-sr/Bb_19_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_19-sr/Bb_19-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_19-sr/Bb_19_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_19-sr/Bb_19-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_19-sr/Bb_19_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_19-sr/Bb_19-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_19-sr/Bb_19_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/Bb_19_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_19-sr/Bb_19_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/Bb_19_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_19-sr/Bb_19_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/Bb_19_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_19-sr/Bb_19_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_19-sr/Bb_19_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_19-sr/Bb_19_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_19-sr/Bb_19_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_19-sr/Bb_19_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_19-sr/Bb_19_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_19-sr/Bb_19_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/Bb_19_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_19-sr/Bb_19_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_19-sr/Bb_19_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Bb_19" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_19-sr/Bb_19_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_19-sr/Bb_19_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Bb_19" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_19-sr/Bb_19_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_19-sr/Bb_19_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Bb_19" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_19-sr/Bb_19_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_19-sr/Bb_19_summary.txt
        fi
        
[Thu Nov 23 10:28:32 2023]
Finished job 758.
130 of 759 steps (17%) done
Select jobs to execute...
[Thu Nov 23 10:28:52 2023]
Finished job 317.
131 of 759 steps (17%) done
[Thu Nov 23 10:28:53 2023]
Finished job 128.
132 of 759 steps (17%) done

[Thu Nov 23 10:28:53 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_15_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bf_15.log
    jobid: 43
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Bf_15.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/assembly.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_15_S.subsampled.fastq.gz
    wildcards: sample=Bf_15
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_15_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bf_15.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:29:02 2023]
Finished job 155.
133 of 759 steps (18%) done
Select jobs to execute...

[Thu Nov 23 10:29:02 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Eu_3-assembly-stats_flye.csv
    jobid: 331
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Eu_3-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/checkv/quality_summary.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/assembly_result_table.csv
    wildcards: sample=Eu_3
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp6bmm6h1d.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:29:03 2023]
Finished job 331.
134 of 759 steps (18%) done
Select jobs to execute...

[Thu Nov 23 10:29:03 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Eu_3-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_3-sr/Eu_3-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Eu_3.log
    jobid: 408
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_3-sr/Eu_3-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Eu_3-assembly-stats_flye.csv
    wildcards: sample=Eu_3
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpiys9l0hf.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:29:05 2023]
Finished job 408.
135 of 759 steps (18%) done
Select jobs to execute...

[Thu Nov 23 10:29:05 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_3-sr/Eu_3-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_3-sr/Eu_3.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Eu_3.log
    jobid: 407
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_3-sr/Eu_3.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_3-sr/Eu_3-genome-candidates.csv
    wildcards: sample=Eu_3
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_3-sr/Eu_3-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_3-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_3-sr/Eu_3.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_3-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_3-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_3-sr/Eu_3.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:29:05 2023]
Finished job 407.
136 of 759 steps (18%) done
Select jobs to execute...

[Thu Nov 23 10:29:05 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_3-sr/Eu_3.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_3-sr/Eu_3_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_3-sr/Eu_3_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Eu_3.log
    jobid: 534
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_3-sr/Eu_3_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_3-sr/Eu_3.fasta
    wildcards: sample=Eu_3
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp_isazn58.rename_genomes.py
[Thu Nov 23 10:29:05 2023]
Finished job 534.
137 of 759 steps (18%) done
Select jobs to execute...

[Thu Nov 23 10:29:05 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_3-sr/Eu_3_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/Eu_3.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/Eu_3_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/Eu_3_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/Eu_3_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/Eu_3_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/Eu_3_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Eu_3.log
    jobid: 533
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/Eu_3_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/Eu_3_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/Eu_3_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/Eu_3_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/Eu_3_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/Eu_3.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/top_hits_card.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_3-sr/Eu_3_genome.fasta
    wildcards: sample=Eu_3
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_3-sr/Eu_3_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_3-sr/Eu_3_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Eu_3                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Eu_3.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/Eu_3_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_3-sr/Eu_3_genome.fasta -n Eu_3_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr -p Eu_3 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:29:06 2023]
Error in rule pharokka_flye:
    jobid: 533
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_3-sr/Eu_3_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/Eu_3.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/Eu_3_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/Eu_3_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/Eu_3_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/Eu_3_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/Eu_3_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Eu_3.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_3-sr/Eu_3_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_3-sr/Eu_3_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Eu_3                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Eu_3.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr/Eu_3_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_3-sr/Eu_3_genome.fasta -n Eu_3_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_3-sr -p Eu_3 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Eu_3.log not found.

Select jobs to execute...
[Thu Nov 23 10:29:34 2023]
Finished job 43.
138 of 759 steps (18%) done

[Thu Nov 23 10:29:34 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_15_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bf_15.log
    jobid: 106
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Bf_15.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_15_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/assembly.fasta
    wildcards: sample=Bf_15
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_15_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bf_15.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_

[Thu Nov 23 10:29:34 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bf_15.log
    jobid: 209
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Bf_15.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/assembly.fasta
    wildcards: sample=Bf_15
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bf_15.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_

[Thu Nov 23 10:29:34 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Bf_15.log
    jobid: 210
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Bf_15.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/assembly.fasta
    wildcards: sample=Bf_15
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:29:34 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bf_15.log
    jobid: 295
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Bf_15.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/assembly.fasta
    wildcards: sample=Bf_15
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bf_15.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpmiw8626c.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:29:35 2023]
Finished job 210.
139 of 759 steps (18%) done
Select jobs to execute...

[Thu Nov 23 10:29:35 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_15-sr/Bf_15_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Bf_15.log
    jobid: 736
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_15-sr/Bf_15_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/flye.log
    wildcards: sample=Bf_15
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_15-sr/Bf_15-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_15-sr/Bf_15-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/Bf_15_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/Bf_15_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_15-sr/Bf_15_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_15-sr/Bf_15.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_15-sr/Bf_15_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_15-sr/Bf_15.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/Bf_15_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_15-sr/Bf_15_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_15-sr/Bf_15-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_15-sr/Bf_15_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_15-sr/Bf_15-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_15-sr/Bf_15_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_15-sr/Bf_15-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_15-sr/Bf_15_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/Bf_15_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_15-sr/Bf_15_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_15-sr/Bf_15-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_15-sr/Bf_15_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_15-sr/Bf_15-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_15-sr/Bf_15_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_15-sr/Bf_15-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_15-sr/Bf_15_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/Bf_15_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_15-sr/Bf_15_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/Bf_15_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_15-sr/Bf_15_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/Bf_15_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_15-sr/Bf_15_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_15-sr/Bf_15_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_15-sr/Bf_15_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_15-sr/Bf_15_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_15-sr/Bf_15_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_15-sr/Bf_15_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_15-sr/Bf_15_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/Bf_15_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_15-sr/Bf_15_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_15-sr/Bf_15_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Bf_15" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_15-sr/Bf_15_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_15-sr/Bf_15_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Bf_15" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_15-sr/Bf_15_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_15-sr/Bf_15_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Bf_15" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_15-sr/Bf_15_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_15-sr/Bf_15_summary.txt
        fi
        
[Thu Nov 23 10:29:35 2023]
Finished job 736.
140 of 759 steps (18%) done
Select jobs to execute...
[Thu Nov 23 10:29:47 2023]
Finished job 295.
141 of 759 steps (19%) done
[Thu Nov 23 10:29:57 2023]
Finished job 253.
142 of 759 steps (19%) done

[Thu Nov 23 10:29:57 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bb_19-assembly-stats_flye.csv
    jobid: 380
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bb_19-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/checkv/quality_summary.tsv
    wildcards: sample=Bb_19
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpk1uo6sr1.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:29:58 2023]
Finished job 380.
143 of 759 steps (19%) done
Select jobs to execute...

[Thu Nov 23 10:29:58 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bb_19-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_19-sr/Bb_19-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Bb_19.log
    jobid: 506
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_19-sr/Bb_19-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bb_19-assembly-stats_flye.csv
    wildcards: sample=Bb_19
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpzjridk53.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:29:59 2023]
Finished job 506.
144 of 759 steps (19%) done
Select jobs to execute...

[Thu Nov 23 10:29:59 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_19-sr/Bb_19-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_19-sr/Bb_19.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Bb_19.log
    jobid: 505
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_19-sr/Bb_19.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_19-sr/Bb_19-genome-candidates.csv
    wildcards: sample=Bb_19
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_19-sr/Bb_19-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_19-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_19-sr/Bb_19.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_19-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_19-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_19-sr/Bb_19.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:29:59 2023]
Finished job 505.
145 of 759 steps (19%) done
Select jobs to execute...

[Thu Nov 23 10:29:59 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_19-sr/Bb_19.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_19-sr/Bb_19_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_19-sr/Bb_19_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Bb_19.log
    jobid: 632
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_19-sr/Bb_19_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_19-sr/Bb_19.fasta
    wildcards: sample=Bb_19
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpbjja_7mw.rename_genomes.py
[Thu Nov 23 10:30:00 2023]
Finished job 632.
146 of 759 steps (19%) done
Select jobs to execute...

[Thu Nov 23 10:30:00 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_19-sr/Bb_19_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/Bb_19.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/Bb_19_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/Bb_19_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/Bb_19_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/Bb_19_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/Bb_19_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bb_19.log
    jobid: 631
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/Bb_19_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/Bb_19.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/Bb_19_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/Bb_19_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/Bb_19_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/Bb_19_minced_spacers.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_19-sr/Bb_19_genome.fasta
    wildcards: sample=Bb_19
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_19-sr/Bb_19_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_19-sr/Bb_19_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bb_19                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bb_19.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/Bb_19_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_19-sr/Bb_19_genome.fasta -n Bb_19_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr -p Bb_19 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:30:00 2023]
Error in rule pharokka_flye:
    jobid: 631
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_19-sr/Bb_19_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/Bb_19.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/Bb_19_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/Bb_19_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/Bb_19_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/Bb_19_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/Bb_19_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bb_19.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_19-sr/Bb_19_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_19-sr/Bb_19_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bb_19                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bb_19.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr/Bb_19_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_19-sr/Bb_19_genome.fasta -n Bb_19_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_19-sr -p Bb_19 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bb_19.log not found.

Select jobs to execute...
[Thu Nov 23 10:30:18 2023]
Finished job 209.
147 of 759 steps (19%) done

[Thu Nov 23 10:30:18 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_34_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Ecoli_34.log
    jobid: 52
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Ecoli_34.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/assembly.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_34_S.subsampled.fastq.gz
    wildcards: sample=Ecoli_34
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_34_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Ecoli_34.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:30:22 2023]
Finished job 106.
148 of 759 steps (19%) done
Select jobs to execute...

[Thu Nov 23 10:30:22 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_19_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bu_19.log
    jobid: 61
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Bu_19.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/flye.log; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_19_S.subsampled.fastq.gz
    wildcards: sample=Bu_19
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_19_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bu_19.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:30:33 2023]
Finished job 61.
149 of 759 steps (20%) done
Select jobs to execute...

[Thu Nov 23 10:30:33 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_19-sr/Bu_19_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Bu_19.log
    jobid: 754
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_19-sr/Bu_19_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/flye.log
    wildcards: sample=Bu_19
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_19-sr/Bu_19-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_19-sr/Bu_19-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/Bu_19_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/Bu_19_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_19-sr/Bu_19_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_19-sr/Bu_19.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_19-sr/Bu_19_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_19-sr/Bu_19.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/Bu_19_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_19-sr/Bu_19_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_19-sr/Bu_19-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_19-sr/Bu_19_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_19-sr/Bu_19-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_19-sr/Bu_19_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_19-sr/Bu_19-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_19-sr/Bu_19_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/Bu_19_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_19-sr/Bu_19_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_19-sr/Bu_19-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_19-sr/Bu_19_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_19-sr/Bu_19-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_19-sr/Bu_19_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_19-sr/Bu_19-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_19-sr/Bu_19_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/Bu_19_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_19-sr/Bu_19_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/Bu_19_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_19-sr/Bu_19_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/Bu_19_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_19-sr/Bu_19_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_19-sr/Bu_19_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_19-sr/Bu_19_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_19-sr/Bu_19_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_19-sr/Bu_19_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_19-sr/Bu_19_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_19-sr/Bu_19_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/Bu_19_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_19-sr/Bu_19_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_19-sr/Bu_19_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Bu_19" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_19-sr/Bu_19_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_19-sr/Bu_19_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Bu_19" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_19-sr/Bu_19_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_19-sr/Bu_19_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Bu_19" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_19-sr/Bu_19_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_19-sr/Bu_19_summary.txt
        fi
        

[Thu Nov 23 10:30:33 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Bu_19.log
    jobid: 246
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Bu_19.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/assembly.fasta
    wildcards: sample=Bu_19
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:30:33 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_15-assembly-stats_flye.csv
    jobid: 358
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_15-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/checkv/quality_summary.tsv
    wildcards: sample=Bf_15
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_

[Thu Nov 23 10:30:33 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bu_19.log
    jobid: 313
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Bu_19.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/assembly.fasta
    wildcards: sample=Bu_19
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bu_19.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_

[Thu Nov 23 10:30:33 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bu_19.log
    jobid: 245
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Bu_19.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/assembly.fasta
    wildcards: sample=Bu_19
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bu_19.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_
[Thu Nov 23 10:30:34 2023]
Finished job 754.
150 of 759 steps (20%) done
Select jobs to execute...
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpo7q5q6ia.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpbec31a0_.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:30:35 2023]
Finished job 246.
151 of 759 steps (20%) done
[Thu Nov 23 10:30:35 2023]
Finished job 358.
152 of 759 steps (20%) done

[Thu Nov 23 10:30:35 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_15-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_15-sr/Bf_15-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Bf_15.log
    jobid: 462
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_15-sr/Bf_15-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_15-assembly-stats_flye.csv
    wildcards: sample=Bf_15
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp5m2sx7vs.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:30:36 2023]
Finished job 462.
153 of 759 steps (20%) done
Select jobs to execute...

[Thu Nov 23 10:30:36 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_15-sr/Bf_15-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_15-sr/Bf_15.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Bf_15.log
    jobid: 461
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_15-sr/Bf_15.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_15-sr/Bf_15-genome-candidates.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/assembly.fasta
    wildcards: sample=Bf_15
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_15-sr/Bf_15-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_15-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_15-sr/Bf_15.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_15-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_15-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_15-sr/Bf_15.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:30:36 2023]
Finished job 461.
154 of 759 steps (20%) done
Select jobs to execute...

[Thu Nov 23 10:30:36 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_15-sr/Bf_15.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_15-sr/Bf_15_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_15-sr/Bf_15_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Bf_15.log
    jobid: 588
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_15-sr/Bf_15_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_15-sr/Bf_15.fasta
    wildcards: sample=Bf_15
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpjv_9tyg4.rename_genomes.py
[Thu Nov 23 10:30:37 2023]
Finished job 588.
155 of 759 steps (20%) done
Select jobs to execute...

[Thu Nov 23 10:30:37 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_15-sr/Bf_15_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/Bf_15.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/Bf_15_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/Bf_15_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/Bf_15_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/Bf_15_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/Bf_15_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_15.log
    jobid: 587
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/Bf_15.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/Bf_15_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/Bf_15_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/Bf_15_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/Bf_15_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/Bf_15_dnaapler_reoriented.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_15-sr/Bf_15_genome.fasta
    wildcards: sample=Bf_15
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_15-sr/Bf_15_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_15-sr/Bf_15_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bf_15                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_15.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/Bf_15_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_15-sr/Bf_15_genome.fasta -n Bf_15_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr -p Bf_15 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:30:37 2023]
Error in rule pharokka_flye:
    jobid: 587
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_15-sr/Bf_15_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/Bf_15.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/Bf_15_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/Bf_15_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/Bf_15_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/Bf_15_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/Bf_15_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_15.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_15-sr/Bf_15_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_15-sr/Bf_15_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bf_15                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_15.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr/Bf_15_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_15-sr/Bf_15_genome.fasta -n Bf_15_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_15-sr -p Bf_15 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_15.log not found.

Select jobs to execute...
[Thu Nov 23 10:30:48 2023]
Finished job 313.
156 of 759 steps (21%) done
[Thu Nov 23 10:31:32 2023]
Finished job 52.
157 of 759 steps (21%) done

[Thu Nov 23 10:31:32 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Ecoli_34.log
    jobid: 304
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Ecoli_34.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/assembly.fasta
    wildcards: sample=Ecoli_34
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Ecoli_34.log
        fi
        
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_

[Thu Nov 23 10:31:32 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Ecoli_34.log
    jobid: 227
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Ecoli_34.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/assembly.fasta
    wildcards: sample=Ecoli_34
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Ecoli_34.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_

[Thu Nov 23 10:31:32 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Ecoli_34.log
    jobid: 228
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Ecoli_34.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/assembly.fasta
    wildcards: sample=Ecoli_34
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:31:32 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_34_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ecoli_34.log
    jobid: 115
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Ecoli_34.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_34_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/assembly.fasta
    wildcards: sample=Ecoli_34
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_34_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ecoli_34.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/consensus.fasta
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpui0iqv2z.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:31:34 2023]
Finished job 228.
158 of 759 steps (21%) done
Select jobs to execute...

[Thu Nov 23 10:31:34 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_34-sr/Ecoli_34_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Ecoli_34.log
    jobid: 745
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_34-sr/Ecoli_34_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/flye.log
    wildcards: sample=Ecoli_34
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_34-sr/Ecoli_34-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_34-sr/Ecoli_34-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/Ecoli_34_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/Ecoli_34_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_34-sr/Ecoli_34_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_34-sr/Ecoli_34.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_34-sr/Ecoli_34_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_34-sr/Ecoli_34.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/Ecoli_34_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_34-sr/Ecoli_34_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_34-sr/Ecoli_34-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_34-sr/Ecoli_34_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_34-sr/Ecoli_34-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_34-sr/Ecoli_34_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_34-sr/Ecoli_34-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_34-sr/Ecoli_34_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/Ecoli_34_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_34-sr/Ecoli_34_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_34-sr/Ecoli_34-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_34-sr/Ecoli_34_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_34-sr/Ecoli_34-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_34-sr/Ecoli_34_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_34-sr/Ecoli_34-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_34-sr/Ecoli_34_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/Ecoli_34_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_34-sr/Ecoli_34_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/Ecoli_34_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_34-sr/Ecoli_34_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/Ecoli_34_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_34-sr/Ecoli_34_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_34-sr/Ecoli_34_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_34-sr/Ecoli_34_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_34-sr/Ecoli_34_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_34-sr/Ecoli_34_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_34-sr/Ecoli_34_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_34-sr/Ecoli_34_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/Ecoli_34_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_34-sr/Ecoli_34_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_34-sr/Ecoli_34_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Ecoli_34" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_34-sr/Ecoli_34_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_34-sr/Ecoli_34_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Ecoli_34" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_34-sr/Ecoli_34_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_34-sr/Ecoli_34_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Ecoli_34" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_34-sr/Ecoli_34_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_34-sr/Ecoli_34_summary.txt
        fi
        
[Thu Nov 23 10:31:34 2023]
Finished job 745.
159 of 759 steps (21%) done
Select jobs to execute...
[Thu Nov 23 10:31:35 2023]
Finished job 245.
160 of 759 steps (21%) done

[Thu Nov 23 10:31:35 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bu_19-assembly-stats_flye.csv
    jobid: 376
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bu_19-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/checkv/quality_summary.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/assembly_result_table.csv
    wildcards: sample=Bu_19
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpuvg9p9sy.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:31:36 2023]
Finished job 376.
161 of 759 steps (21%) done
Select jobs to execute...

[Thu Nov 23 10:31:36 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bu_19-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_19-sr/Bu_19-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Bu_19.log
    jobid: 498
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_19-sr/Bu_19-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bu_19-assembly-stats_flye.csv
    wildcards: sample=Bu_19
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmputl5wmu6.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:31:38 2023]
Finished job 498.
162 of 759 steps (21%) done
Select jobs to execute...

[Thu Nov 23 10:31:38 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_19-sr/Bu_19-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_19-sr/Bu_19.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Bu_19.log
    jobid: 497
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_19-sr/Bu_19.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_19-sr/Bu_19-genome-candidates.csv
    wildcards: sample=Bu_19
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_19-sr/Bu_19-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_19-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_19-sr/Bu_19.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_19-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_19-sr/Bu_19.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:31:38 2023]
Finished job 497.
163 of 759 steps (21%) done
Select jobs to execute...

[Thu Nov 23 10:31:38 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_19-sr/Bu_19.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_19-sr/Bu_19_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_19-sr/Bu_19_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Bu_19.log
    jobid: 624
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_19-sr/Bu_19_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_19-sr/Bu_19.fasta
    wildcards: sample=Bu_19
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp6wbnoaj4.rename_genomes.py
[Thu Nov 23 10:31:38 2023]
Finished job 624.
164 of 759 steps (22%) done
Select jobs to execute...

[Thu Nov 23 10:31:38 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_19-sr/Bu_19_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/Bu_19.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/Bu_19_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/Bu_19_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/Bu_19_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/Bu_19_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/Bu_19_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_19.log
    jobid: 623
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/Bu_19_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/Bu_19_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/Bu_19_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/Bu_19.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/Bu_19_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/Bu_19_minced_spacers.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_19-sr/Bu_19_genome.fasta
    wildcards: sample=Bu_19
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_19-sr/Bu_19_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_19-sr/Bu_19_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bu_19                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_19.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/Bu_19_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_19-sr/Bu_19_genome.fasta -n Bu_19_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr -p Bu_19 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:31:39 2023]
Error in rule pharokka_flye:
    jobid: 623
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_19-sr/Bu_19_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/Bu_19.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/Bu_19_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/Bu_19_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/Bu_19_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/Bu_19_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/Bu_19_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_19.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_19-sr/Bu_19_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_19-sr/Bu_19_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bu_19                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_19.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr/Bu_19_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_19-sr/Bu_19_genome.fasta -n Bu_19_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_19-sr -p Bu_19 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_19.log not found.

Select jobs to execute...
[Thu Nov 23 10:31:45 2023]
Finished job 304.
165 of 759 steps (22%) done
[Thu Nov 23 10:31:49 2023]
Finished job 115.
166 of 759 steps (22%) done

[Thu Nov 23 10:31:49 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_19_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_19.log
    jobid: 124
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Bu_19.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_19_S.subsampled.fastq.gz
    wildcards: sample=Bu_19
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_19_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_19.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_19-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:32:04 2023]
Finished job 124.
167 of 759 steps (22%) done
Select jobs to execute...

[Thu Nov 23 10:32:04 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_14_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bu_14.log
    jobid: 18
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Bu_14.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/assembly_graph.gfa; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_14_S.subsampled.fastq.gz
    wildcards: sample=Bu_14
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_14_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bu_14.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:32:16 2023]
Finished job 227.
168 of 759 steps (22%) done
Select jobs to execute...

[Thu Nov 23 10:32:16 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_04_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bf_04.log
    jobid: 54
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Bf_04.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/assembly_info.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_04_S.subsampled.fastq.gz
    wildcards: sample=Bf_04
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_04_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bf_04.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:33:21 2023]
Finished job 18.
169 of 759 steps (22%) done
Select jobs to execute...

[Thu Nov 23 10:33:21 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_14-sr/Bu_14_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Bu_14.log
    jobid: 711
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_14-sr/Bu_14_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/flye.log
    wildcards: sample=Bu_14
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_14-sr/Bu_14-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_14-sr/Bu_14-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/Bu_14_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/Bu_14_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_14-sr/Bu_14_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_14-sr/Bu_14.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_14-sr/Bu_14_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_14-sr/Bu_14.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/Bu_14_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_14-sr/Bu_14_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_14-sr/Bu_14-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_14-sr/Bu_14_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_14-sr/Bu_14-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_14-sr/Bu_14_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_14-sr/Bu_14-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_14-sr/Bu_14_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/Bu_14_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_14-sr/Bu_14_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_14-sr/Bu_14-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_14-sr/Bu_14_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_14-sr/Bu_14-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_14-sr/Bu_14_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_14-sr/Bu_14-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_14-sr/Bu_14_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/Bu_14_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_14-sr/Bu_14_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/Bu_14_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_14-sr/Bu_14_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/Bu_14_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_14-sr/Bu_14_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_14-sr/Bu_14_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_14-sr/Bu_14_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_14-sr/Bu_14_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_14-sr/Bu_14_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_14-sr/Bu_14_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_14-sr/Bu_14_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/Bu_14_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_14-sr/Bu_14_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_14-sr/Bu_14_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Bu_14" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_14-sr/Bu_14_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_14-sr/Bu_14_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Bu_14" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_14-sr/Bu_14_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_14-sr/Bu_14_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Bu_14" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_14-sr/Bu_14_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_14-sr/Bu_14_summary.txt
        fi
        

[Thu Nov 23 10:33:21 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bu_14.log
    jobid: 159
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Bu_14.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/assembly.fasta
    wildcards: sample=Bu_14
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bu_14.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_

[Thu Nov 23 10:33:21 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_34-assembly-stats_flye.csv
    jobid: 367
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_34-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/checkv/quality_summary.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/assembly_result_table.csv
    wildcards: sample=Ecoli_34
    resources: tmpdir=/local/nala0006/2279907

[Thu Nov 23 10:33:21 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bu_14.log
    jobid: 270
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Bu_14.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/assembly.fasta
    wildcards: sample=Bu_14
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bu_14.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_

[Thu Nov 23 10:33:21 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Bu_14.log
    jobid: 160
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Bu_14.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/assembly_graph.gfa
    wildcards: sample=Bu_14
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:33:21 2023]
Finished job 711.
170 of 759 steps (22%) done
Select jobs to execute...
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpgd99p7hw.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpq5kvtm98.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:33:22 2023]
Finished job 160.
171 of 759 steps (23%) done
[Thu Nov 23 10:33:22 2023]
Finished job 367.
172 of 759 steps (23%) done

[Thu Nov 23 10:33:22 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_34-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_34-sr/Ecoli_34-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Ecoli_34.log
    jobid: 480
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_34-sr/Ecoli_34-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_34-assembly-stats_flye.csv
    wildcards: sample=Ecoli_34
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmptbtap84e.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:33:24 2023]
Finished job 480.
173 of 759 steps (23%) done
Select jobs to execute...

[Thu Nov 23 10:33:24 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_34-sr/Ecoli_34-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_34-sr/Ecoli_34.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Ecoli_34.log
    jobid: 479
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_34-sr/Ecoli_34.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_34-sr/Ecoli_34-genome-candidates.csv
    wildcards: sample=Ecoli_34
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_34-sr/Ecoli_34-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_34-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_34-sr/Ecoli_34.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_34-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_34-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_34-sr/Ecoli_34.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:33:24 2023]
Finished job 479.
174 of 759 steps (23%) done
Select jobs to execute...

[Thu Nov 23 10:33:24 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_34-sr/Ecoli_34.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_34-sr/Ecoli_34_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_34-sr/Ecoli_34_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Ecoli_34.log
    jobid: 606
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_34-sr/Ecoli_34_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_34-sr/Ecoli_34.fasta
    wildcards: sample=Ecoli_34
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpasr1fgkn.rename_genomes.py
[Thu Nov 23 10:33:24 2023]
Finished job 606.
175 of 759 steps (23%) done
Select jobs to execute...

[Thu Nov 23 10:33:24 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_34-sr/Ecoli_34_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/Ecoli_34.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/Ecoli_34_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/Ecoli_34_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/Ecoli_34_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/Ecoli_34_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/Ecoli_34_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_34.log
    jobid: 605
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/Ecoli_34_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/Ecoli_34_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/Ecoli_34_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/Ecoli_34_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/Ecoli_34_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/Ecoli_34.gbk; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_34-sr/Ecoli_34_genome.fasta
    wildcards: sample=Ecoli_34
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_34-sr/Ecoli_34_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_34-sr/Ecoli_34_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Ecoli_34                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_34.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/Ecoli_34_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_34-sr/Ecoli_34_genome.fasta -n Ecoli_34_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr -p Ecoli_34 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:33:25 2023]
Error in rule pharokka_flye:
    jobid: 605
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_34-sr/Ecoli_34_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/Ecoli_34.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/Ecoli_34_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/Ecoli_34_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/Ecoli_34_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/Ecoli_34_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/Ecoli_34_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_34.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_34-sr/Ecoli_34_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_34-sr/Ecoli_34_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Ecoli_34                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_34.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr/Ecoli_34_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_34-sr/Ecoli_34_genome.fasta -n Ecoli_34_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_34-sr -p Ecoli_34 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_34.log not found.

Select jobs to execute...
[Thu Nov 23 10:33:34 2023]
Finished job 270.
176 of 759 steps (23%) done
[Thu Nov 23 10:33:48 2023]
Finished job 54.
177 of 759 steps (23%) done

[Thu Nov 23 10:33:48 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Bf_04.log
    jobid: 232
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Bf_04.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/assembly_info.txt
    wildcards: sample=Bf_04
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:33:48 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_14_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_14.log
    jobid: 81
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Bu_14.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_14_S.subsampled.fastq.gz
    wildcards: sample=Bu_14
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_14_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_14.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/consensus.fasta
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_

[Thu Nov 23 10:33:48 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bf_04.log
    jobid: 306
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Bf_04.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/assembly.fasta
    wildcards: sample=Bf_04
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bf_04.log
        fi
        
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_

[Thu Nov 23 10:33:48 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bf_04.log
    jobid: 231
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Bf_04.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/assembly.fasta
    wildcards: sample=Bf_04
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bf_04.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp09v3tuul.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:33:50 2023]
Finished job 232.
178 of 759 steps (23%) done
Select jobs to execute...

[Thu Nov 23 10:33:50 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_04-sr/Bf_04_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Bf_04.log
    jobid: 747
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_04-sr/Bf_04_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/flye.log
    wildcards: sample=Bf_04
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_04-sr/Bf_04-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_04-sr/Bf_04-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/Bf_04_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/Bf_04_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_04-sr/Bf_04_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_04-sr/Bf_04.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_04-sr/Bf_04_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_04-sr/Bf_04.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/Bf_04_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_04-sr/Bf_04_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_04-sr/Bf_04-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_04-sr/Bf_04_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_04-sr/Bf_04-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_04-sr/Bf_04_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_04-sr/Bf_04-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_04-sr/Bf_04_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/Bf_04_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_04-sr/Bf_04_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_04-sr/Bf_04-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_04-sr/Bf_04_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_04-sr/Bf_04-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_04-sr/Bf_04_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_04-sr/Bf_04-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_04-sr/Bf_04_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/Bf_04_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_04-sr/Bf_04_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/Bf_04_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_04-sr/Bf_04_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/Bf_04_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_04-sr/Bf_04_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_04-sr/Bf_04_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_04-sr/Bf_04_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_04-sr/Bf_04_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_04-sr/Bf_04_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_04-sr/Bf_04_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_04-sr/Bf_04_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/Bf_04_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_04-sr/Bf_04_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_04-sr/Bf_04_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Bf_04" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_04-sr/Bf_04_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_04-sr/Bf_04_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Bf_04" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_04-sr/Bf_04_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_04-sr/Bf_04_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Bf_04" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_04-sr/Bf_04_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_04-sr/Bf_04_summary.txt
        fi
        
[Thu Nov 23 10:33:50 2023]
Finished job 747.
179 of 759 steps (24%) done
Select jobs to execute...
[Thu Nov 23 10:34:00 2023]
Finished job 159.
180 of 759 steps (24%) done

[Thu Nov 23 10:34:00 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bu_14-assembly-stats_flye.csv
    jobid: 333
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bu_14-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/checkv/quality_summary.tsv
    wildcards: sample=Bu_14
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpyu9uic43.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:34:01 2023]
Finished job 333.
181 of 759 steps (24%) done
Select jobs to execute...

[Thu Nov 23 10:34:01 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bu_14-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_14-sr/Bu_14-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Bu_14.log
    jobid: 412
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_14-sr/Bu_14-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bu_14-assembly-stats_flye.csv
    wildcards: sample=Bu_14
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpzglole4r.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:34:03 2023]
Finished job 412.
182 of 759 steps (24%) done
Select jobs to execute...

[Thu Nov 23 10:34:03 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_14-sr/Bu_14-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_14-sr/Bu_14.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Bu_14.log
    jobid: 411
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_14-sr/Bu_14.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_14-sr/Bu_14-genome-candidates.csv
    wildcards: sample=Bu_14
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_14-sr/Bu_14-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_14-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_14-sr/Bu_14.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_14-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_14-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_14-sr/Bu_14.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:34:03 2023]
Finished job 81.
183 of 759 steps (24%) done
Select jobs to execute...

[Thu Nov 23 10:34:03 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_04_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bf_04.log
    jobid: 117
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Bf_04.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_04_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/assembly.fasta
    wildcards: sample=Bf_04
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_04_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bf_04.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:34:03 2023]
Finished job 306.
184 of 759 steps (24%) done
Select jobs to execute...
[Thu Nov 23 10:34:03 2023]
Finished job 411.
185 of 759 steps (24%) done

[Thu Nov 23 10:34:03 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_14-sr/Bu_14.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_14-sr/Bu_14_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_14-sr/Bu_14_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Bu_14.log
    jobid: 538
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_14-sr/Bu_14_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_14-sr/Bu_14.fasta
    wildcards: sample=Bu_14
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpmwh0dwzx.rename_genomes.py
[Thu Nov 23 10:34:03 2023]
Finished job 538.
186 of 759 steps (25%) done
Select jobs to execute...

[Thu Nov 23 10:34:03 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_14-sr/Bu_14_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/Bu_14.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/Bu_14_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/Bu_14_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/Bu_14_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/Bu_14_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/Bu_14_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_14.log
    jobid: 537
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/Bu_14_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/Bu_14.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/Bu_14_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/Bu_14_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/Bu_14_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/Bu_14_length_gc_cds_density.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_14-sr/Bu_14_genome.fasta
    wildcards: sample=Bu_14
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_14-sr/Bu_14_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_14-sr/Bu_14_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bu_14                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_14.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/Bu_14_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_14-sr/Bu_14_genome.fasta -n Bu_14_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr -p Bu_14 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:34:04 2023]
Error in rule pharokka_flye:
    jobid: 537
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_14-sr/Bu_14_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/Bu_14.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/Bu_14_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/Bu_14_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/Bu_14_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/Bu_14_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/Bu_14_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_14.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_14-sr/Bu_14_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_14-sr/Bu_14_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bu_14                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_14.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr/Bu_14_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_14-sr/Bu_14_genome.fasta -n Bu_14_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_14-sr -p Bu_14 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_14.log not found.

Select jobs to execute...
[Thu Nov 23 10:34:20 2023]
Finished job 117.
187 of 759 steps (25%) done

[Thu Nov 23 10:34:20 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_31_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Ecoli_31.log
    jobid: 37
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Ecoli_31.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/assembly.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_31_S.subsampled.fastq.gz
    wildcards: sample=Ecoli_31
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_31_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Ecoli_31.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:34:32 2023]
Finished job 231.
188 of 759 steps (25%) done
Select jobs to execute...

[Thu Nov 23 10:34:32 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_30_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bu_30.log
    jobid: 8
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Bu_30.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/flye.log; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_30_S.subsampled.fastq.gz
    wildcards: sample=Bu_30
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_30_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bu_30.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:34:41 2023]
Finished job 8.
189 of 759 steps (25%) done
Select jobs to execute...

[Thu Nov 23 10:34:41 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_30-sr/Bu_30_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Bu_30.log
    jobid: 701
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_30-sr/Bu_30_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/flye.log
    wildcards: sample=Bu_30
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_30-sr/Bu_30-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_30-sr/Bu_30-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/Bu_30_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/Bu_30_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_30-sr/Bu_30_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_30-sr/Bu_30.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_30-sr/Bu_30_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_30-sr/Bu_30.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/Bu_30_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_30-sr/Bu_30_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_30-sr/Bu_30-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_30-sr/Bu_30_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_30-sr/Bu_30-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_30-sr/Bu_30_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_30-sr/Bu_30-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_30-sr/Bu_30_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/Bu_30_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_30-sr/Bu_30_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_30-sr/Bu_30-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_30-sr/Bu_30_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_30-sr/Bu_30-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_30-sr/Bu_30_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_30-sr/Bu_30-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_30-sr/Bu_30_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/Bu_30_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_30-sr/Bu_30_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/Bu_30_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_30-sr/Bu_30_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/Bu_30_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_30-sr/Bu_30_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_30-sr/Bu_30_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_30-sr/Bu_30_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_30-sr/Bu_30_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_30-sr/Bu_30_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_30-sr/Bu_30_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_30-sr/Bu_30_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/Bu_30_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_30-sr/Bu_30_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_30-sr/Bu_30_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Bu_30" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_30-sr/Bu_30_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_30-sr/Bu_30_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Bu_30" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_30-sr/Bu_30_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_30-sr/Bu_30_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Bu_30" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_30-sr/Bu_30_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_30-sr/Bu_30_summary.txt
        fi
        

[Thu Nov 23 10:34:41 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bu_30.log
    jobid: 260
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Bu_30.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/assembly.fasta
    wildcards: sample=Bu_30
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bu_30.log
        fi
        
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_

[Thu Nov 23 10:34:41 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_04-assembly-stats_flye.csv
    jobid: 369
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_04-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/checkv/quality_summary.tsv
    wildcards: sample=Bf_04
    resources: tmpdir=/local/nala0006/2279907

[Thu Nov 23 10:34:41 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Bu_30.log
    jobid: 140
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Bu_30.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/assembly_graph.gfa
    wildcards: sample=Bu_30
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_

[Thu Nov 23 10:34:41 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bu_30.log
    jobid: 139
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Bu_30.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/assembly.fasta
    wildcards: sample=Bu_30
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bu_30.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_
[Thu Nov 23 10:34:41 2023]
Finished job 701.
190 of 759 steps (25%) done
Select jobs to execute...
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpbz7lpdu7.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmppicn0xvb.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:34:42 2023]
Finished job 140.
191 of 759 steps (25%) done
[Thu Nov 23 10:34:43 2023]
Finished job 369.
192 of 759 steps (25%) done

[Thu Nov 23 10:34:43 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_04-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_04-sr/Bf_04-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Bf_04.log
    jobid: 484
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_04-sr/Bf_04-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_04-assembly-stats_flye.csv
    wildcards: sample=Bf_04
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpwhjtajno.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:34:44 2023]
Finished job 484.
193 of 759 steps (25%) done
Select jobs to execute...

[Thu Nov 23 10:34:44 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_04-sr/Bf_04-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_04-sr/Bf_04.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Bf_04.log
    jobid: 483
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_04-sr/Bf_04.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_04-sr/Bf_04-genome-candidates.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/assembly.fasta
    wildcards: sample=Bf_04
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_04-sr/Bf_04-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_04-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_04-sr/Bf_04.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_04-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_04-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_04-sr/Bf_04.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:34:44 2023]
Finished job 483.
194 of 759 steps (26%) done
Select jobs to execute...

[Thu Nov 23 10:34:44 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_04-sr/Bf_04.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_04-sr/Bf_04_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_04-sr/Bf_04_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Bf_04.log
    jobid: 610
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_04-sr/Bf_04_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_04-sr/Bf_04.fasta
    wildcards: sample=Bf_04
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmplu_l9_x2.rename_genomes.py
[Thu Nov 23 10:34:44 2023]
Finished job 610.
195 of 759 steps (26%) done
Select jobs to execute...

[Thu Nov 23 10:34:44 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_04-sr/Bf_04_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/Bf_04.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/Bf_04_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/Bf_04_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/Bf_04_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/Bf_04_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/Bf_04_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_04.log
    jobid: 609
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/Bf_04_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/Bf_04_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/Bf_04_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/Bf_04_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/Bf_04.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/Bf_04_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/top_hits_card.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_04-sr/Bf_04_genome.fasta
    wildcards: sample=Bf_04
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_04-sr/Bf_04_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_04-sr/Bf_04_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bf_04                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_04.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/Bf_04_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_04-sr/Bf_04_genome.fasta -n Bf_04_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr -p Bf_04 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:34:45 2023]
Error in rule pharokka_flye:
    jobid: 609
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_04-sr/Bf_04_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/Bf_04.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/Bf_04_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/Bf_04_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/Bf_04_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/Bf_04_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/Bf_04_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_04.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_04-sr/Bf_04_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_04-sr/Bf_04_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bf_04                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_04.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr/Bf_04_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_04-sr/Bf_04_genome.fasta -n Bf_04_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_04-sr -p Bf_04 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_04.log not found.

Select jobs to execute...
[Thu Nov 23 10:34:57 2023]
Finished job 260.
196 of 759 steps (26%) done
[Thu Nov 23 10:35:23 2023]
Finished job 37.
197 of 759 steps (26%) done

[Thu Nov 23 10:35:23 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Ecoli_31.log
    jobid: 289
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Ecoli_31.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/assembly.fasta
    wildcards: sample=Ecoli_31
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Ecoli_31.log
        fi
        
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_

[Thu Nov 23 10:35:23 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_31_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ecoli_31.log
    jobid: 100
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Ecoli_31.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_31_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/assembly.fasta
    wildcards: sample=Ecoli_31
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_31_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ecoli_31.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_

[Thu Nov 23 10:35:23 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Ecoli_31.log
    jobid: 197
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Ecoli_31.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/assembly.fasta
    wildcards: sample=Ecoli_31
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Ecoli_31.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_

[Thu Nov 23 10:35:23 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Ecoli_31.log
    jobid: 198
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Ecoli_31.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/assembly.fasta
    wildcards: sample=Ecoli_31
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpxrg89rvi.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:35:24 2023]
Finished job 198.
198 of 759 steps (26%) done
Select jobs to execute...

[Thu Nov 23 10:35:24 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_31-sr/Ecoli_31_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Ecoli_31.log
    jobid: 730
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_31-sr/Ecoli_31_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/flye.log
    wildcards: sample=Ecoli_31
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_31-sr/Ecoli_31-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_31-sr/Ecoli_31-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/Ecoli_31_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/Ecoli_31_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_31-sr/Ecoli_31_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_31-sr/Ecoli_31.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_31-sr/Ecoli_31_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_31-sr/Ecoli_31.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/Ecoli_31_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_31-sr/Ecoli_31_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_31-sr/Ecoli_31-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_31-sr/Ecoli_31_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_31-sr/Ecoli_31-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_31-sr/Ecoli_31_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_31-sr/Ecoli_31-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_31-sr/Ecoli_31_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/Ecoli_31_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_31-sr/Ecoli_31_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_31-sr/Ecoli_31-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_31-sr/Ecoli_31_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_31-sr/Ecoli_31-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_31-sr/Ecoli_31_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_31-sr/Ecoli_31-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_31-sr/Ecoli_31_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/Ecoli_31_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_31-sr/Ecoli_31_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/Ecoli_31_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_31-sr/Ecoli_31_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/Ecoli_31_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_31-sr/Ecoli_31_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_31-sr/Ecoli_31_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_31-sr/Ecoli_31_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_31-sr/Ecoli_31_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_31-sr/Ecoli_31_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_31-sr/Ecoli_31_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_31-sr/Ecoli_31_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/Ecoli_31_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_31-sr/Ecoli_31_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_31-sr/Ecoli_31_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Ecoli_31" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_31-sr/Ecoli_31_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_31-sr/Ecoli_31_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Ecoli_31" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_31-sr/Ecoli_31_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_31-sr/Ecoli_31_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Ecoli_31" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_31-sr/Ecoli_31_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_31-sr/Ecoli_31_summary.txt
        fi
        
[Thu Nov 23 10:35:24 2023]
Finished job 730.
199 of 759 steps (26%) done
Select jobs to execute...
[Thu Nov 23 10:35:36 2023]
Finished job 289.
200 of 759 steps (26%) done
[Thu Nov 23 10:35:38 2023]
Finished job 100.
201 of 759 steps (26%) done

[Thu Nov 23 10:35:38 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_30_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_30.log
    jobid: 71
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Bu_30.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_30_S.subsampled.fastq.gz
    wildcards: sample=Bu_30
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_30_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_30.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:35:50 2023]
Finished job 139.
202 of 759 steps (27%) done
Select jobs to execute...

[Thu Nov 23 10:35:50 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bu_30-assembly-stats_flye.csv
    jobid: 323
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bu_30-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/checkv/quality_summary.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/graph_seq_details_flye.tsv
    wildcards: sample=Bu_30
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpmrutvnm5.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:35:51 2023]
Finished job 323.
203 of 759 steps (27%) done
Select jobs to execute...

[Thu Nov 23 10:35:51 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bu_30-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_30-sr/Bu_30-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Bu_30.log
    jobid: 392
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_30-sr/Bu_30-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bu_30-assembly-stats_flye.csv
    wildcards: sample=Bu_30
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp70n1ozfr.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:35:52 2023]
Finished job 392.
204 of 759 steps (27%) done
Select jobs to execute...

[Thu Nov 23 10:35:52 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_30-sr/Bu_30-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_30-sr/Bu_30.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Bu_30.log
    jobid: 391
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_30-sr/Bu_30.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_30-sr/Bu_30-genome-candidates.csv
    wildcards: sample=Bu_30
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_30-sr/Bu_30-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_30-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_30-sr/Bu_30.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_30-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_30-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_30-sr/Bu_30.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:35:53 2023]
Finished job 391.
205 of 759 steps (27%) done
Select jobs to execute...

[Thu Nov 23 10:35:53 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_30-sr/Bu_30.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_30-sr/Bu_30_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_30-sr/Bu_30_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Bu_30.log
    jobid: 518
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_30-sr/Bu_30_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_30-sr/Bu_30.fasta
    wildcards: sample=Bu_30
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpfca7uu8f.rename_genomes.py
[Thu Nov 23 10:35:53 2023]
Finished job 518.
206 of 759 steps (27%) done
Select jobs to execute...

[Thu Nov 23 10:35:53 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_30-sr/Bu_30_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/Bu_30.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/Bu_30_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/Bu_30_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/Bu_30_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/Bu_30_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/Bu_30_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_30.log
    jobid: 517
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/Bu_30_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/Bu_30_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/Bu_30_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/Bu_30_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/Bu_30.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/Bu_30_length_gc_cds_density.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_30-sr/Bu_30_genome.fasta
    wildcards: sample=Bu_30
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_30-sr/Bu_30_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_30-sr/Bu_30_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bu_30                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_30.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/Bu_30_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_30-sr/Bu_30_genome.fasta -n Bu_30_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr -p Bu_30 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:35:54 2023]
Error in rule pharokka_flye:
    jobid: 517
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_30-sr/Bu_30_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/Bu_30.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/Bu_30_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/Bu_30_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/Bu_30_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/Bu_30_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/Bu_30_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_30.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_30-sr/Bu_30_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_30-sr/Bu_30_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bu_30                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_30.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr/Bu_30_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_30-sr/Bu_30_genome.fasta -n Bu_30_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_30-sr -p Bu_30 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_30.log not found.

Select jobs to execute...
[Thu Nov 23 10:35:57 2023]
Finished job 71.
207 of 759 steps (27%) done

[Thu Nov 23 10:35:57 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_17_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Ecoli_17.log
    jobid: 28
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Ecoli_17.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/assembly_info.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_17_S.subsampled.fastq.gz
    wildcards: sample=Ecoli_17
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_17_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Ecoli_17.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:36:07 2023]
Finished job 197.
208 of 759 steps (27%) done
Select jobs to execute...

[Thu Nov 23 10:36:07 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_01_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bf_01.log
    jobid: 29
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Bf_01.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/flye.log; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_01_S.subsampled.fastq.gz
    wildcards: sample=Bf_01
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_01_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bf_01.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:36:39 2023]
Finished job 29.
209 of 759 steps (28%) done
Select jobs to execute...

[Thu Nov 23 10:36:39 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_01-sr/Bf_01_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Bf_01.log
    jobid: 722
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_01-sr/Bf_01_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/flye.log
    wildcards: sample=Bf_01
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_01-sr/Bf_01-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_01-sr/Bf_01-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/Bf_01_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/Bf_01_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_01-sr/Bf_01_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_01-sr/Bf_01.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_01-sr/Bf_01_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_01-sr/Bf_01.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/Bf_01_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_01-sr/Bf_01_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_01-sr/Bf_01-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_01-sr/Bf_01_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_01-sr/Bf_01-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_01-sr/Bf_01_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_01-sr/Bf_01-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_01-sr/Bf_01_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/Bf_01_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_01-sr/Bf_01_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_01-sr/Bf_01-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_01-sr/Bf_01_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_01-sr/Bf_01-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_01-sr/Bf_01_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_01-sr/Bf_01-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_01-sr/Bf_01_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/Bf_01_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_01-sr/Bf_01_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/Bf_01_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_01-sr/Bf_01_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/Bf_01_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_01-sr/Bf_01_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_01-sr/Bf_01_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_01-sr/Bf_01_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_01-sr/Bf_01_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_01-sr/Bf_01_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_01-sr/Bf_01_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_01-sr/Bf_01_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/Bf_01_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_01-sr/Bf_01_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_01-sr/Bf_01_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Bf_01" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_01-sr/Bf_01_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_01-sr/Bf_01_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Bf_01" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_01-sr/Bf_01_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_01-sr/Bf_01_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Bf_01" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_01-sr/Bf_01_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_01-sr/Bf_01_summary.txt
        fi
        

[Thu Nov 23 10:36:39 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bf_01.log
    jobid: 181
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Bf_01.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/assembly.fasta
    wildcards: sample=Bf_01
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bf_01.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_

[Thu Nov 23 10:36:39 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Bf_01.log
    jobid: 182
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Bf_01.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/assembly.fasta
    wildcards: sample=Bf_01
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:36:39 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_31-assembly-stats_flye.csv
    jobid: 352
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_31-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/checkv/quality_summary.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/graph_seq_details_flye.tsv
    wildcards: sample=Ecoli_31
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_

[Thu Nov 23 10:36:39 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bf_01.log
    jobid: 281
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Bf_01.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/assembly.fasta
    wildcards: sample=Bf_01
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bf_01.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_
[Thu Nov 23 10:36:39 2023]
Finished job 722.
210 of 759 steps (28%) done
Select jobs to execute...
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp14d085lj.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp228ks_bt.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:36:40 2023]
Finished job 182.
211 of 759 steps (28%) done
[Thu Nov 23 10:36:40 2023]
Finished job 352.
212 of 759 steps (28%) done

[Thu Nov 23 10:36:40 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_31-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_31-sr/Ecoli_31-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Ecoli_31.log
    jobid: 450
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_31-sr/Ecoli_31-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_31-assembly-stats_flye.csv
    wildcards: sample=Ecoli_31
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp3jrr7uw1.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:36:41 2023]
Finished job 450.
213 of 759 steps (28%) done
Select jobs to execute...

[Thu Nov 23 10:36:41 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_31-sr/Ecoli_31-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_31-sr/Ecoli_31.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Ecoli_31.log
    jobid: 449
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_31-sr/Ecoli_31.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_31-sr/Ecoli_31-genome-candidates.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/assembly.fasta
    wildcards: sample=Ecoli_31
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_31-sr/Ecoli_31-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_31-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_31-sr/Ecoli_31.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_31-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_31-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_31-sr/Ecoli_31.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:36:42 2023]
Finished job 449.
214 of 759 steps (28%) done
Select jobs to execute...

[Thu Nov 23 10:36:42 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_31-sr/Ecoli_31.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_31-sr/Ecoli_31_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_31-sr/Ecoli_31_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Ecoli_31.log
    jobid: 576
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_31-sr/Ecoli_31_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_31-sr/Ecoli_31.fasta
    wildcards: sample=Ecoli_31
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpbl9mbrmu.rename_genomes.py
[Thu Nov 23 10:36:42 2023]
Finished job 576.
215 of 759 steps (28%) done
Select jobs to execute...

[Thu Nov 23 10:36:42 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_31-sr/Ecoli_31_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/Ecoli_31.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/Ecoli_31_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/Ecoli_31_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/Ecoli_31_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/Ecoli_31_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/Ecoli_31_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_31.log
    jobid: 575
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/Ecoli_31_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/Ecoli_31.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/Ecoli_31_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/Ecoli_31_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/Ecoli_31_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/Ecoli_31_dnaapler_reoriented.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_31-sr/Ecoli_31_genome.fasta
    wildcards: sample=Ecoli_31
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_31-sr/Ecoli_31_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_31-sr/Ecoli_31_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Ecoli_31                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_31.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/Ecoli_31_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_31-sr/Ecoli_31_genome.fasta -n Ecoli_31_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr -p Ecoli_31 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:36:42 2023]
Error in rule pharokka_flye:
    jobid: 575
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_31-sr/Ecoli_31_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/Ecoli_31.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/Ecoli_31_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/Ecoli_31_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/Ecoli_31_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/Ecoli_31_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/Ecoli_31_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_31.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_31-sr/Ecoli_31_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_31-sr/Ecoli_31_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Ecoli_31                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_31.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr/Ecoli_31_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_31-sr/Ecoli_31_genome.fasta -n Ecoli_31_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_31-sr -p Ecoli_31 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_31.log not found.

Select jobs to execute...
[Thu Nov 23 10:36:51 2023]
Finished job 281.
216 of 759 steps (28%) done
[Thu Nov 23 10:37:14 2023]
Finished job 28.
217 of 759 steps (29%) done

[Thu Nov 23 10:37:14 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Ecoli_17.log
    jobid: 280
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Ecoli_17.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/assembly.fasta
    wildcards: sample=Ecoli_17
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Ecoli_17.log
        fi
        
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_

[Thu Nov 23 10:37:14 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Ecoli_17.log
    jobid: 180
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Ecoli_17.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/assembly_info.txt
    wildcards: sample=Ecoli_17
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:37:14 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Ecoli_17.log
    jobid: 179
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Ecoli_17.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/assembly.fasta
    wildcards: sample=Ecoli_17
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Ecoli_17.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_

[Thu Nov 23 10:37:14 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_17_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ecoli_17.log
    jobid: 91
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Ecoli_17.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_17_S.subsampled.fastq.gz
    wildcards: sample=Ecoli_17
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_17_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ecoli_17.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp6b3uum9n.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:37:15 2023]
Finished job 180.
218 of 759 steps (29%) done
Select jobs to execute...

[Thu Nov 23 10:37:15 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_17-sr/Ecoli_17_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Ecoli_17.log
    jobid: 721
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_17-sr/Ecoli_17_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/flye.log
    wildcards: sample=Ecoli_17
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_17-sr/Ecoli_17-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_17-sr/Ecoli_17-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/Ecoli_17_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/Ecoli_17_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_17-sr/Ecoli_17_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_17-sr/Ecoli_17.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_17-sr/Ecoli_17_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_17-sr/Ecoli_17.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/Ecoli_17_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_17-sr/Ecoli_17_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_17-sr/Ecoli_17-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_17-sr/Ecoli_17_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_17-sr/Ecoli_17-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_17-sr/Ecoli_17_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_17-sr/Ecoli_17-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_17-sr/Ecoli_17_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/Ecoli_17_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_17-sr/Ecoli_17_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_17-sr/Ecoli_17-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_17-sr/Ecoli_17_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_17-sr/Ecoli_17-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_17-sr/Ecoli_17_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_17-sr/Ecoli_17-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_17-sr/Ecoli_17_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/Ecoli_17_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_17-sr/Ecoli_17_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/Ecoli_17_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_17-sr/Ecoli_17_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/Ecoli_17_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_17-sr/Ecoli_17_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_17-sr/Ecoli_17_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_17-sr/Ecoli_17_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_17-sr/Ecoli_17_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_17-sr/Ecoli_17_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_17-sr/Ecoli_17_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_17-sr/Ecoli_17_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/Ecoli_17_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_17-sr/Ecoli_17_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_17-sr/Ecoli_17_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Ecoli_17" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_17-sr/Ecoli_17_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_17-sr/Ecoli_17_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Ecoli_17" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_17-sr/Ecoli_17_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_17-sr/Ecoli_17_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Ecoli_17" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_17-sr/Ecoli_17_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_17-sr/Ecoli_17_summary.txt
        fi
        
[Thu Nov 23 10:37:15 2023]
Finished job 721.
219 of 759 steps (29%) done
Select jobs to execute...
[Thu Nov 23 10:37:19 2023]
Finished job 181.
220 of 759 steps (29%) done

[Thu Nov 23 10:37:19 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_01-assembly-stats_flye.csv
    jobid: 344
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_01-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/checkv/quality_summary.tsv
    wildcards: sample=Bf_01
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpumo2pmlt.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:37:20 2023]
Finished job 344.
221 of 759 steps (29%) done
Select jobs to execute...

[Thu Nov 23 10:37:20 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_01-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_01-sr/Bf_01-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Bf_01.log
    jobid: 434
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_01-sr/Bf_01-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_01-assembly-stats_flye.csv
    wildcards: sample=Bf_01
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmprz770sll.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:37:22 2023]
Finished job 434.
222 of 759 steps (29%) done
Select jobs to execute...

[Thu Nov 23 10:37:22 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_01-sr/Bf_01-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_01-sr/Bf_01.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Bf_01.log
    jobid: 433
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_01-sr/Bf_01.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_01-sr/Bf_01-genome-candidates.csv
    wildcards: sample=Bf_01
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_01-sr/Bf_01-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_01-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_01-sr/Bf_01.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_01-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_01-sr/Bf_01.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:37:22 2023]
Finished job 433.
223 of 759 steps (29%) done
Select jobs to execute...

[Thu Nov 23 10:37:22 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_01-sr/Bf_01.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_01-sr/Bf_01_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_01-sr/Bf_01_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Bf_01.log
    jobid: 560
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_01-sr/Bf_01_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_01-sr/Bf_01.fasta
    wildcards: sample=Bf_01
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmplarnv9ou.rename_genomes.py
[Thu Nov 23 10:37:22 2023]
Finished job 560.
224 of 759 steps (30%) done
Select jobs to execute...

[Thu Nov 23 10:37:22 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_01-sr/Bf_01_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/Bf_01.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/Bf_01_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/Bf_01_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/Bf_01_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/Bf_01_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/Bf_01_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_01.log
    jobid: 559
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/Bf_01.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/Bf_01_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/Bf_01_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/Bf_01_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/Bf_01_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/Bf_01_dnaapler_reoriented.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_01-sr/Bf_01_genome.fasta
    wildcards: sample=Bf_01
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_01-sr/Bf_01_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_01-sr/Bf_01_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bf_01                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_01.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/Bf_01_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_01-sr/Bf_01_genome.fasta -n Bf_01_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr -p Bf_01 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:37:23 2023]
Error in rule pharokka_flye:
    jobid: 559
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_01-sr/Bf_01_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/Bf_01.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/Bf_01_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/Bf_01_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/Bf_01_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/Bf_01_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/Bf_01_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_01.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_01-sr/Bf_01_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_01-sr/Bf_01_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bf_01                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_01.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr/Bf_01_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_01-sr/Bf_01_genome.fasta -n Bf_01_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_01-sr -p Bf_01 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_01.log not found.

Select jobs to execute...
[Thu Nov 23 10:37:26 2023]
Finished job 280.
225 of 759 steps (30%) done
[Thu Nov 23 10:37:28 2023]
Finished job 91.
226 of 759 steps (30%) done

[Thu Nov 23 10:37:28 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_01_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bf_01.log
    jobid: 92
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Bf_01.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_01_S.subsampled.fastq.gz
    wildcards: sample=Bf_01
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_01_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bf_01.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_01-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:37:40 2023]
Finished job 92.
227 of 759 steps (30%) done
Select jobs to execute...

[Thu Nov 23 10:37:40 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_07_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bf_07.log
    jobid: 50
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Bf_07.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/assembly.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_07_S.subsampled.fastq.gz
    wildcards: sample=Bf_07
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_07_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bf_07.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:37:55 2023]
Finished job 179.
228 of 759 steps (30%) done
Select jobs to execute...

[Thu Nov 23 10:37:55 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_14_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bf_14.log
    jobid: 25
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Bf_14.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/assembly.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_14_S.subsampled.fastq.gz
    wildcards: sample=Bf_14
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_14_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bf_14.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:38:16 2023]
Finished job 50.
229 of 759 steps (30%) done
Select jobs to execute...

[Thu Nov 23 10:38:16 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_07-sr/Bf_07_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Bf_07.log
    jobid: 743
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_07-sr/Bf_07_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/flye.log
    wildcards: sample=Bf_07
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_07-sr/Bf_07-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_07-sr/Bf_07-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/Bf_07_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/Bf_07_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_07-sr/Bf_07_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_07-sr/Bf_07.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_07-sr/Bf_07_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_07-sr/Bf_07.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/Bf_07_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_07-sr/Bf_07_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_07-sr/Bf_07-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_07-sr/Bf_07_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_07-sr/Bf_07-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_07-sr/Bf_07_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_07-sr/Bf_07-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_07-sr/Bf_07_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/Bf_07_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_07-sr/Bf_07_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_07-sr/Bf_07-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_07-sr/Bf_07_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_07-sr/Bf_07-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_07-sr/Bf_07_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_07-sr/Bf_07-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_07-sr/Bf_07_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/Bf_07_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_07-sr/Bf_07_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/Bf_07_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_07-sr/Bf_07_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/Bf_07_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_07-sr/Bf_07_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_07-sr/Bf_07_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_07-sr/Bf_07_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_07-sr/Bf_07_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_07-sr/Bf_07_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_07-sr/Bf_07_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_07-sr/Bf_07_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/Bf_07_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_07-sr/Bf_07_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_07-sr/Bf_07_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Bf_07" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_07-sr/Bf_07_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_07-sr/Bf_07_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Bf_07" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_07-sr/Bf_07_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_07-sr/Bf_07_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Bf_07" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_07-sr/Bf_07_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_07-sr/Bf_07_summary.txt
        fi
        

[Thu Nov 23 10:38:16 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bf_07.log
    jobid: 302
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Bf_07.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/assembly.fasta
    wildcards: sample=Bf_07
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bf_07.log
        fi
        
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_

[Thu Nov 23 10:38:16 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Bf_07.log
    jobid: 224
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Bf_07.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/assembly.fasta
    wildcards: sample=Bf_07
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:38:16 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_17-assembly-stats_flye.csv
    jobid: 343
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_17-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/checkv/quality_summary.tsv
    wildcards: sample=Ecoli_17
    resources: tmpdir=/local/nala0006/2279907

[Thu Nov 23 10:38:16 2023]
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bf_07.log
    jobid: 223
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Bf_07.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/assembly.fasta
    wildcards: sample=Bf_07
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bf_07.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_
[Thu Nov 23 10:38:16 2023]
Finished job 743.
230 of 759 steps (30%) done
Select jobs to execute...
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpmkeqdjdl.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpo7hxsc0n.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:38:17 2023]
Finished job 224.
231 of 759 steps (30%) done
[Thu Nov 23 10:38:17 2023]
Finished job 343.
232 of 759 steps (31%) done

[Thu Nov 23 10:38:17 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_17-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_17-sr/Ecoli_17-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Ecoli_17.log
    jobid: 432
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_17-sr/Ecoli_17-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_17-assembly-stats_flye.csv
    wildcards: sample=Ecoli_17
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpbisgxzf1.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:38:18 2023]
Finished job 432.
233 of 759 steps (31%) done
Select jobs to execute...

[Thu Nov 23 10:38:18 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_17-sr/Ecoli_17-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_17-sr/Ecoli_17.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Ecoli_17.log
    jobid: 431
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_17-sr/Ecoli_17.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_17-sr/Ecoli_17-genome-candidates.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/assembly.fasta
    wildcards: sample=Ecoli_17
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_17-sr/Ecoli_17-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_17-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_17-sr/Ecoli_17.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_17-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_17-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_17-sr/Ecoli_17.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:38:19 2023]
Finished job 431.
234 of 759 steps (31%) done
Select jobs to execute...

[Thu Nov 23 10:38:19 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_17-sr/Ecoli_17.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_17-sr/Ecoli_17_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_17-sr/Ecoli_17_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Ecoli_17.log
    jobid: 558
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_17-sr/Ecoli_17_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_17-sr/Ecoli_17.fasta
    wildcards: sample=Ecoli_17
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpe0960jqc.rename_genomes.py
[Thu Nov 23 10:38:19 2023]
Finished job 558.
235 of 759 steps (31%) done
Select jobs to execute...

[Thu Nov 23 10:38:19 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_17-sr/Ecoli_17_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/Ecoli_17.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/Ecoli_17_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/Ecoli_17_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/Ecoli_17_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/Ecoli_17_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/Ecoli_17_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_17.log
    jobid: 557
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/Ecoli_17.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/Ecoli_17_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/Ecoli_17_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/Ecoli_17_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/Ecoli_17_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/Ecoli_17_length_gc_cds_density.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_17-sr/Ecoli_17_genome.fasta
    wildcards: sample=Ecoli_17
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_17-sr/Ecoli_17_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_17-sr/Ecoli_17_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Ecoli_17                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_17.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/Ecoli_17_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_17-sr/Ecoli_17_genome.fasta -n Ecoli_17_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr -p Ecoli_17 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:38:19 2023]
Error in rule pharokka_flye:
    jobid: 557
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_17-sr/Ecoli_17_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/Ecoli_17.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/Ecoli_17_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/Ecoli_17_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/Ecoli_17_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/Ecoli_17_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/Ecoli_17_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_17.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_17-sr/Ecoli_17_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_17-sr/Ecoli_17_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Ecoli_17                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_17.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr/Ecoli_17_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_17-sr/Ecoli_17_genome.fasta -n Ecoli_17_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_17-sr -p Ecoli_17 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_17.log not found.

Select jobs to execute...
[Thu Nov 23 10:38:30 2023]
Finished job 302.
236 of 759 steps (31%) done
[Thu Nov 23 10:38:31 2023]
Finished job 25.
237 of 759 steps (31%) done

[Thu Nov 23 10:38:31 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bf_14.log
    jobid: 277
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Bf_14.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/assembly.fasta
    wildcards: sample=Bf_14
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bf_14.log
        fi
        
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_

[Thu Nov 23 10:38:31 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_07_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bf_07.log
    jobid: 113
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Bf_07.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_07_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/assembly.fasta
    wildcards: sample=Bf_07
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_07_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bf_07.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_

[Thu Nov 23 10:38:31 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Bf_14.log
    jobid: 174
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Bf_14.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/assembly.fasta
    wildcards: sample=Bf_14
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:38:31 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bf_14.log
    jobid: 173
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Bf_14.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/assembly.fasta
    wildcards: sample=Bf_14
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bf_14.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmplvcqdbxu.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:38:32 2023]
Finished job 174.
238 of 759 steps (31%) done
Select jobs to execute...

[Thu Nov 23 10:38:32 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_14-sr/Bf_14_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Bf_14.log
    jobid: 718
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_14-sr/Bf_14_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/flye.log
    wildcards: sample=Bf_14
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_14-sr/Bf_14-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_14-sr/Bf_14-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/Bf_14_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/Bf_14_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_14-sr/Bf_14_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_14-sr/Bf_14.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_14-sr/Bf_14_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_14-sr/Bf_14.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/Bf_14_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_14-sr/Bf_14_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_14-sr/Bf_14-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_14-sr/Bf_14_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_14-sr/Bf_14-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_14-sr/Bf_14_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_14-sr/Bf_14-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_14-sr/Bf_14_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/Bf_14_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_14-sr/Bf_14_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_14-sr/Bf_14-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_14-sr/Bf_14_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_14-sr/Bf_14-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_14-sr/Bf_14_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_14-sr/Bf_14-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_14-sr/Bf_14_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/Bf_14_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_14-sr/Bf_14_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/Bf_14_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_14-sr/Bf_14_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/Bf_14_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_14-sr/Bf_14_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_14-sr/Bf_14_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_14-sr/Bf_14_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_14-sr/Bf_14_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_14-sr/Bf_14_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_14-sr/Bf_14_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_14-sr/Bf_14_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/Bf_14_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_14-sr/Bf_14_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_14-sr/Bf_14_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Bf_14" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_14-sr/Bf_14_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_14-sr/Bf_14_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Bf_14" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_14-sr/Bf_14_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_14-sr/Bf_14_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Bf_14" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_14-sr/Bf_14_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_14-sr/Bf_14_summary.txt
        fi
        
[Thu Nov 23 10:38:32 2023]
Finished job 718.
239 of 759 steps (31%) done
Select jobs to execute...
[Thu Nov 23 10:38:43 2023]
Finished job 277.
240 of 759 steps (32%) done
[Thu Nov 23 10:39:06 2023]
Finished job 223.
241 of 759 steps (32%) done

[Thu Nov 23 10:39:06 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_07-assembly-stats_flye.csv
    jobid: 365
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_07-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/checkv/quality_summary.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/assembly_result_table.csv
    wildcards: sample=Bf_07
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpel3m976y.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:39:08 2023]
Finished job 365.
242 of 759 steps (32%) done
Select jobs to execute...

[Thu Nov 23 10:39:08 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_07-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_07-sr/Bf_07-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Bf_07.log
    jobid: 476
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_07-sr/Bf_07-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_07-assembly-stats_flye.csv
    wildcards: sample=Bf_07
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpx8vyk716.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:39:09 2023]
Finished job 476.
243 of 759 steps (32%) done
Select jobs to execute...

[Thu Nov 23 10:39:09 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_07-sr/Bf_07-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_07-sr/Bf_07.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Bf_07.log
    jobid: 475
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_07-sr/Bf_07.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_07-sr/Bf_07-genome-candidates.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/assembly.fasta
    wildcards: sample=Bf_07
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_07-sr/Bf_07-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_07-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_07-sr/Bf_07.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_07-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_07-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_07-sr/Bf_07.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:39:09 2023]
Finished job 475.
244 of 759 steps (32%) done
Select jobs to execute...

[Thu Nov 23 10:39:09 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_07-sr/Bf_07.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_07-sr/Bf_07_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_07-sr/Bf_07_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Bf_07.log
    jobid: 602
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_07-sr/Bf_07_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_07-sr/Bf_07.fasta
    wildcards: sample=Bf_07
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmprwgrx3b_.rename_genomes.py
[Thu Nov 23 10:39:10 2023]
Finished job 602.
245 of 759 steps (32%) done
Select jobs to execute...

[Thu Nov 23 10:39:10 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_07-sr/Bf_07_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/Bf_07.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/Bf_07_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/Bf_07_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/Bf_07_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/Bf_07_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/Bf_07_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_07.log
    jobid: 601
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/Bf_07_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/Bf_07_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/Bf_07_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/Bf_07.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/Bf_07_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/Bf_07_minced_spacers.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_07-sr/Bf_07_genome.fasta
    wildcards: sample=Bf_07
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_07-sr/Bf_07_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_07-sr/Bf_07_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bf_07                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_07.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/Bf_07_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_07-sr/Bf_07_genome.fasta -n Bf_07_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr -p Bf_07 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:39:10 2023]
Error in rule pharokka_flye:
    jobid: 601
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_07-sr/Bf_07_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/Bf_07.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/Bf_07_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/Bf_07_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/Bf_07_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/Bf_07_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/Bf_07_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_07.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_07-sr/Bf_07_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_07-sr/Bf_07_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bf_07                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_07.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr/Bf_07_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_07-sr/Bf_07_genome.fasta -n Bf_07_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_07-sr -p Bf_07 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_07.log not found.

Select jobs to execute...
[Thu Nov 23 10:39:11 2023]
Finished job 173.
246 of 759 steps (32%) done

[Thu Nov 23 10:39:11 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_14_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bf_14.log
    jobid: 88
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Bf_14.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_14_S.subsampled.fastq.gz
    wildcards: sample=Bf_14
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_14_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bf_14.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:39:24 2023]
Finished job 88.
247 of 759 steps (33%) done
Select jobs to execute...

[Thu Nov 23 10:39:24 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_16_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bb_16.log
    jobid: 26
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Bb_16.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/assembly.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_16_S.subsampled.fastq.gz
    wildcards: sample=Bb_16
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_16_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bb_16.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:39:33 2023]
Finished job 26.
248 of 759 steps (33%) done
Select jobs to execute...

[Thu Nov 23 10:39:33 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_16-sr/Bb_16_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Bb_16.log
    jobid: 719
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_16-sr/Bb_16_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/flye.log
    wildcards: sample=Bb_16
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_16-sr/Bb_16-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_16-sr/Bb_16-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/Bb_16_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/Bb_16_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_16-sr/Bb_16_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_16-sr/Bb_16.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_16-sr/Bb_16_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_16-sr/Bb_16.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/Bb_16_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_16-sr/Bb_16_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_16-sr/Bb_16-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_16-sr/Bb_16_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_16-sr/Bb_16-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_16-sr/Bb_16_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_16-sr/Bb_16-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_16-sr/Bb_16_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/Bb_16_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_16-sr/Bb_16_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_16-sr/Bb_16-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_16-sr/Bb_16_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_16-sr/Bb_16-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_16-sr/Bb_16_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_16-sr/Bb_16-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_16-sr/Bb_16_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/Bb_16_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_16-sr/Bb_16_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/Bb_16_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_16-sr/Bb_16_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/Bb_16_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_16-sr/Bb_16_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_16-sr/Bb_16_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_16-sr/Bb_16_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_16-sr/Bb_16_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_16-sr/Bb_16_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_16-sr/Bb_16_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_16-sr/Bb_16_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/Bb_16_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_16-sr/Bb_16_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_16-sr/Bb_16_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Bb_16" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_16-sr/Bb_16_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_16-sr/Bb_16_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Bb_16" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_16-sr/Bb_16_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_16-sr/Bb_16_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Bb_16" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_16-sr/Bb_16_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_16-sr/Bb_16_summary.txt
        fi
        

[Thu Nov 23 10:39:33 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bb_16.log
    jobid: 278
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Bb_16.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/assembly.fasta
    wildcards: sample=Bb_16
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bb_16.log
        fi
        

Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_
[Thu Nov 23 10:39:33 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Bb_16.log
    jobid: 176
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Bb_16.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/assembly.fasta
    wildcards: sample=Bb_16
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:39:33 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_14-assembly-stats_flye.csv
    jobid: 340
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_14-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/checkv/quality_summary.tsv
    wildcards: sample=Bf_14
    resources: tmpdir=/local/nala0006/2279907

[Thu Nov 23 10:39:33 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bb_16.log
    jobid: 175
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Bb_16.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/assembly.fasta
    wildcards: sample=Bb_16
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bb_16.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_
[Thu Nov 23 10:39:33 2023]
Finished job 719.
249 of 759 steps (33%) done
Select jobs to execute...
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpsfh3l3wb.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp0kwr6s3l.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:39:34 2023]
Finished job 176.
250 of 759 steps (33%) done
[Thu Nov 23 10:39:34 2023]
Finished job 340.
251 of 759 steps (33%) done

[Thu Nov 23 10:39:34 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_14-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_14-sr/Bf_14-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Bf_14.log
    jobid: 426
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_14-sr/Bf_14-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_14-assembly-stats_flye.csv
    wildcards: sample=Bf_14
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp9cckhq_i.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:39:35 2023]
Finished job 426.
252 of 759 steps (33%) done
Select jobs to execute...

[Thu Nov 23 10:39:35 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_14-sr/Bf_14-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_14-sr/Bf_14.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Bf_14.log
    jobid: 425
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_14-sr/Bf_14.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_14-sr/Bf_14-genome-candidates.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/assembly.fasta
    wildcards: sample=Bf_14
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_14-sr/Bf_14-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_14-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_14-sr/Bf_14.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_14-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_14-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_14-sr/Bf_14.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:39:36 2023]
Finished job 425.
253 of 759 steps (33%) done
Select jobs to execute...

[Thu Nov 23 10:39:36 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_14-sr/Bf_14.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_14-sr/Bf_14_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_14-sr/Bf_14_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Bf_14.log
    jobid: 552
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_14-sr/Bf_14_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_14-sr/Bf_14.fasta
    wildcards: sample=Bf_14
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpxpf9tr2t.rename_genomes.py
[Thu Nov 23 10:39:36 2023]
Finished job 552.
254 of 759 steps (33%) done
Select jobs to execute...

[Thu Nov 23 10:39:36 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_14-sr/Bf_14_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/Bf_14.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/Bf_14_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/Bf_14_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/Bf_14_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/Bf_14_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/Bf_14_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_14.log
    jobid: 551
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/Bf_14_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/Bf_14_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/Bf_14_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/Bf_14_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/Bf_14.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/Bf_14_pharokka_plot.png; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_14-sr/Bf_14_genome.fasta
    wildcards: sample=Bf_14
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_14-sr/Bf_14_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_14-sr/Bf_14_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bf_14                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_14.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/Bf_14_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_14-sr/Bf_14_genome.fasta -n Bf_14_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr -p Bf_14 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:39:37 2023]
Error in rule pharokka_flye:
    jobid: 551
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_14-sr/Bf_14_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/Bf_14.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/Bf_14_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/Bf_14_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/Bf_14_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/Bf_14_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/Bf_14_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_14.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_14-sr/Bf_14_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_14-sr/Bf_14_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bf_14                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_14.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr/Bf_14_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_14-sr/Bf_14_genome.fasta -n Bf_14_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_14-sr -p Bf_14 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_14.log not found.

Select jobs to execute...
[Thu Nov 23 10:39:54 2023]
Finished job 278.
255 of 759 steps (34%) done
[Thu Nov 23 10:40:09 2023]
Finished job 113.
256 of 759 steps (34%) done

[Thu Nov 23 10:40:09 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_16_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bb_16.log
    jobid: 89
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Bb_16.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_16_S.subsampled.fastq.gz
    wildcards: sample=Bb_16
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_16_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bb_16.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:40:58 2023]
Finished job 89.
257 of 759 steps (34%) done
Select jobs to execute...

[Thu Nov 23 10:40:58 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_15_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bb_15.log
    jobid: 44
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Bb_15.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/assembly_graph.gfa; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_15_S.subsampled.fastq.gz
    wildcards: sample=Bb_15
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_15_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bb_15.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:41:07 2023]
Finished job 175.
258 of 759 steps (34%) done
Select jobs to execute...

[Thu Nov 23 10:41:07 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_03_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bf_03.log
    jobid: 42
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Bf_03.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/assembly_info.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_03_S.subsampled.fastq.gz
    wildcards: sample=Bf_03
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_03_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bf_03.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:41:08 2023]
Finished job 44.
259 of 759 steps (34%) done
Select jobs to execute...

[Thu Nov 23 10:41:08 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_15-sr/Bb_15_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Bb_15.log
    jobid: 737
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_15-sr/Bb_15_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/flye.log
    wildcards: sample=Bb_15
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_15-sr/Bb_15-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_15-sr/Bb_15-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/Bb_15_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/Bb_15_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_15-sr/Bb_15_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_15-sr/Bb_15.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_15-sr/Bb_15_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_15-sr/Bb_15.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/Bb_15_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_15-sr/Bb_15_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_15-sr/Bb_15-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_15-sr/Bb_15_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_15-sr/Bb_15-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_15-sr/Bb_15_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_15-sr/Bb_15-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_15-sr/Bb_15_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/Bb_15_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_15-sr/Bb_15_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_15-sr/Bb_15-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_15-sr/Bb_15_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_15-sr/Bb_15-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_15-sr/Bb_15_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_15-sr/Bb_15-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_15-sr/Bb_15_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/Bb_15_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_15-sr/Bb_15_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/Bb_15_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_15-sr/Bb_15_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/Bb_15_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_15-sr/Bb_15_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_15-sr/Bb_15_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_15-sr/Bb_15_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_15-sr/Bb_15_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_15-sr/Bb_15_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_15-sr/Bb_15_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_15-sr/Bb_15_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/Bb_15_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_15-sr/Bb_15_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_15-sr/Bb_15_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Bb_15" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_15-sr/Bb_15_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_15-sr/Bb_15_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Bb_15" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_15-sr/Bb_15_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_15-sr/Bb_15_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Bb_15" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_15-sr/Bb_15_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bb_15-sr/Bb_15_summary.txt
        fi
        

[Thu Nov 23 10:41:09 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bb_16-assembly-stats_flye.csv
    jobid: 341
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bb_16-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/checkv/quality_summary.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/assembly_result_table.csv
    wildcards: sample=Bb_16
    resources: tmpdir=/local/nala0006/2279907

[Thu Nov 23 10:41:09 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Bb_15.log
    jobid: 212
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Bb_15.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/assembly_graph.gfa
    wildcards: sample=Bb_15
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_

[Thu Nov 23 10:41:09 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bb_15.log
    jobid: 296
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Bb_15.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/assembly.fasta
    wildcards: sample=Bb_15
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bb_15.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_

[Thu Nov 23 10:41:09 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bb_15.log
    jobid: 211
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Bb_15.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/assembly.fasta
    wildcards: sample=Bb_15
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bb_15.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_
[Thu Nov 23 10:41:09 2023]
Finished job 737.
260 of 759 steps (34%) done
Select jobs to execute...
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp2sq22usy.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp69r57jnp.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:41:10 2023]
Finished job 212.
261 of 759 steps (34%) done
[Thu Nov 23 10:41:10 2023]
Finished job 341.
262 of 759 steps (35%) done

[Thu Nov 23 10:41:10 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bb_16-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_16-sr/Bb_16-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Bb_16.log
    jobid: 428
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_16-sr/Bb_16-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bb_16-assembly-stats_flye.csv
    wildcards: sample=Bb_16
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpi9j92yac.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:41:11 2023]
Finished job 428.
263 of 759 steps (35%) done
Select jobs to execute...

[Thu Nov 23 10:41:11 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_16-sr/Bb_16-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_16-sr/Bb_16.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Bb_16.log
    jobid: 427
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_16-sr/Bb_16.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_16-sr/Bb_16-genome-candidates.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/assembly.fasta
    wildcards: sample=Bb_16
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_16-sr/Bb_16-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_16-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_16-sr/Bb_16.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_16-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_16-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_16-sr/Bb_16.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:41:11 2023]
Finished job 427.
264 of 759 steps (35%) done
Select jobs to execute...

[Thu Nov 23 10:41:11 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_16-sr/Bb_16.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_16-sr/Bb_16_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_16-sr/Bb_16_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Bb_16.log
    jobid: 554
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_16-sr/Bb_16_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_16-sr/Bb_16.fasta
    wildcards: sample=Bb_16
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpv8incbph.rename_genomes.py
[Thu Nov 23 10:41:12 2023]
Finished job 554.
265 of 759 steps (35%) done
Select jobs to execute...

[Thu Nov 23 10:41:12 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_16-sr/Bb_16_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/Bb_16.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/Bb_16_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/Bb_16_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/Bb_16_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/Bb_16_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/Bb_16_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bb_16.log
    jobid: 553
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/Bb_16_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/Bb_16.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/Bb_16_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/Bb_16_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/Bb_16_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/Bb_16_top_hits_mash_inphared.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_16-sr/Bb_16_genome.fasta
    wildcards: sample=Bb_16
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_16-sr/Bb_16_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_16-sr/Bb_16_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bb_16                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bb_16.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/Bb_16_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_16-sr/Bb_16_genome.fasta -n Bb_16_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr -p Bb_16 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:41:12 2023]
Error in rule pharokka_flye:
    jobid: 553
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_16-sr/Bb_16_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/Bb_16.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/Bb_16_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/Bb_16_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/Bb_16_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/Bb_16_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/Bb_16_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bb_16.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_16-sr/Bb_16_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_16-sr/Bb_16_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bb_16                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bb_16.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr/Bb_16_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_16-sr/Bb_16_genome.fasta -n Bb_16_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_16-sr -p Bb_16 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bb_16.log not found.

Select jobs to execute...
[Thu Nov 23 10:41:30 2023]
Finished job 296.
266 of 759 steps (35%) done
[Thu Nov 23 10:41:59 2023]
Finished job 42.
267 of 759 steps (35%) done

[Thu Nov 23 10:41:59 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Bf_03.log
    jobid: 208
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Bf_03.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/assembly_graph.gfa
    wildcards: sample=Bf_03
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:42:00 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bf_03.log
    jobid: 294
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Bf_03.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/assembly.fasta
    wildcards: sample=Bf_03
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bf_03.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_

[Thu Nov 23 10:42:00 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bf_03.log
    jobid: 207
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Bf_03.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/assembly.fasta
    wildcards: sample=Bf_03
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bf_03.log
        fi
        

Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_
[Thu Nov 23 10:42:00 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_15_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bb_15.log
    jobid: 107
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Bb_15.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_15_S.subsampled.fastq.gz
    wildcards: sample=Bb_15
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bb_15_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bb_15.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpgjn72p6h.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:42:01 2023]
Finished job 208.
268 of 759 steps (35%) done
Select jobs to execute...

[Thu Nov 23 10:42:01 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_03-sr/Bf_03_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Bf_03.log
    jobid: 735
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_03-sr/Bf_03_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/flye.log
    wildcards: sample=Bf_03
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_03-sr/Bf_03-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_03-sr/Bf_03-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/Bf_03_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/Bf_03_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_03-sr/Bf_03_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_03-sr/Bf_03.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_03-sr/Bf_03_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_03-sr/Bf_03.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/Bf_03_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_03-sr/Bf_03_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_03-sr/Bf_03-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_03-sr/Bf_03_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_03-sr/Bf_03-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_03-sr/Bf_03_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_03-sr/Bf_03-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_03-sr/Bf_03_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/Bf_03_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_03-sr/Bf_03_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_03-sr/Bf_03-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_03-sr/Bf_03_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_03-sr/Bf_03-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_03-sr/Bf_03_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_03-sr/Bf_03-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_03-sr/Bf_03_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/Bf_03_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_03-sr/Bf_03_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/Bf_03_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_03-sr/Bf_03_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/Bf_03_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_03-sr/Bf_03_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_03-sr/Bf_03_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_03-sr/Bf_03_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_03-sr/Bf_03_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_03-sr/Bf_03_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_03-sr/Bf_03_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_03-sr/Bf_03_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/Bf_03_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_03-sr/Bf_03_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_03-sr/Bf_03_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Bf_03" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_03-sr/Bf_03_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_03-sr/Bf_03_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Bf_03" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_03-sr/Bf_03_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_03-sr/Bf_03_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Bf_03" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_03-sr/Bf_03_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_03-sr/Bf_03_summary.txt
        fi
        
[Thu Nov 23 10:42:01 2023]
Finished job 735.
269 of 759 steps (35%) done
Select jobs to execute...
[Thu Nov 23 10:42:14 2023]
Finished job 294.
270 of 759 steps (36%) done
[Thu Nov 23 10:42:22 2023]
Finished job 107.
271 of 759 steps (36%) done

[Thu Nov 23 10:42:22 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_03_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bf_03.log
    jobid: 105
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Bf_03.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_03_S.subsampled.fastq.gz
    wildcards: sample=Bf_03
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_03_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bf_03.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:42:35 2023]
Finished job 105.
272 of 759 steps (36%) done
Select jobs to execute...

[Thu Nov 23 10:42:35 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_13_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bf_13.log
    jobid: 49
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Bf_13.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/assembly_info.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_13_S.subsampled.fastq.gz
    wildcards: sample=Bf_13
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_13_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bf_13.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:42:45 2023]
Finished job 207.
273 of 759 steps (36%) done
Select jobs to execute...

[Thu Nov 23 10:42:45 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_03-assembly-stats_flye.csv
    jobid: 357
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_03-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/checkv/quality_summary.tsv
    wildcards: sample=Bf_03
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:42:45 2023]
Finished job 211.
274 of 759 steps (36%) done
Select jobs to execute...

[Thu Nov 23 10:42:45 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bb_15-assembly-stats_flye.csv
    jobid: 359
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bb_15-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/checkv/quality_summary.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/assembly_result_table.csv
    wildcards: sample=Bb_15
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpok0i6_94.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpvgt7cech.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:42:46 2023]
Finished job 357.
275 of 759 steps (36%) done
Select jobs to execute...

[Thu Nov 23 10:42:46 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_03-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_03-sr/Bf_03-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Bf_03.log
    jobid: 460
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_03-sr/Bf_03-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_03-assembly-stats_flye.csv
    wildcards: sample=Bf_03
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:42:46 2023]
Finished job 359.
276 of 759 steps (36%) done
Select jobs to execute...

[Thu Nov 23 10:42:46 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bb_15-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_15-sr/Bb_15-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Bb_15.log
    jobid: 464
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_15-sr/Bb_15-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bb_15-assembly-stats_flye.csv
    wildcards: sample=Bb_15
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp_qamylz2.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpfdtej4cx.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:42:48 2023]
Finished job 460.
277 of 759 steps (36%) done
Select jobs to execute...

[Thu Nov 23 10:42:48 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_03-sr/Bf_03-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_03-sr/Bf_03.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Bf_03.log
    jobid: 459
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_03-sr/Bf_03.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_03-sr/Bf_03-genome-candidates.csv
    wildcards: sample=Bf_03
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_03-sr/Bf_03-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_03-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_03-sr/Bf_03.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_03-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_03-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_03-sr/Bf_03.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:42:48 2023]
Finished job 464.
278 of 759 steps (37%) done
Select jobs to execute...

[Thu Nov 23 10:42:48 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_15-sr/Bb_15-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_15-sr/Bb_15.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Bb_15.log
    jobid: 463
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_15-sr/Bb_15.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_15-sr/Bb_15-genome-candidates.csv
    wildcards: sample=Bb_15
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_15-sr/Bb_15-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_15-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_15-sr/Bb_15.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_15-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bb_15-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_15-sr/Bb_15.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:42:48 2023]
Finished job 459.
279 of 759 steps (37%) done
Select jobs to execute...

[Thu Nov 23 10:42:48 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_03-sr/Bf_03.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_03-sr/Bf_03_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_03-sr/Bf_03_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Bf_03.log
    jobid: 586
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_03-sr/Bf_03_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_03-sr/Bf_03.fasta
    wildcards: sample=Bf_03
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpe36zxwen.rename_genomes.py
[Thu Nov 23 10:42:48 2023]
Finished job 463.
280 of 759 steps (37%) done
Select jobs to execute...

[Thu Nov 23 10:42:48 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_15-sr/Bb_15.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_15-sr/Bb_15_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_15-sr/Bb_15_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Bb_15.log
    jobid: 590
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_15-sr/Bb_15_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_15-sr/Bb_15.fasta
    wildcards: sample=Bb_15
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpjaj3rwcp.rename_genomes.py
[Thu Nov 23 10:42:48 2023]
Finished job 586.
281 of 759 steps (37%) done
Select jobs to execute...

[Thu Nov 23 10:42:48 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_03-sr/Bf_03_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/Bf_03.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/Bf_03_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/Bf_03_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/Bf_03_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/Bf_03_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/Bf_03_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_03.log
    jobid: 585
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/Bf_03_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/Bf_03_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/Bf_03.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/Bf_03_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/Bf_03_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/Bf_03_pharokka_plot.png; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_03-sr/Bf_03_genome.fasta
    wildcards: sample=Bf_03
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_03-sr/Bf_03_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_03-sr/Bf_03_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bf_03                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_03.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/Bf_03_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_03-sr/Bf_03_genome.fasta -n Bf_03_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr -p Bf_03 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
[Thu Nov 23 10:42:48 2023]
Finished job 590.
282 of 759 steps (37%) done
Select jobs to execute...

[Thu Nov 23 10:42:48 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_15-sr/Bb_15_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/Bb_15.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/Bb_15_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/Bb_15_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/Bb_15_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/Bb_15_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/Bb_15_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bb_15.log
    jobid: 589
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/Bb_15_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/Bb_15.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/Bb_15_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/Bb_15_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/Bb_15_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/Bb_15_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/top_hits_card.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_15-sr/Bb_15_genome.fasta
    wildcards: sample=Bb_15
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_15-sr/Bb_15_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_15-sr/Bb_15_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bb_15                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bb_15.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/Bb_15_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_15-sr/Bb_15_genome.fasta -n Bb_15_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr -p Bb_15 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:42:49 2023]
Error in rule pharokka_flye:
    jobid: 585
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_03-sr/Bf_03_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/Bf_03.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/Bf_03_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/Bf_03_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/Bf_03_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/Bf_03_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/Bf_03_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_03.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_03-sr/Bf_03_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_03-sr/Bf_03_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bf_03                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_03.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr/Bf_03_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_03-sr/Bf_03_genome.fasta -n Bf_03_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_03-sr -p Bf_03 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_03.log not found.

Select jobs to execute...
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:42:49 2023]
Error in rule pharokka_flye:
    jobid: 589
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_15-sr/Bb_15_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/Bb_15.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/Bb_15_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/Bb_15_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/Bb_15_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/Bb_15_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/Bb_15_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bb_15.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_15-sr/Bb_15_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_15-sr/Bb_15_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bb_15                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bb_15.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr/Bb_15_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bb_15-sr/Bb_15_genome.fasta -n Bb_15_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bb_15-sr -p Bb_15 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bb_15.log not found.


[Thu Nov 23 10:42:49 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_18_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bu_18.log
    jobid: 59
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Bu_18.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/assembly_info.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_18_S.subsampled.fastq.gz
    wildcards: sample=Bu_18
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_18_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bu_18.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:42:55 2023]
Finished job 59.
283 of 759 steps (37%) done
Select jobs to execute...

[Thu Nov 23 10:42:55 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_18-sr/Bu_18_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Bu_18.log
    jobid: 752
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_18-sr/Bu_18_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/flye.log
    wildcards: sample=Bu_18
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_18-sr/Bu_18-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_18-sr/Bu_18-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/Bu_18_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/Bu_18_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_18-sr/Bu_18_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_18-sr/Bu_18.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_18-sr/Bu_18_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_18-sr/Bu_18.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/Bu_18_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_18-sr/Bu_18_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_18-sr/Bu_18-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_18-sr/Bu_18_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_18-sr/Bu_18-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_18-sr/Bu_18_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_18-sr/Bu_18-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_18-sr/Bu_18_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/Bu_18_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_18-sr/Bu_18_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_18-sr/Bu_18-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_18-sr/Bu_18_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_18-sr/Bu_18-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_18-sr/Bu_18_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_18-sr/Bu_18-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_18-sr/Bu_18_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/Bu_18_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_18-sr/Bu_18_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/Bu_18_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_18-sr/Bu_18_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/Bu_18_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_18-sr/Bu_18_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_18-sr/Bu_18_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_18-sr/Bu_18_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_18-sr/Bu_18_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_18-sr/Bu_18_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_18-sr/Bu_18_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_18-sr/Bu_18_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/Bu_18_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_18-sr/Bu_18_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_18-sr/Bu_18_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Bu_18" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_18-sr/Bu_18_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_18-sr/Bu_18_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Bu_18" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_18-sr/Bu_18_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_18-sr/Bu_18_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Bu_18" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_18-sr/Bu_18_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_18-sr/Bu_18_summary.txt
        fi
        

[Thu Nov 23 10:42:56 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bu_18.log
    jobid: 241
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Bu_18.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/assembly.fasta
    wildcards: sample=Bu_18
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bu_18.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_

[Thu Nov 23 10:42:56 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Bu_18.log
    jobid: 242
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Bu_18.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/assembly_info.txt
    wildcards: sample=Bu_18
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:42:56 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bu_18.log
    jobid: 311
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Bu_18.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/assembly.fasta
    wildcards: sample=Bu_18
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bu_18.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_
[Thu Nov 23 10:42:56 2023]
Finished job 752.
284 of 759 steps (37%) done
Select jobs to execute...
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp70e88rv_.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:42:57 2023]
Finished job 242.
285 of 759 steps (38%) done
[Thu Nov 23 10:42:58 2023]
Finished job 49.
286 of 759 steps (38%) done

[Thu Nov 23 10:42:58 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_13_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bf_13.log
    jobid: 112
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Bf_13.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_13_S.subsampled.fastq.gz
    wildcards: sample=Bf_13
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bf_13_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bf_13.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_

[Thu Nov 23 10:42:58 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bf_13.log
    jobid: 221
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Bf_13.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/assembly.fasta
    wildcards: sample=Bf_13
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bf_13.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_

[Thu Nov 23 10:42:58 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Bf_13.log
    jobid: 222
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Bf_13.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/assembly_info.txt
    wildcards: sample=Bf_13
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpf0h8m2ho.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:42:59 2023]
Finished job 222.
287 of 759 steps (38%) done
Select jobs to execute...

[Thu Nov 23 10:42:59 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bf_13.log
    jobid: 301
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Bf_13.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/assembly.fasta
    wildcards: sample=Bf_13
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bf_13.log
        fi
        
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_
[Thu Nov 23 10:43:11 2023]
Finished job 311.
288 of 759 steps (38%) done
Select jobs to execute...

[Thu Nov 23 10:43:11 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_13-sr/Bf_13_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Bf_13.log
    jobid: 742
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_13-sr/Bf_13_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/flye.log
    wildcards: sample=Bf_13
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_13-sr/Bf_13-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_13-sr/Bf_13-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/Bf_13_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/Bf_13_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_13-sr/Bf_13_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_13-sr/Bf_13.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_13-sr/Bf_13_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_13-sr/Bf_13.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/Bf_13_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_13-sr/Bf_13_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_13-sr/Bf_13-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_13-sr/Bf_13_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_13-sr/Bf_13-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_13-sr/Bf_13_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_13-sr/Bf_13-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_13-sr/Bf_13_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/Bf_13_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_13-sr/Bf_13_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_13-sr/Bf_13-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_13-sr/Bf_13_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_13-sr/Bf_13-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_13-sr/Bf_13_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_13-sr/Bf_13-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_13-sr/Bf_13_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/Bf_13_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_13-sr/Bf_13_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/Bf_13_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_13-sr/Bf_13_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/Bf_13_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_13-sr/Bf_13_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_13-sr/Bf_13_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_13-sr/Bf_13_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_13-sr/Bf_13_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_13-sr/Bf_13_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_13-sr/Bf_13_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_13-sr/Bf_13_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/Bf_13_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_13-sr/Bf_13_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_13-sr/Bf_13_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Bf_13" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_13-sr/Bf_13_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_13-sr/Bf_13_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Bf_13" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_13-sr/Bf_13_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_13-sr/Bf_13_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Bf_13" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_13-sr/Bf_13_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bf_13-sr/Bf_13_summary.txt
        fi
        
[Thu Nov 23 10:43:11 2023]
Finished job 742.
289 of 759 steps (38%) done
Select jobs to execute...
[Thu Nov 23 10:43:11 2023]
Finished job 112.
290 of 759 steps (38%) done

[Thu Nov 23 10:43:11 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_18_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_18.log
    jobid: 122
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Bu_18.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_18_S.subsampled.fastq.gz
    wildcards: sample=Bu_18
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_18_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_18.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:43:11 2023]
Finished job 301.
291 of 759 steps (38%) done
Select jobs to execute...
[Thu Nov 23 10:43:26 2023]
Finished job 122.
292 of 759 steps (38%) done

[Thu Nov 23 10:43:26 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_32_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Ecoli_32.log
    jobid: 36
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Ecoli_32.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/assembly_info.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_32_S.subsampled.fastq.gz
    wildcards: sample=Ecoli_32
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_32_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Ecoli_32.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:43:39 2023]
Finished job 221.
293 of 759 steps (39%) done
Select jobs to execute...

[Thu Nov 23 10:43:39 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_13-assembly-stats_flye.csv
    jobid: 364
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_13-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/checkv/quality_summary.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/assembly_result_table.csv
    wildcards: sample=Bf_13
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpzd516h8c.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:43:41 2023]
Finished job 364.
294 of 759 steps (39%) done
Select jobs to execute...

[Thu Nov 23 10:43:41 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_13-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_13-sr/Bf_13-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Bf_13.log
    jobid: 474
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_13-sr/Bf_13-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bf_13-assembly-stats_flye.csv
    wildcards: sample=Bf_13
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpktemd6li.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:43:42 2023]
Finished job 474.
295 of 759 steps (39%) done
Select jobs to execute...

[Thu Nov 23 10:43:42 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_13-sr/Bf_13-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_13-sr/Bf_13.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Bf_13.log
    jobid: 473
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_13-sr/Bf_13.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_13-sr/Bf_13-genome-candidates.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/assembly.fasta
    wildcards: sample=Bf_13
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_13-sr/Bf_13-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_13-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_13-sr/Bf_13.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_13-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bf_13-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_13-sr/Bf_13.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:43:42 2023]
Finished job 473.
296 of 759 steps (39%) done
Select jobs to execute...

[Thu Nov 23 10:43:42 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_13-sr/Bf_13.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_13-sr/Bf_13_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_13-sr/Bf_13_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Bf_13.log
    jobid: 600
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_13-sr/Bf_13_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_13-sr/Bf_13.fasta
    wildcards: sample=Bf_13
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpgf7e3abz.rename_genomes.py
[Thu Nov 23 10:43:42 2023]
Finished job 600.
297 of 759 steps (39%) done
Select jobs to execute...

[Thu Nov 23 10:43:42 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_13-sr/Bf_13_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/Bf_13.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/Bf_13_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/Bf_13_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/Bf_13_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/Bf_13_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/Bf_13_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_13.log
    jobid: 599
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/Bf_13.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/Bf_13_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/Bf_13_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/Bf_13_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/Bf_13_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/Bf_13_dnaapler_reoriented.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_13-sr/Bf_13_genome.fasta
    wildcards: sample=Bf_13
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_13-sr/Bf_13_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_13-sr/Bf_13_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bf_13                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_13.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/Bf_13_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_13-sr/Bf_13_genome.fasta -n Bf_13_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr -p Bf_13 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:43:43 2023]
Error in rule pharokka_flye:
    jobid: 599
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_13-sr/Bf_13_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/Bf_13.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/Bf_13_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/Bf_13_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/Bf_13_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/Bf_13_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/Bf_13_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_13.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_13-sr/Bf_13_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_13-sr/Bf_13_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bf_13                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_13.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr/Bf_13_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bf_13-sr/Bf_13_genome.fasta -n Bf_13_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bf_13-sr -p Bf_13 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bf_13.log not found.

Select jobs to execute...
[Thu Nov 23 10:43:45 2023]
Finished job 36.
298 of 759 steps (39%) done

[Thu Nov 23 10:43:45 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Ecoli_32.log
    jobid: 196
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Ecoli_32.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/assembly_info.txt
    wildcards: sample=Ecoli_32
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:43:45 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Ecoli_32.log
    jobid: 195
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Ecoli_32.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/assembly.fasta
    wildcards: sample=Ecoli_32
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Ecoli_32.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_

[Thu Nov 23 10:43:45 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Ecoli_32.log
    jobid: 288
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Ecoli_32.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/assembly.fasta
    wildcards: sample=Ecoli_32
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Ecoli_32.log
        fi
        
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_

[Thu Nov 23 10:43:45 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_32_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ecoli_32.log
    jobid: 99
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Ecoli_32.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_32_S.subsampled.fastq.gz
    wildcards: sample=Ecoli_32
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_32_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ecoli_32.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpebi_ctzq.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:43:46 2023]
Finished job 196.
299 of 759 steps (39%) done
Select jobs to execute...

[Thu Nov 23 10:43:46 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_32-sr/Ecoli_32_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Ecoli_32.log
    jobid: 729
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_32-sr/Ecoli_32_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/flye.log
    wildcards: sample=Ecoli_32
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_32-sr/Ecoli_32-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_32-sr/Ecoli_32-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/Ecoli_32_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/Ecoli_32_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_32-sr/Ecoli_32_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_32-sr/Ecoli_32.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_32-sr/Ecoli_32_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_32-sr/Ecoli_32.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/Ecoli_32_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_32-sr/Ecoli_32_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_32-sr/Ecoli_32-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_32-sr/Ecoli_32_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_32-sr/Ecoli_32-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_32-sr/Ecoli_32_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_32-sr/Ecoli_32-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_32-sr/Ecoli_32_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/Ecoli_32_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_32-sr/Ecoli_32_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_32-sr/Ecoli_32-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_32-sr/Ecoli_32_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_32-sr/Ecoli_32-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_32-sr/Ecoli_32_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_32-sr/Ecoli_32-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_32-sr/Ecoli_32_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/Ecoli_32_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_32-sr/Ecoli_32_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/Ecoli_32_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_32-sr/Ecoli_32_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/Ecoli_32_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_32-sr/Ecoli_32_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_32-sr/Ecoli_32_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_32-sr/Ecoli_32_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_32-sr/Ecoli_32_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_32-sr/Ecoli_32_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_32-sr/Ecoli_32_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_32-sr/Ecoli_32_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/Ecoli_32_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_32-sr/Ecoli_32_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_32-sr/Ecoli_32_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Ecoli_32" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_32-sr/Ecoli_32_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_32-sr/Ecoli_32_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Ecoli_32" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_32-sr/Ecoli_32_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_32-sr/Ecoli_32_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Ecoli_32" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_32-sr/Ecoli_32_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_32-sr/Ecoli_32_summary.txt
        fi
        
[Thu Nov 23 10:43:46 2023]
Finished job 729.
300 of 759 steps (40%) done
Select jobs to execute...
[Thu Nov 23 10:43:54 2023]
Finished job 241.
301 of 759 steps (40%) done

[Thu Nov 23 10:43:54 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bu_18-assembly-stats_flye.csv
    jobid: 374
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bu_18-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/checkv/quality_summary.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/graph_seq_details_flye.tsv
    wildcards: sample=Bu_18
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpz5fmzusu.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:43:55 2023]
Finished job 374.
302 of 759 steps (40%) done
Select jobs to execute...

[Thu Nov 23 10:43:55 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bu_18-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_18-sr/Bu_18-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Bu_18.log
    jobid: 494
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_18-sr/Bu_18-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bu_18-assembly-stats_flye.csv
    wildcards: sample=Bu_18
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp54exjd6o.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:43:56 2023]
Finished job 494.
303 of 759 steps (40%) done
Select jobs to execute...

[Thu Nov 23 10:43:56 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_18-sr/Bu_18-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_18-sr/Bu_18.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Bu_18.log
    jobid: 493
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_18-sr/Bu_18.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_18-sr/Bu_18-genome-candidates.csv
    wildcards: sample=Bu_18
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_18-sr/Bu_18-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_18-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_18-sr/Bu_18.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_18-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_18-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_18-sr/Bu_18.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:43:57 2023]
Finished job 493.
304 of 759 steps (40%) done
Select jobs to execute...

[Thu Nov 23 10:43:57 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_18-sr/Bu_18.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_18-sr/Bu_18_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_18-sr/Bu_18_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Bu_18.log
    jobid: 620
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_18-sr/Bu_18_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_18-sr/Bu_18.fasta
    wildcards: sample=Bu_18
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpi7u2aei4.rename_genomes.py
[Thu Nov 23 10:43:57 2023]
Finished job 620.
305 of 759 steps (40%) done
Select jobs to execute...

[Thu Nov 23 10:43:57 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_18-sr/Bu_18_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/Bu_18.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/Bu_18_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/Bu_18_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/Bu_18_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/Bu_18_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/Bu_18_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_18.log
    jobid: 619
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/Bu_18_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/Bu_18_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/Bu_18.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/Bu_18_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/Bu_18_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/Bu_18_length_gc_cds_density.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_18-sr/Bu_18_genome.fasta
    wildcards: sample=Bu_18
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_18-sr/Bu_18_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_18-sr/Bu_18_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bu_18                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_18.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/Bu_18_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_18-sr/Bu_18_genome.fasta -n Bu_18_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr -p Bu_18 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:43:57 2023]
Error in rule pharokka_flye:
    jobid: 619
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_18-sr/Bu_18_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/Bu_18.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/Bu_18_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/Bu_18_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/Bu_18_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/Bu_18_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/Bu_18_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_18.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_18-sr/Bu_18_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_18-sr/Bu_18_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bu_18                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_18.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr/Bu_18_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_18-sr/Bu_18_genome.fasta -n Bu_18_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_18-sr -p Bu_18 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_18.log not found.

Select jobs to execute...
[Thu Nov 23 10:43:58 2023]
Finished job 99.
306 of 759 steps (40%) done

[Thu Nov 23 10:43:58 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_12_2_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.CS-2_12_2.log
    jobid: 47
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.CS-2_12_2.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/assembly_info.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_12_2_S.subsampled.fastq.gz
    wildcards: sample=CS-2_12_2
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_12_2_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.CS-2_12_2.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:43:58 2023]
Finished job 288.
307 of 759 steps (40%) done
Select jobs to execute...
[Thu Nov 23 10:44:20 2023]
Finished job 47.
308 of 759 steps (41%) done

[Thu Nov 23 10:44:20 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.CS-2_12_2.log
    jobid: 299
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.CS-2_12_2.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/assembly.fasta
    wildcards: sample=CS-2_12_2
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.CS-2_12_2.log
        fi
        
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_

[Thu Nov 23 10:44:20 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.CS-2_12_2.log
    jobid: 217
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.CS-2_12_2.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/assembly.fasta
    wildcards: sample=CS-2_12_2
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.CS-2_12_2.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_

[Thu Nov 23 10:44:20 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.CS-2_12_2.log
    jobid: 218
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.CS-2_12_2.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/assembly_info.txt
    wildcards: sample=CS-2_12_2
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:44:20 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_12_2_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-2_12_2.log
    jobid: 110
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.CS-2_12_2.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_12_2_S.subsampled.fastq.gz
    wildcards: sample=CS-2_12_2
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_12_2_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-2_12_2.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/consensus.fasta
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpni3m6uhw.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:44:21 2023]
Finished job 218.
309 of 759 steps (41%) done
Select jobs to execute...

[Thu Nov 23 10:44:21 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12_2-sr/CS-2_12_2_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.CS-2_12_2.log
    jobid: 740
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12_2-sr/CS-2_12_2_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/flye.log
    wildcards: sample=CS-2_12_2
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12_2-sr/CS-2_12_2-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12_2-sr/CS-2_12_2-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/CS-2_12_2_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/CS-2_12_2_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12_2-sr/CS-2_12_2_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12_2-sr/CS-2_12_2.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12_2-sr/CS-2_12_2_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12_2-sr/CS-2_12_2.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/CS-2_12_2_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12_2-sr/CS-2_12_2_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12_2-sr/CS-2_12_2-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12_2-sr/CS-2_12_2_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12_2-sr/CS-2_12_2-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12_2-sr/CS-2_12_2_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12_2-sr/CS-2_12_2-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12_2-sr/CS-2_12_2_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/CS-2_12_2_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12_2-sr/CS-2_12_2_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12_2-sr/CS-2_12_2-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12_2-sr/CS-2_12_2_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12_2-sr/CS-2_12_2-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12_2-sr/CS-2_12_2_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12_2-sr/CS-2_12_2-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12_2-sr/CS-2_12_2_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/CS-2_12_2_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12_2-sr/CS-2_12_2_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/CS-2_12_2_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12_2-sr/CS-2_12_2_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/CS-2_12_2_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12_2-sr/CS-2_12_2_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12_2-sr/CS-2_12_2_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12_2-sr/CS-2_12_2_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12_2-sr/CS-2_12_2_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12_2-sr/CS-2_12_2_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12_2-sr/CS-2_12_2_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12_2-sr/CS-2_12_2_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/CS-2_12_2_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12_2-sr/CS-2_12_2_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12_2-sr/CS-2_12_2_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: CS-2_12_2" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12_2-sr/CS-2_12_2_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12_2-sr/CS-2_12_2_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: CS-2_12_2" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12_2-sr/CS-2_12_2_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12_2-sr/CS-2_12_2_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: CS-2_12_2" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12_2-sr/CS-2_12_2_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12_2-sr/CS-2_12_2_summary.txt
        fi
        
[Thu Nov 23 10:44:22 2023]
Finished job 740.
310 of 759 steps (41%) done
Select jobs to execute...
[Thu Nov 23 10:44:29 2023]
Finished job 195.
311 of 759 steps (41%) done

[Thu Nov 23 10:44:29 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_32-assembly-stats_flye.csv
    jobid: 351
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_32-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/checkv/quality_summary.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/assembly_result_table.csv
    wildcards: sample=Ecoli_32
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp7i1rnw0l.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:44:30 2023]
Finished job 351.
312 of 759 steps (41%) done
Select jobs to execute...

[Thu Nov 23 10:44:30 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_32-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_32-sr/Ecoli_32-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Ecoli_32.log
    jobid: 448
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_32-sr/Ecoli_32-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_32-assembly-stats_flye.csv
    wildcards: sample=Ecoli_32
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpbrnw9_0l.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:44:31 2023]
Finished job 110.
313 of 759 steps (41%) done
Select jobs to execute...

[Thu Nov 23 10:44:31 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_11_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.CS-2_11.log
    jobid: 20
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.CS-2_11.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/assembly.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_11_S.subsampled.fastq.gz
    wildcards: sample=CS-2_11
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_11_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.CS-2_11.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:44:31 2023]
Finished job 448.
314 of 759 steps (41%) done
Select jobs to execute...

[Thu Nov 23 10:44:31 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_32-sr/Ecoli_32-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_32-sr/Ecoli_32.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Ecoli_32.log
    jobid: 447
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_32-sr/Ecoli_32.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_32-sr/Ecoli_32-genome-candidates.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/assembly.fasta
    wildcards: sample=Ecoli_32
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_32-sr/Ecoli_32-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_32-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_32-sr/Ecoli_32.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_32-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_32-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_32-sr/Ecoli_32.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:44:31 2023]
Finished job 447.
315 of 759 steps (42%) done
Select jobs to execute...

[Thu Nov 23 10:44:31 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_32-sr/Ecoli_32.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_32-sr/Ecoli_32_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_32-sr/Ecoli_32_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Ecoli_32.log
    jobid: 574
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_32-sr/Ecoli_32_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_32-sr/Ecoli_32.fasta
    wildcards: sample=Ecoli_32
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpdafv76gk.rename_genomes.py
[Thu Nov 23 10:44:32 2023]
Finished job 574.
316 of 759 steps (42%) done
Select jobs to execute...

[Thu Nov 23 10:44:32 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_32-sr/Ecoli_32_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/Ecoli_32.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/Ecoli_32_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/Ecoli_32_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/Ecoli_32_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/Ecoli_32_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/Ecoli_32_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_32.log
    jobid: 573
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/Ecoli_32_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/Ecoli_32_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/Ecoli_32_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/Ecoli_32_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/Ecoli_32.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/Ecoli_32_dnaapler_reoriented.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_32-sr/Ecoli_32_genome.fasta
    wildcards: sample=Ecoli_32
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_32-sr/Ecoli_32_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_32-sr/Ecoli_32_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Ecoli_32                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_32.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/Ecoli_32_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_32-sr/Ecoli_32_genome.fasta -n Ecoli_32_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr -p Ecoli_32 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:44:32 2023]
Error in rule pharokka_flye:
    jobid: 573
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_32-sr/Ecoli_32_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/Ecoli_32.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/Ecoli_32_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/Ecoli_32_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/Ecoli_32_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/Ecoli_32_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/Ecoli_32_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_32.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_32-sr/Ecoli_32_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_32-sr/Ecoli_32_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Ecoli_32                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_32.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr/Ecoli_32_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_32-sr/Ecoli_32_genome.fasta -n Ecoli_32_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_32-sr -p Ecoli_32 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_32.log not found.

Select jobs to execute...
[Thu Nov 23 10:44:33 2023]
Finished job 299.
317 of 759 steps (42%) done
[Thu Nov 23 10:44:46 2023]
Finished job 20.
318 of 759 steps (42%) done

[Thu Nov 23 10:44:46 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_11_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-2_11.log
    jobid: 83
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.CS-2_11.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_11_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/assembly.fasta
    wildcards: sample=CS-2_11
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_11_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-2_11.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_

[Thu Nov 23 10:44:46 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.CS-2_11.log
    jobid: 164
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.CS-2_11.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/assembly.fasta
    wildcards: sample=CS-2_11
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:44:46 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.CS-2_11.log
    jobid: 272
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.CS-2_11.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/assembly.fasta
    wildcards: sample=CS-2_11
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.CS-2_11.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_

[Thu Nov 23 10:44:46 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.CS-2_11.log
    jobid: 163
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.CS-2_11.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/assembly.fasta
    wildcards: sample=CS-2_11
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.CS-2_11.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp4yh55gv2.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:44:47 2023]
Finished job 164.
319 of 759 steps (42%) done
Select jobs to execute...

[Thu Nov 23 10:44:47 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_11-sr/CS-2_11_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.CS-2_11.log
    jobid: 713
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_11-sr/CS-2_11_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/flye.log
    wildcards: sample=CS-2_11
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_11-sr/CS-2_11-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_11-sr/CS-2_11-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/CS-2_11_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/CS-2_11_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_11-sr/CS-2_11_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_11-sr/CS-2_11.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_11-sr/CS-2_11_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_11-sr/CS-2_11.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/CS-2_11_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_11-sr/CS-2_11_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_11-sr/CS-2_11-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_11-sr/CS-2_11_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_11-sr/CS-2_11-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_11-sr/CS-2_11_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_11-sr/CS-2_11-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_11-sr/CS-2_11_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/CS-2_11_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_11-sr/CS-2_11_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_11-sr/CS-2_11-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_11-sr/CS-2_11_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_11-sr/CS-2_11-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_11-sr/CS-2_11_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_11-sr/CS-2_11-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_11-sr/CS-2_11_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/CS-2_11_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_11-sr/CS-2_11_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/CS-2_11_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_11-sr/CS-2_11_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/CS-2_11_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_11-sr/CS-2_11_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_11-sr/CS-2_11_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_11-sr/CS-2_11_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_11-sr/CS-2_11_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_11-sr/CS-2_11_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_11-sr/CS-2_11_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_11-sr/CS-2_11_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/CS-2_11_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_11-sr/CS-2_11_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_11-sr/CS-2_11_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: CS-2_11" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_11-sr/CS-2_11_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_11-sr/CS-2_11_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: CS-2_11" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_11-sr/CS-2_11_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_11-sr/CS-2_11_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: CS-2_11" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_11-sr/CS-2_11_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_11-sr/CS-2_11_summary.txt
        fi
        
[Thu Nov 23 10:44:47 2023]
Finished job 713.
320 of 759 steps (42%) done
Select jobs to execute...
[Thu Nov 23 10:44:56 2023]
Finished job 83.
321 of 759 steps (42%) done

[Thu Nov 23 10:44:56 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_36_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Ecoli_36.log
    jobid: 46
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Ecoli_36.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/assembly_graph.gfa; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_36_S.subsampled.fastq.gz
    wildcards: sample=Ecoli_36
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_36_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Ecoli_36.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:44:58 2023]
Finished job 272.
322 of 759 steps (42%) done
Select jobs to execute...
[Thu Nov 23 10:45:02 2023]
Finished job 217.
323 of 759 steps (43%) done

[Thu Nov 23 10:45:02 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/CS-2_12_2-assembly-stats_flye.csv
    jobid: 362
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/CS-2_12_2-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/checkv/quality_summary.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/graph_seq_details_flye.tsv
    wildcards: sample=CS-2_12_2
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpyym5grjr.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:45:03 2023]
Finished job 362.
324 of 759 steps (43%) done
Select jobs to execute...

[Thu Nov 23 10:45:03 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/CS-2_12_2-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12_2-sr/CS-2_12_2-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.CS-2_12_2.log
    jobid: 470
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12_2-sr/CS-2_12_2-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/CS-2_12_2-assembly-stats_flye.csv
    wildcards: sample=CS-2_12_2
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpik2i4jb6.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:45:04 2023]
Finished job 46.
325 of 759 steps (43%) done
Select jobs to execute...

[Thu Nov 23 10:45:04 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_36-sr/Ecoli_36_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Ecoli_36.log
    jobid: 739
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_36-sr/Ecoli_36_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/flye.log
    wildcards: sample=Ecoli_36
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_36-sr/Ecoli_36-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_36-sr/Ecoli_36-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/Ecoli_36_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/Ecoli_36_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_36-sr/Ecoli_36_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_36-sr/Ecoli_36.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_36-sr/Ecoli_36_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_36-sr/Ecoli_36.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/Ecoli_36_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_36-sr/Ecoli_36_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_36-sr/Ecoli_36-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_36-sr/Ecoli_36_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_36-sr/Ecoli_36-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_36-sr/Ecoli_36_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_36-sr/Ecoli_36-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_36-sr/Ecoli_36_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/Ecoli_36_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_36-sr/Ecoli_36_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_36-sr/Ecoli_36-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_36-sr/Ecoli_36_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_36-sr/Ecoli_36-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_36-sr/Ecoli_36_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_36-sr/Ecoli_36-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_36-sr/Ecoli_36_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/Ecoli_36_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_36-sr/Ecoli_36_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/Ecoli_36_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_36-sr/Ecoli_36_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/Ecoli_36_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_36-sr/Ecoli_36_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_36-sr/Ecoli_36_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_36-sr/Ecoli_36_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_36-sr/Ecoli_36_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_36-sr/Ecoli_36_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_36-sr/Ecoli_36_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_36-sr/Ecoli_36_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/Ecoli_36_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_36-sr/Ecoli_36_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_36-sr/Ecoli_36_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Ecoli_36" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_36-sr/Ecoli_36_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_36-sr/Ecoli_36_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Ecoli_36" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_36-sr/Ecoli_36_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_36-sr/Ecoli_36_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Ecoli_36" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_36-sr/Ecoli_36_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_36-sr/Ecoli_36_summary.txt
        fi
        

[Thu Nov 23 10:45:04 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Ecoli_36.log
    jobid: 216
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Ecoli_36.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/assembly_graph.gfa
    wildcards: sample=Ecoli_36
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:45:04 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_36_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ecoli_36.log
    jobid: 109
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Ecoli_36.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_36_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/assembly.fasta
    wildcards: sample=Ecoli_36
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_36_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ecoli_36.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/consensus.fasta
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_

[Thu Nov 23 10:45:04 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Ecoli_36.log
    jobid: 215
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Ecoli_36.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/assembly.fasta
    wildcards: sample=Ecoli_36
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Ecoli_36.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_
[Thu Nov 23 10:45:04 2023]
Finished job 739.
326 of 759 steps (43%) done
Select jobs to execute...
[Thu Nov 23 10:45:04 2023]
Finished job 470.
327 of 759 steps (43%) done

[Thu Nov 23 10:45:04 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Ecoli_36.log
    jobid: 298
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Ecoli_36.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/assembly.fasta
    wildcards: sample=Ecoli_36
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Ecoli_36.log
        fi
        
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpdge5o95m.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:45:05 2023]
Finished job 216.
328 of 759 steps (43%) done
Select jobs to execute...

[Thu Nov 23 10:45:05 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12_2-sr/CS-2_12_2-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12_2-sr/CS-2_12_2.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.CS-2_12_2.log
    jobid: 469
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12_2-sr/CS-2_12_2.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12_2-sr/CS-2_12_2-genome-candidates.csv
    wildcards: sample=CS-2_12_2
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12_2-sr/CS-2_12_2-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12_2-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12_2-sr/CS-2_12_2.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12_2-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12_2-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12_2-sr/CS-2_12_2.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:45:05 2023]
Finished job 469.
329 of 759 steps (43%) done
Select jobs to execute...

[Thu Nov 23 10:45:05 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12_2-sr/CS-2_12_2.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12_2-sr/CS-2_12_2_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12_2-sr/CS-2_12_2_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.CS-2_12_2.log
    jobid: 596
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12_2-sr/CS-2_12_2_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12_2-sr/CS-2_12_2.fasta
    wildcards: sample=CS-2_12_2
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpz1rgw7nu.rename_genomes.py
[Thu Nov 23 10:45:06 2023]
Finished job 596.
330 of 759 steps (43%) done
Select jobs to execute...

[Thu Nov 23 10:45:06 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12_2-sr/CS-2_12_2_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/CS-2_12_2.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/CS-2_12_2_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/CS-2_12_2_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/CS-2_12_2_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/CS-2_12_2_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/CS-2_12_2_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.CS-2_12_2.log
    jobid: 595
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/CS-2_12_2_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/CS-2_12_2_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/CS-2_12_2.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/CS-2_12_2_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/CS-2_12_2_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/CS-2_12_2_dnaapler_reoriented.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12_2-sr/CS-2_12_2_genome.fasta
    wildcards: sample=CS-2_12_2
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12_2-sr/CS-2_12_2_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12_2-sr/CS-2_12_2_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p CS-2_12_2                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.CS-2_12_2.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/CS-2_12_2_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12_2-sr/CS-2_12_2_genome.fasta -n CS-2_12_2_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr -p CS-2_12_2 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:45:06 2023]
Error in rule pharokka_flye:
    jobid: 595
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12_2-sr/CS-2_12_2_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/CS-2_12_2.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/CS-2_12_2_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/CS-2_12_2_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/CS-2_12_2_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/CS-2_12_2_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/CS-2_12_2_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.CS-2_12_2.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12_2-sr/CS-2_12_2_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12_2-sr/CS-2_12_2_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p CS-2_12_2                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.CS-2_12_2.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr/CS-2_12_2_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12_2-sr/CS-2_12_2_genome.fasta -n CS-2_12_2_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12_2-sr -p CS-2_12_2 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.CS-2_12_2.log not found.

Select jobs to execute...
[Thu Nov 23 10:45:14 2023]
Finished job 109.
331 of 759 steps (44%) done

[Thu Nov 23 10:45:14 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_4_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Eu_4.log
    jobid: 14
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Eu_4.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/assembly_graph.gfa; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_4_S.subsampled.fastq.gz
    wildcards: sample=Eu_4
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_4_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Eu_4.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:45:17 2023]
Finished job 14.
332 of 759 steps (44%) done
Select jobs to execute...

[Thu Nov 23 10:45:17 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_4_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Eu_4.log
    jobid: 77
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Eu_4.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_4_S.subsampled.fastq.gz
    wildcards: sample=Eu_4
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_4_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Eu_4.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_

[Thu Nov 23 10:45:17 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Eu_4.log
    jobid: 151
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Eu_4.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/assembly.fasta
    wildcards: sample=Eu_4
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Eu_4.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_
[Thu Nov 23 10:45:17 2023]
Finished job 298.
333 of 759 steps (44%) done
Select jobs to execute...

[Thu Nov 23 10:45:17 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_4-sr/Eu_4_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Eu_4.log
    jobid: 707
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_4-sr/Eu_4_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/flye.log
    wildcards: sample=Eu_4
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_4-sr/Eu_4-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_4-sr/Eu_4-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/Eu_4_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/Eu_4_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_4-sr/Eu_4_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_4-sr/Eu_4.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_4-sr/Eu_4_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_4-sr/Eu_4.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/Eu_4_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_4-sr/Eu_4_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_4-sr/Eu_4-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_4-sr/Eu_4_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_4-sr/Eu_4-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_4-sr/Eu_4_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_4-sr/Eu_4-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_4-sr/Eu_4_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/Eu_4_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_4-sr/Eu_4_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_4-sr/Eu_4-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_4-sr/Eu_4_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_4-sr/Eu_4-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_4-sr/Eu_4_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_4-sr/Eu_4-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_4-sr/Eu_4_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/Eu_4_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_4-sr/Eu_4_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/Eu_4_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_4-sr/Eu_4_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/Eu_4_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_4-sr/Eu_4_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_4-sr/Eu_4_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_4-sr/Eu_4_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_4-sr/Eu_4_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_4-sr/Eu_4_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_4-sr/Eu_4_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_4-sr/Eu_4_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/Eu_4_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_4-sr/Eu_4_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_4-sr/Eu_4_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Eu_4" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_4-sr/Eu_4_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_4-sr/Eu_4_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Eu_4" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_4-sr/Eu_4_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_4-sr/Eu_4_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Eu_4" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_4-sr/Eu_4_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_4-sr/Eu_4_summary.txt
        fi
        
[Thu Nov 23 10:45:17 2023]
Finished job 707.
334 of 759 steps (44%) done
Select jobs to execute...

[Thu Nov 23 10:45:17 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Eu_4.log
    jobid: 152
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Eu_4.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/assembly_graph.gfa
    wildcards: sample=Eu_4
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpcna99xkv.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:45:18 2023]
Finished job 152.
335 of 759 steps (44%) done
Select jobs to execute...

[Thu Nov 23 10:45:18 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Eu_4.log
    jobid: 266
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Eu_4.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/assembly.fasta
    wildcards: sample=Eu_4
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Eu_4.log
        fi
        
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_
[Thu Nov 23 10:45:27 2023]
Finished job 163.
336 of 759 steps (44%) done
Select jobs to execute...

[Thu Nov 23 10:45:27 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/CS-2_11-assembly-stats_flye.csv
    jobid: 335
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/CS-2_11-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/checkv/quality_summary.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/assembly_result_table.csv
    wildcards: sample=CS-2_11
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpvbkanvke.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:45:29 2023]
Finished job 335.
337 of 759 steps (44%) done
Select jobs to execute...

[Thu Nov 23 10:45:29 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/CS-2_11-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_11-sr/CS-2_11-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.CS-2_11.log
    jobid: 416
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_11-sr/CS-2_11-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/CS-2_11-assembly-stats_flye.csv
    wildcards: sample=CS-2_11
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp8likd3g6.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:45:30 2023]
Finished job 266.
338 of 759 steps (45%) done
Select jobs to execute...
[Thu Nov 23 10:45:30 2023]
Finished job 416.
339 of 759 steps (45%) done

[Thu Nov 23 10:45:30 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_11-sr/CS-2_11-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_11-sr/CS-2_11.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.CS-2_11.log
    jobid: 415
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_11-sr/CS-2_11.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_11-sr/CS-2_11-genome-candidates.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/assembly.fasta
    wildcards: sample=CS-2_11
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_11-sr/CS-2_11-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_11-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_11-sr/CS-2_11.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_11-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_11-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_11-sr/CS-2_11.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:45:30 2023]
Finished job 415.
340 of 759 steps (45%) done
Select jobs to execute...

[Thu Nov 23 10:45:30 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_11-sr/CS-2_11.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_11-sr/CS-2_11_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_11-sr/CS-2_11_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.CS-2_11.log
    jobid: 542
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_11-sr/CS-2_11_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_11-sr/CS-2_11.fasta
    wildcards: sample=CS-2_11
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpuoit24r3.rename_genomes.py
[Thu Nov 23 10:45:31 2023]
Finished job 542.
341 of 759 steps (45%) done
Select jobs to execute...

[Thu Nov 23 10:45:31 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_11-sr/CS-2_11_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/CS-2_11.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/CS-2_11_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/CS-2_11_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/CS-2_11_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/CS-2_11_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/CS-2_11_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.CS-2_11.log
    jobid: 541
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/CS-2_11_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/CS-2_11_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/CS-2_11_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/CS-2_11_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/CS-2_11.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/CS-2_11_dnaapler_reoriented.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_11-sr/CS-2_11_genome.fasta
    wildcards: sample=CS-2_11
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_11-sr/CS-2_11_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_11-sr/CS-2_11_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p CS-2_11                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.CS-2_11.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/CS-2_11_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_11-sr/CS-2_11_genome.fasta -n CS-2_11_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr -p CS-2_11 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:45:31 2023]
Error in rule pharokka_flye:
    jobid: 541
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_11-sr/CS-2_11_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/CS-2_11.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/CS-2_11_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/CS-2_11_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/CS-2_11_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/CS-2_11_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/CS-2_11_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.CS-2_11.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_11-sr/CS-2_11_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_11-sr/CS-2_11_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p CS-2_11                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.CS-2_11.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr/CS-2_11_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_11-sr/CS-2_11_genome.fasta -n CS-2_11_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_11-sr -p CS-2_11 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.CS-2_11.log not found.

Select jobs to execute...
[Thu Nov 23 10:45:38 2023]
Finished job 77.
342 of 759 steps (45%) done

[Thu Nov 23 10:45:38 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_07_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bu_07.log
    jobid: 12
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Bu_07.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/assembly_info.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_07_S.subsampled.fastq.gz
    wildcards: sample=Bu_07
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_07_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bu_07.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:45:46 2023]
Finished job 12.
343 of 759 steps (45%) done
Select jobs to execute...

[Thu Nov 23 10:45:46 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Bu_07.log
    jobid: 148
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Bu_07.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/assembly_graph.gfa
    wildcards: sample=Bu_07
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:45:46 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_07_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_07.log
    jobid: 75
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Bu_07.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_07_S.subsampled.fastq.gz
    wildcards: sample=Bu_07
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_07_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_07.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
[Thu Nov 23 10:45:46 2023]
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bu_07.log
    jobid: 147
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Bu_07.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/assembly.fasta
    wildcards: sample=Bu_07
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bu_07.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpto1jl_i7.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:45:47 2023]
Finished job 148.
344 of 759 steps (45%) done
Select jobs to execute...

[Thu Nov 23 10:45:47 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bu_07.log
    jobid: 264
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Bu_07.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/assembly.fasta
    wildcards: sample=Bu_07
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bu_07.log
        fi
        
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_
[Thu Nov 23 10:45:48 2023]
Finished job 215.
345 of 759 steps (45%) done
Select jobs to execute...

[Thu Nov 23 10:45:48 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_07-sr/Bu_07_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Bu_07.log
    jobid: 705
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_07-sr/Bu_07_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/flye.log
    wildcards: sample=Bu_07
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_07-sr/Bu_07-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_07-sr/Bu_07-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/Bu_07_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/Bu_07_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_07-sr/Bu_07_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_07-sr/Bu_07.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_07-sr/Bu_07_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_07-sr/Bu_07.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/Bu_07_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_07-sr/Bu_07_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_07-sr/Bu_07-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_07-sr/Bu_07_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_07-sr/Bu_07-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_07-sr/Bu_07_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_07-sr/Bu_07-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_07-sr/Bu_07_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/Bu_07_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_07-sr/Bu_07_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_07-sr/Bu_07-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_07-sr/Bu_07_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_07-sr/Bu_07-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_07-sr/Bu_07_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_07-sr/Bu_07-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_07-sr/Bu_07_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/Bu_07_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_07-sr/Bu_07_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/Bu_07_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_07-sr/Bu_07_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/Bu_07_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_07-sr/Bu_07_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_07-sr/Bu_07_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_07-sr/Bu_07_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_07-sr/Bu_07_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_07-sr/Bu_07_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_07-sr/Bu_07_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_07-sr/Bu_07_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/Bu_07_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_07-sr/Bu_07_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_07-sr/Bu_07_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Bu_07" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_07-sr/Bu_07_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_07-sr/Bu_07_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Bu_07" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_07-sr/Bu_07_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_07-sr/Bu_07_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Bu_07" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_07-sr/Bu_07_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_07-sr/Bu_07_summary.txt
        fi
        

[Thu Nov 23 10:45:48 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_36-assembly-stats_flye.csv
    jobid: 361
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_36-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/checkv/quality_summary.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/graph_seq_details_flye.tsv
    wildcards: sample=Ecoli_36
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:45:48 2023]
Finished job 705.
346 of 759 steps (46%) done
Select jobs to execute...
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpuo25rgoy.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:45:49 2023]
Finished job 361.
347 of 759 steps (46%) done

[Thu Nov 23 10:45:49 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_36-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_36-sr/Ecoli_36-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Ecoli_36.log
    jobid: 468
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_36-sr/Ecoli_36-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_36-assembly-stats_flye.csv
    wildcards: sample=Ecoli_36
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpjfoj_h5j.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:45:50 2023]
Finished job 468.
348 of 759 steps (46%) done
Select jobs to execute...

[Thu Nov 23 10:45:50 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_36-sr/Ecoli_36-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_36-sr/Ecoli_36.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Ecoli_36.log
    jobid: 467
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_36-sr/Ecoli_36.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_36-sr/Ecoli_36-genome-candidates.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/assembly.fasta
    wildcards: sample=Ecoli_36
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_36-sr/Ecoli_36-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_36-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_36-sr/Ecoli_36.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_36-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_36-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_36-sr/Ecoli_36.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:45:50 2023]
Finished job 467.
349 of 759 steps (46%) done
Select jobs to execute...

[Thu Nov 23 10:45:50 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_36-sr/Ecoli_36.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_36-sr/Ecoli_36_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_36-sr/Ecoli_36_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Ecoli_36.log
    jobid: 594
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_36-sr/Ecoli_36_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_36-sr/Ecoli_36.fasta
    wildcards: sample=Ecoli_36
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpzaejx4di.rename_genomes.py
[Thu Nov 23 10:45:51 2023]
Finished job 594.
350 of 759 steps (46%) done
Select jobs to execute...

[Thu Nov 23 10:45:51 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_36-sr/Ecoli_36_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/Ecoli_36.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/Ecoli_36_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/Ecoli_36_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/Ecoli_36_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/Ecoli_36_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/Ecoli_36_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_36.log
    jobid: 593
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/Ecoli_36_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/Ecoli_36_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/Ecoli_36_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/Ecoli_36_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/Ecoli_36_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/Ecoli_36.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/top_hits_vfdb.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_36-sr/Ecoli_36_genome.fasta
    wildcards: sample=Ecoli_36
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_36-sr/Ecoli_36_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_36-sr/Ecoli_36_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Ecoli_36                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_36.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/Ecoli_36_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_36-sr/Ecoli_36_genome.fasta -n Ecoli_36_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr -p Ecoli_36 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:45:51 2023]
Error in rule pharokka_flye:
    jobid: 593
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_36-sr/Ecoli_36_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/Ecoli_36.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/Ecoli_36_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/Ecoli_36_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/Ecoli_36_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/Ecoli_36_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/Ecoli_36_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_36.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_36-sr/Ecoli_36_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_36-sr/Ecoli_36_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Ecoli_36                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_36.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr/Ecoli_36_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_36-sr/Ecoli_36_genome.fasta -n Ecoli_36_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_36-sr -p Ecoli_36 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_36.log not found.

Select jobs to execute...
[Thu Nov 23 10:45:54 2023]
Finished job 151.
351 of 759 steps (46%) done

[Thu Nov 23 10:45:54 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Eu_4-assembly-stats_flye.csv
    jobid: 329
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Eu_4-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/checkv/quality_summary.tsv
    wildcards: sample=Eu_4
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp3ea67xp6.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:45:55 2023]
Finished job 329.
352 of 759 steps (46%) done
Select jobs to execute...

[Thu Nov 23 10:45:55 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Eu_4-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_4-sr/Eu_4-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Eu_4.log
    jobid: 404
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_4-sr/Eu_4-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Eu_4-assembly-stats_flye.csv
    wildcards: sample=Eu_4
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpypbs3ntm.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:45:56 2023]
Finished job 404.
353 of 759 steps (47%) done
Select jobs to execute...

[Thu Nov 23 10:45:56 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_4-sr/Eu_4-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_4-sr/Eu_4.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Eu_4.log
    jobid: 403
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_4-sr/Eu_4.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_4-sr/Eu_4-genome-candidates.csv
    wildcards: sample=Eu_4
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_4-sr/Eu_4-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_4-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_4-sr/Eu_4.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_4-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_4-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_4-sr/Eu_4.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:45:56 2023]
Finished job 403.
354 of 759 steps (47%) done
Select jobs to execute...

[Thu Nov 23 10:45:56 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_4-sr/Eu_4.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_4-sr/Eu_4_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_4-sr/Eu_4_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Eu_4.log
    jobid: 530
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_4-sr/Eu_4_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_4-sr/Eu_4.fasta
    wildcards: sample=Eu_4
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp4ykal882.rename_genomes.py
[Thu Nov 23 10:45:57 2023]
Finished job 530.
355 of 759 steps (47%) done
Select jobs to execute...

[Thu Nov 23 10:45:57 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_4-sr/Eu_4_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/Eu_4.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/Eu_4_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/Eu_4_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/Eu_4_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/Eu_4_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/Eu_4_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Eu_4.log
    jobid: 529
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/Eu_4_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/Eu_4_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/Eu_4_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/Eu_4_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/Eu_4_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/Eu_4.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/top_hits_vfdb.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_4-sr/Eu_4_genome.fasta
    wildcards: sample=Eu_4
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_4-sr/Eu_4_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_4-sr/Eu_4_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Eu_4                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Eu_4.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/Eu_4_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_4-sr/Eu_4_genome.fasta -n Eu_4_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr -p Eu_4 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:45:57 2023]
Error in rule pharokka_flye:
    jobid: 529
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_4-sr/Eu_4_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/Eu_4.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/Eu_4_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/Eu_4_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/Eu_4_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/Eu_4_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/Eu_4_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Eu_4.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_4-sr/Eu_4_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_4-sr/Eu_4_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Eu_4                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Eu_4.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr/Eu_4_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_4-sr/Eu_4_genome.fasta -n Eu_4_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_4-sr -p Eu_4 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Eu_4.log not found.

Select jobs to execute...
[Thu Nov 23 10:45:59 2023]
Finished job 264.
356 of 759 steps (47%) done
[Thu Nov 23 10:46:26 2023]
Finished job 75.
357 of 759 steps (47%) done

[Thu Nov 23 10:46:26 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_6_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Eu_6.log
    jobid: 38
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Eu_6.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly_info.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_6_S.subsampled.fastq.gz
    wildcards: sample=Eu_6
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_6_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Eu_6.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:46:27 2023]
Finished job 147.
358 of 759 steps (47%) done
Select jobs to execute...

[Thu Nov 23 10:46:27 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bs_13_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bs_13.log
    jobid: 9
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Bs_13.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/flye.log; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bs_13_S.subsampled.fastq.gz
    wildcards: sample=Bs_13
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bs_13_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bs_13.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:46:28 2023]
Finished job 38.
359 of 759 steps (47%) done
Select jobs to execute...

[Thu Nov 23 10:46:28 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_6-sr/Eu_6_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Eu_6.log
    jobid: 731
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_6-sr/Eu_6_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/flye.log
    wildcards: sample=Eu_6
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_6-sr/Eu_6-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_6-sr/Eu_6-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_6-sr/Eu_6_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_6-sr/Eu_6_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_6-sr/Eu_6_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_6-sr/Eu_6.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_6-sr/Eu_6_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_6-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_6-sr/Eu_6.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_6-sr/Eu_6_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_6-sr/Eu_6_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_6-sr/Eu_6-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_6-sr/Eu_6_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_6-sr/Eu_6-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_6-sr/Eu_6_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_6-sr/Eu_6-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_6-sr/Eu_6_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_6-sr/Eu_6_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_6-sr/Eu_6_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_6-sr/Eu_6-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_6-sr/Eu_6_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_6-sr/Eu_6-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_6-sr/Eu_6_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Eu_6-sr/Eu_6-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_6-sr/Eu_6_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_6-sr/Eu_6_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_6-sr/Eu_6_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_6-sr/Eu_6_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_6-sr/Eu_6_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_6-sr/Eu_6_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_6-sr/Eu_6_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_6-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_6-sr/Eu_6_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_6-sr/Eu_6_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_6-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_6-sr/Eu_6_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_6-sr/Eu_6_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_6-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_6-sr/Eu_6_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_6-sr/Eu_6_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Eu_6-sr/Eu_6_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_6-sr/Eu_6_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_6-sr/Eu_6_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Eu_6" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_6-sr/Eu_6_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_6-sr/Eu_6_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Eu_6" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_6-sr/Eu_6_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_6-sr/Eu_6_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Eu_6" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_6-sr/Eu_6_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Eu_6-sr/Eu_6_summary.txt
        fi
        

[Thu Nov 23 10:46:28 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bu_07-assembly-stats_flye.csv
    jobid: 327
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bu_07-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/checkv/quality_summary.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/graph_seq_details_flye.tsv
    wildcards: sample=Bu_07
    resources: tmpdir=/local/nala0006/2279907

[Thu Nov 23 10:46:28 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Eu_6.log
    jobid: 199
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Eu_6.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly.fasta
    wildcards: sample=Eu_6
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Eu_6.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_

[Thu Nov 23 10:46:28 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Eu_6.log
    jobid: 290
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Eu_6.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly.fasta
    wildcards: sample=Eu_6
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Eu_6.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_

[Thu Nov 23 10:46:28 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Eu_6.log
    jobid: 200
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Eu_6.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly_info.txt
    wildcards: sample=Eu_6
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:46:28 2023]
Finished job 731.
360 of 759 steps (47%) done
Select jobs to execute...
Waiting at most 5 seconds for missing files.
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpue807kc_.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpgg6f9aew.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
MissingOutputException in rule viralverify_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.viralverify.smk, line 37:
Job 199  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly_result_table.csv
Waiting at most 5 seconds for missing files.
MissingOutputException in rule checkv_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.checkv.smk, line 38:
Job 290  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/checkv/quality_summary.tsv
[Thu Nov 23 10:46:38 2023]
Finished job 200.
361 of 759 steps (48%) done
[Thu Nov 23 10:46:38 2023]
Finished job 327.
362 of 759 steps (48%) done
[Thu Nov 23 10:46:38 2023]
Finished job 9.
363 of 759 steps (48%) done

[Thu Nov 23 10:46:38 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bs_13-sr/Bs_13_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Bs_13.log
    jobid: 702
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bs_13-sr/Bs_13_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/flye.log
    wildcards: sample=Bs_13
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bs_13-sr/Bs_13-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bs_13-sr/Bs_13-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/Bs_13_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/Bs_13_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bs_13-sr/Bs_13_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bs_13-sr/Bs_13.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bs_13-sr/Bs_13_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bs_13-sr/Bs_13.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/Bs_13_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bs_13-sr/Bs_13_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bs_13-sr/Bs_13-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bs_13-sr/Bs_13_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bs_13-sr/Bs_13-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bs_13-sr/Bs_13_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bs_13-sr/Bs_13-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bs_13-sr/Bs_13_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/Bs_13_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bs_13-sr/Bs_13_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bs_13-sr/Bs_13-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bs_13-sr/Bs_13_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bs_13-sr/Bs_13-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bs_13-sr/Bs_13_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bs_13-sr/Bs_13-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bs_13-sr/Bs_13_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/Bs_13_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bs_13-sr/Bs_13_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/Bs_13_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bs_13-sr/Bs_13_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/Bs_13_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bs_13-sr/Bs_13_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bs_13-sr/Bs_13_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bs_13-sr/Bs_13_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bs_13-sr/Bs_13_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bs_13-sr/Bs_13_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bs_13-sr/Bs_13_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bs_13-sr/Bs_13_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/Bs_13_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bs_13-sr/Bs_13_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bs_13-sr/Bs_13_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Bs_13" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bs_13-sr/Bs_13_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bs_13-sr/Bs_13_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Bs_13" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bs_13-sr/Bs_13_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bs_13-sr/Bs_13_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Bs_13" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bs_13-sr/Bs_13_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bs_13-sr/Bs_13_summary.txt
        fi
        

[Thu Nov 23 10:46:38 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bu_07-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_07-sr/Bu_07-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Bu_07.log
    jobid: 400
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_07-sr/Bu_07-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bu_07-assembly-stats_flye.csv
    wildcards: sample=Bu_07
    resources: tmpdir=/local/nala0006/2279907

[Thu Nov 23 10:46:38 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bs_13.log
    jobid: 141
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Bs_13.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/assembly.fasta
    wildcards: sample=Bs_13
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bs_13.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_

[Thu Nov 23 10:46:38 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_6_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Eu_6.log
    jobid: 101
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Eu_6.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_6_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly.fasta
    wildcards: sample=Eu_6
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_6_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Eu_6.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_

[Thu Nov 23 10:46:38 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bs_13.log
    jobid: 261
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Bs_13.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/assembly.fasta
    wildcards: sample=Bs_13
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bs_13.log
        fi
        
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_

[Thu Nov 23 10:46:38 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Bs_13.log
    jobid: 142
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Bs_13.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/assembly_info.txt
    wildcards: sample=Bs_13
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:46:38 2023]
Finished job 702.
364 of 759 steps (48%) done
Select jobs to execute...
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpr4qqq96f.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmprtbga4bf.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:46:39 2023]
Finished job 142.
365 of 759 steps (48%) done
[Thu Nov 23 10:46:39 2023]
Finished job 400.
366 of 759 steps (48%) done

[Thu Nov 23 10:46:39 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_07-sr/Bu_07-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_07-sr/Bu_07.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Bu_07.log
    jobid: 399
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_07-sr/Bu_07.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_07-sr/Bu_07-genome-candidates.csv
    wildcards: sample=Bu_07
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_07-sr/Bu_07-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_07-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_07-sr/Bu_07.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_07-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_07-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_07-sr/Bu_07.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:46:40 2023]
Finished job 399.
367 of 759 steps (48%) done
Select jobs to execute...

[Thu Nov 23 10:46:40 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_07-sr/Bu_07.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_07-sr/Bu_07_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_07-sr/Bu_07_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Bu_07.log
    jobid: 526
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_07-sr/Bu_07_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_07-sr/Bu_07.fasta
    wildcards: sample=Bu_07
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp8dy6cbef.rename_genomes.py
[Thu Nov 23 10:46:40 2023]
Finished job 526.
368 of 759 steps (48%) done
Select jobs to execute...

[Thu Nov 23 10:46:40 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_07-sr/Bu_07_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/Bu_07.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/Bu_07_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/Bu_07_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/Bu_07_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/Bu_07_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/Bu_07_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_07.log
    jobid: 525
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/Bu_07_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/Bu_07_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/Bu_07_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/Bu_07.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/Bu_07_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/Bu_07_top_hits_mash_inphared.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_07-sr/Bu_07_genome.fasta
    wildcards: sample=Bu_07
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_07-sr/Bu_07_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_07-sr/Bu_07_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bu_07                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_07.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/Bu_07_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_07-sr/Bu_07_genome.fasta -n Bu_07_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr -p Bu_07 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:46:40 2023]
Error in rule pharokka_flye:
    jobid: 525
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_07-sr/Bu_07_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/Bu_07.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/Bu_07_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/Bu_07_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/Bu_07_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/Bu_07_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/Bu_07_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_07.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_07-sr/Bu_07_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_07-sr/Bu_07_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bu_07                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_07.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr/Bu_07_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_07-sr/Bu_07_genome.fasta -n Bu_07_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_07-sr -p Bu_07 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_07.log not found.

Select jobs to execute...
[Thu Nov 23 10:46:41 2023]
Error in rule medaka:
    jobid: 101
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_6_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Eu_6.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Eu_6_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Eu_6.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/consensus.fasta
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Eu_6.log:
================================================================================
[10:46:40 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmpuud4c8wz.
[10:46:41 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmpnrvvn2qf.
Creating fai index file /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly.fasta.fai
[faidx] Could not build fai index /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Eu_6-sr/assembly.fasta.fai
================================================================================


[Thu Nov 23 10:46:41 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bs_13_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bs_13.log
    jobid: 72
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Bs_13.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bs_13_S.subsampled.fastq.gz
    wildcards: sample=Bs_13
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bs_13_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bs_13.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:46:50 2023]
Finished job 261.
369 of 759 steps (49%) done
Select jobs to execute...
[Thu Nov 23 10:46:57 2023]
Finished job 72.
370 of 759 steps (49%) done

[Thu Nov 23 10:46:57 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_28_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Ecoli_28.log
    jobid: 3
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Ecoli_28.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/assembly_graph.gfa; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_28_S.subsampled.fastq.gz
    wildcards: sample=Ecoli_28
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_28_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Ecoli_28.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:46:59 2023]
Finished job 3.
371 of 759 steps (49%) done
Select jobs to execute...

[Thu Nov 23 10:46:59 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_28-sr/Ecoli_28_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Ecoli_28.log
    jobid: 696
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_28-sr/Ecoli_28_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/flye.log
    wildcards: sample=Ecoli_28
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_28-sr/Ecoli_28-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_28-sr/Ecoli_28-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/Ecoli_28_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/Ecoli_28_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_28-sr/Ecoli_28_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_28-sr/Ecoli_28.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_28-sr/Ecoli_28_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_28-sr/Ecoli_28.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/Ecoli_28_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_28-sr/Ecoli_28_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_28-sr/Ecoli_28-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_28-sr/Ecoli_28_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_28-sr/Ecoli_28-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_28-sr/Ecoli_28_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_28-sr/Ecoli_28-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_28-sr/Ecoli_28_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/Ecoli_28_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_28-sr/Ecoli_28_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_28-sr/Ecoli_28-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_28-sr/Ecoli_28_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_28-sr/Ecoli_28-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_28-sr/Ecoli_28_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_28-sr/Ecoli_28-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_28-sr/Ecoli_28_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/Ecoli_28_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_28-sr/Ecoli_28_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/Ecoli_28_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_28-sr/Ecoli_28_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/Ecoli_28_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_28-sr/Ecoli_28_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_28-sr/Ecoli_28_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_28-sr/Ecoli_28_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_28-sr/Ecoli_28_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_28-sr/Ecoli_28_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_28-sr/Ecoli_28_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_28-sr/Ecoli_28_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/Ecoli_28_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_28-sr/Ecoli_28_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_28-sr/Ecoli_28_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Ecoli_28" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_28-sr/Ecoli_28_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_28-sr/Ecoli_28_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Ecoli_28" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_28-sr/Ecoli_28_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_28-sr/Ecoli_28_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Ecoli_28" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_28-sr/Ecoli_28_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_28-sr/Ecoli_28_summary.txt
        fi
        

[Thu Nov 23 10:46:59 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Ecoli_28.log
    jobid: 130
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Ecoli_28.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/assembly_graph.gfa
    wildcards: sample=Ecoli_28
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:46:59 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Ecoli_28.log
    jobid: 129
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Ecoli_28.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/assembly.fasta
    wildcards: sample=Ecoli_28
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Ecoli_28.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_

Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_
[Thu Nov 23 10:46:59 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_28_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ecoli_28.log
    jobid: 66
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Ecoli_28.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_28_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/assembly.fasta
    wildcards: sample=Ecoli_28
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_28_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ecoli_28.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:46:59 2023]
Finished job 696.
372 of 759 steps (49%) done
Select jobs to execute...

[Thu Nov 23 10:46:59 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Ecoli_28.log
    jobid: 255
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Ecoli_28.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/assembly.fasta
    wildcards: sample=Ecoli_28
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Ecoli_28.log
        fi
        
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpi1ct5g61.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:47:00 2023]
Finished job 130.
373 of 759 steps (49%) done
Select jobs to execute...
[Thu Nov 23 10:47:11 2023]
Finished job 255.
374 of 759 steps (49%) done
[Thu Nov 23 10:47:14 2023]
Finished job 141.
375 of 759 steps (49%) done

[Thu Nov 23 10:47:14 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bs_13-assembly-stats_flye.csv
    jobid: 324
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bs_13-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/checkv/quality_summary.tsv
    wildcards: sample=Bs_13
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpsayrlvk3.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:47:15 2023]
Finished job 324.
376 of 759 steps (50%) done
Select jobs to execute...

[Thu Nov 23 10:47:15 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bs_13-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bs_13-sr/Bs_13-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Bs_13.log
    jobid: 394
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bs_13-sr/Bs_13-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bs_13-assembly-stats_flye.csv
    wildcards: sample=Bs_13
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpn8jvkjos.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:47:17 2023]
Finished job 394.
377 of 759 steps (50%) done
Select jobs to execute...

[Thu Nov 23 10:47:17 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bs_13-sr/Bs_13-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bs_13-sr/Bs_13.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Bs_13.log
    jobid: 393
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bs_13-sr/Bs_13.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bs_13-sr/Bs_13-genome-candidates.csv
    wildcards: sample=Bs_13
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bs_13-sr/Bs_13-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bs_13-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bs_13-sr/Bs_13.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bs_13-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bs_13-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bs_13-sr/Bs_13.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:47:17 2023]
Finished job 393.
378 of 759 steps (50%) done
Select jobs to execute...

[Thu Nov 23 10:47:17 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bs_13-sr/Bs_13.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bs_13-sr/Bs_13_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bs_13-sr/Bs_13_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Bs_13.log
    jobid: 520
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bs_13-sr/Bs_13_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bs_13-sr/Bs_13.fasta
    wildcards: sample=Bs_13
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp0zhr878r.rename_genomes.py
[Thu Nov 23 10:47:17 2023]
Finished job 520.
379 of 759 steps (50%) done
Select jobs to execute...

[Thu Nov 23 10:47:17 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bs_13-sr/Bs_13_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/Bs_13.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/Bs_13_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/Bs_13_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/Bs_13_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/Bs_13_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/Bs_13_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bs_13.log
    jobid: 519
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/Bs_13_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/Bs_13_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/Bs_13.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/Bs_13_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/Bs_13_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/Bs_13_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/top_hits_vfdb.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bs_13-sr/Bs_13_genome.fasta
    wildcards: sample=Bs_13
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bs_13-sr/Bs_13_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bs_13-sr/Bs_13_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bs_13                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bs_13.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/Bs_13_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bs_13-sr/Bs_13_genome.fasta -n Bs_13_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr -p Bs_13 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:47:18 2023]
Error in rule pharokka_flye:
    jobid: 519
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bs_13-sr/Bs_13_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/Bs_13.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/Bs_13_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/Bs_13_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/Bs_13_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/Bs_13_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/Bs_13_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bs_13.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bs_13-sr/Bs_13_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bs_13-sr/Bs_13_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bs_13                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bs_13.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr/Bs_13_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bs_13-sr/Bs_13_genome.fasta -n Bs_13_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bs_13-sr -p Bs_13 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bs_13.log not found.

Select jobs to execute...
[Thu Nov 23 10:47:37 2023]
Finished job 129.
380 of 759 steps (50%) done

[Thu Nov 23 10:47:37 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_05_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bu_05.log
    jobid: 56
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Bu_05.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/flye.log; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_05_S.subsampled.fastq.gz
    wildcards: sample=Bu_05
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_05_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bu_05.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:47:39 2023]
Finished job 56.
381 of 759 steps (50%) done
Select jobs to execute...

[Thu Nov 23 10:47:39 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_05-sr/Bu_05_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Bu_05.log
    jobid: 749
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_05-sr/Bu_05_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/flye.log
    wildcards: sample=Bu_05
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_05-sr/Bu_05-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_05-sr/Bu_05-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_05-sr/Bu_05_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_05-sr/Bu_05_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_05-sr/Bu_05_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_05-sr/Bu_05.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_05-sr/Bu_05_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_05-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_05-sr/Bu_05.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_05-sr/Bu_05_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_05-sr/Bu_05_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_05-sr/Bu_05-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_05-sr/Bu_05_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_05-sr/Bu_05-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_05-sr/Bu_05_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_05-sr/Bu_05-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_05-sr/Bu_05_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_05-sr/Bu_05_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_05-sr/Bu_05_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_05-sr/Bu_05-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_05-sr/Bu_05_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_05-sr/Bu_05-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_05-sr/Bu_05_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_05-sr/Bu_05-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_05-sr/Bu_05_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_05-sr/Bu_05_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_05-sr/Bu_05_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_05-sr/Bu_05_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_05-sr/Bu_05_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_05-sr/Bu_05_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_05-sr/Bu_05_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_05-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_05-sr/Bu_05_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_05-sr/Bu_05_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_05-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_05-sr/Bu_05_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_05-sr/Bu_05_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_05-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_05-sr/Bu_05_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_05-sr/Bu_05_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_05-sr/Bu_05_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_05-sr/Bu_05_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_05-sr/Bu_05_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Bu_05" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_05-sr/Bu_05_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_05-sr/Bu_05_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Bu_05" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_05-sr/Bu_05_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_05-sr/Bu_05_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Bu_05" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_05-sr/Bu_05_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_05-sr/Bu_05_summary.txt
        fi
        

[Thu Nov 23 10:47:39 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_28-assembly-stats_flye.csv
    jobid: 318
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_28-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/checkv/quality_summary.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/graph_seq_details_flye.tsv
    wildcards: sample=Ecoli_28
    resources: tmpdir=/local/nala0006/2279907

[Thu Nov 23 10:47:39 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bu_05.log
    jobid: 308
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Bu_05.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly.fasta
    wildcards: sample=Bu_05
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bu_05.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_

[Thu Nov 23 10:47:39 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Bu_05.log
    jobid: 236
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Bu_05.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly.fasta
    wildcards: sample=Bu_05
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:47:39 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bu_05.log
    jobid: 235
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Bu_05.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly.fasta
    wildcards: sample=Bu_05
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bu_05.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_
[Thu Nov 23 10:47:39 2023]
Finished job 749.
382 of 759 steps (50%) done
Select jobs to execute...
Waiting at most 5 seconds for missing files.
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp5s4kkh0p.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpq_cqe8ca.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
MissingOutputException in rule checkv_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.checkv.smk, line 38:
Job 308  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/checkv/quality_summary.tsv
Waiting at most 5 seconds for missing files.
MissingOutputException in rule viralverify_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.viralverify.smk, line 37:
Job 235  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly_result_table.csv
[Thu Nov 23 10:47:49 2023]
Finished job 236.
383 of 759 steps (50%) done
[Thu Nov 23 10:47:49 2023]
Finished job 318.
384 of 759 steps (51%) done

[Thu Nov 23 10:47:49 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_05_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_05.log
    jobid: 119
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Bu_05.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_05_S.subsampled.fastq.gz
    wildcards: sample=Bu_05
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_05_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_05.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:47:49 2023]
Finished job 66.
385 of 759 steps (51%) done
Select jobs to execute...

[Thu Nov 23 10:47:49 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_03_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bu_03.log
    jobid: 11
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Bu_03.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/flye.log; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_03_S.subsampled.fastq.gz
    wildcards: sample=Bu_03
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_03_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bu_03.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/flye.log
        fi
        
Select jobs to execute...
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:47:51 2023]
Finished job 11.
386 of 759 steps (51%) done

[Thu Nov 23 10:47:51 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_28-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_28-sr/Ecoli_28-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Ecoli_28.log
    jobid: 382
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_28-sr/Ecoli_28-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_28-assembly-stats_flye.csv
    wildcards: sample=Ecoli_28
    resources: tmpdir=/local/nala0006/2279907

[Thu Nov 23 10:47:51 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_03-sr/Bu_03_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Bu_03.log
    jobid: 704
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_03-sr/Bu_03_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/flye.log
    wildcards: sample=Bu_03
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_03-sr/Bu_03-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_03-sr/Bu_03-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/Bu_03_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/Bu_03_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_03-sr/Bu_03_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_03-sr/Bu_03.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_03-sr/Bu_03_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_03-sr/Bu_03.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/Bu_03_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_03-sr/Bu_03_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_03-sr/Bu_03-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_03-sr/Bu_03_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_03-sr/Bu_03-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_03-sr/Bu_03_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_03-sr/Bu_03-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_03-sr/Bu_03_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/Bu_03_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_03-sr/Bu_03_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_03-sr/Bu_03-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_03-sr/Bu_03_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_03-sr/Bu_03-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_03-sr/Bu_03_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_03-sr/Bu_03-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_03-sr/Bu_03_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/Bu_03_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_03-sr/Bu_03_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/Bu_03_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_03-sr/Bu_03_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/Bu_03_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_03-sr/Bu_03_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_03-sr/Bu_03_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_03-sr/Bu_03_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_03-sr/Bu_03_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_03-sr/Bu_03_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_03-sr/Bu_03_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_03-sr/Bu_03_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/Bu_03_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_03-sr/Bu_03_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_03-sr/Bu_03_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Bu_03" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_03-sr/Bu_03_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_03-sr/Bu_03_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Bu_03" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_03-sr/Bu_03_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_03-sr/Bu_03_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Bu_03" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_03-sr/Bu_03_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_03-sr/Bu_03_summary.txt
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_

[Thu Nov 23 10:47:51 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bu_03.log
    jobid: 145
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Bu_03.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/assembly.fasta
    wildcards: sample=Bu_03
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bu_03.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_

[Thu Nov 23 10:47:51 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bu_03.log
    jobid: 263
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Bu_03.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/assembly.fasta
    wildcards: sample=Bu_03
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bu_03.log
        fi
        
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_

[Thu Nov 23 10:47:51 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Bu_03.log
    jobid: 146
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Bu_03.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/assembly_graph.gfa
    wildcards: sample=Bu_03
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:47:51 2023]
Finished job 704.
387 of 759 steps (51%) done
Select jobs to execute...
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpz8g4g2gq.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmprn7tmjar.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:47:52 2023]
Error in rule medaka:
    jobid: 119
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_05_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_05.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_05_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_05.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/consensus.fasta
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_05.log:
================================================================================
[10:47:51 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmpjqns3sgp.
[10:47:52 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmp1nyg_un5.
Creating fai index file /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly.fasta.fai
[faidx] Could not build fai index /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_05-sr/assembly.fasta.fai
================================================================================


[Thu Nov 23 10:47:52 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_03_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_03.log
    jobid: 74
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Bu_03.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_03_S.subsampled.fastq.gz
    wildcards: sample=Bu_03
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_03_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_03.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:47:52 2023]
Finished job 146.
388 of 759 steps (51%) done
Select jobs to execute...
[Thu Nov 23 10:47:53 2023]
Finished job 382.
389 of 759 steps (51%) done

[Thu Nov 23 10:47:53 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_28-sr/Ecoli_28-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_28-sr/Ecoli_28.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Ecoli_28.log
    jobid: 381
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_28-sr/Ecoli_28.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_28-sr/Ecoli_28-genome-candidates.csv
    wildcards: sample=Ecoli_28
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_28-sr/Ecoli_28-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_28-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_28-sr/Ecoli_28.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_28-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_28-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_28-sr/Ecoli_28.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:47:53 2023]
Finished job 381.
390 of 759 steps (51%) done
Select jobs to execute...

[Thu Nov 23 10:47:53 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_28-sr/Ecoli_28.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_28-sr/Ecoli_28_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_28-sr/Ecoli_28_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Ecoli_28.log
    jobid: 508
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_28-sr/Ecoli_28_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_28-sr/Ecoli_28.fasta
    wildcards: sample=Ecoli_28
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp6j31ndj9.rename_genomes.py
[Thu Nov 23 10:47:53 2023]
Finished job 508.
391 of 759 steps (52%) done
Select jobs to execute...

[Thu Nov 23 10:47:53 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_28-sr/Ecoli_28_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/Ecoli_28.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/Ecoli_28_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/Ecoli_28_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/Ecoli_28_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/Ecoli_28_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/Ecoli_28_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_28.log
    jobid: 507
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/Ecoli_28_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/Ecoli_28_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/Ecoli_28_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/Ecoli_28_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/Ecoli_28_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/Ecoli_28.gbk; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_28-sr/Ecoli_28_genome.fasta
    wildcards: sample=Ecoli_28
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_28-sr/Ecoli_28_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_28-sr/Ecoli_28_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Ecoli_28                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_28.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/Ecoli_28_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_28-sr/Ecoli_28_genome.fasta -n Ecoli_28_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr -p Ecoli_28 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:47:54 2023]
Error in rule pharokka_flye:
    jobid: 507
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_28-sr/Ecoli_28_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/Ecoli_28.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/Ecoli_28_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/Ecoli_28_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/Ecoli_28_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/Ecoli_28_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/Ecoli_28_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_28.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_28-sr/Ecoli_28_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_28-sr/Ecoli_28_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Ecoli_28                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_28.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr/Ecoli_28_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_28-sr/Ecoli_28_genome.fasta -n Ecoli_28_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_28-sr -p Ecoli_28 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_28.log not found.

Select jobs to execute...
[Thu Nov 23 10:48:03 2023]
Finished job 263.
392 of 759 steps (52%) done
[Thu Nov 23 10:48:08 2023]
Finished job 74.
393 of 759 steps (52%) done

[Thu Nov 23 10:48:08 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_24_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Ec_24.log
    jobid: 27
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Ec_24.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly_graph.gfa; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_24_S.subsampled.fastq.gz
    wildcards: sample=Ec_24
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_24_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Ec_24.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:48:10 2023]
Finished job 27.
394 of 759 steps (52%) done
Select jobs to execute...

[Thu Nov 23 10:48:10 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_24-sr/Ec_24_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Ec_24.log
    jobid: 720
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_24-sr/Ec_24_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/flye.log
    wildcards: sample=Ec_24
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ec_24-sr/Ec_24-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ec_24-sr/Ec_24-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ec_24-sr/Ec_24_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ec_24-sr/Ec_24_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_24-sr/Ec_24_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ec_24-sr/Ec_24.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_24-sr/Ec_24_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ec_24-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_24-sr/Ec_24.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ec_24-sr/Ec_24_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_24-sr/Ec_24_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ec_24-sr/Ec_24-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_24-sr/Ec_24_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ec_24-sr/Ec_24-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_24-sr/Ec_24_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ec_24-sr/Ec_24-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_24-sr/Ec_24_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ec_24-sr/Ec_24_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_24-sr/Ec_24_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ec_24-sr/Ec_24-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_24-sr/Ec_24_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ec_24-sr/Ec_24-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_24-sr/Ec_24_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ec_24-sr/Ec_24-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_24-sr/Ec_24_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ec_24-sr/Ec_24_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_24-sr/Ec_24_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ec_24-sr/Ec_24_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_24-sr/Ec_24_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ec_24-sr/Ec_24_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_24-sr/Ec_24_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ec_24-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_24-sr/Ec_24_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_24-sr/Ec_24_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ec_24-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_24-sr/Ec_24_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_24-sr/Ec_24_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ec_24-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_24-sr/Ec_24_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_24-sr/Ec_24_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ec_24-sr/Ec_24_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_24-sr/Ec_24_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_24-sr/Ec_24_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Ec_24" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_24-sr/Ec_24_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_24-sr/Ec_24_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Ec_24" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_24-sr/Ec_24_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_24-sr/Ec_24_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Ec_24" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_24-sr/Ec_24_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_24-sr/Ec_24_summary.txt
        fi
        

[Thu Nov 23 10:48:10 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_24_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ec_24.log
    jobid: 90
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Ec_24.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_24_S.subsampled.fastq.gz
    wildcards: sample=Ec_24
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_24_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ec_24.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/consensus.fasta
        fi
        

Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:48:10 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Ec_24.log
    jobid: 177
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Ec_24.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly.fasta
    wildcards: sample=Ec_24
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Ec_24.log
        fi
        

Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_
[Thu Nov 23 10:48:10 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Ec_24.log
    jobid: 178
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Ec_24.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly_graph.gfa
    wildcards: sample=Ec_24
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:48:10 2023]
Finished job 720.
395 of 759 steps (52%) done
Select jobs to execute...

[Thu Nov 23 10:48:10 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Ec_24.log
    jobid: 279
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Ec_24.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly.fasta
    wildcards: sample=Ec_24
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Ec_24.log
        fi
        
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_
Waiting at most 5 seconds for missing files.
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpmnx_8wot.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:48:13 2023]
Error in rule medaka:
    jobid: 90
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_24_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ec_24.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_24_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ec_24.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/consensus.fasta
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ec_24.log:
================================================================================
[10:48:12 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmplvp7ljxm.
[10:48:13 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmphizghonk.
Creating fai index file /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly.fasta.fai
[faidx] Could not build fai index /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly.fasta.fai
================================================================================

MissingOutputException in rule viralverify_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.viralverify.smk, line 37:
Job 177  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/assembly_result_table.csv
Select jobs to execute...
Waiting at most 5 seconds for missing files.
MissingOutputException in rule checkv_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.checkv.smk, line 38:
Job 279  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_24-sr/checkv/quality_summary.tsv
[Thu Nov 23 10:48:20 2023]
Finished job 178.
396 of 759 steps (52%) done

[Thu Nov 23 10:48:20 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_33_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Ecoli_33.log
    jobid: 30
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Ecoli_33.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/flye.log; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_33_S.subsampled.fastq.gz
    wildcards: sample=Ecoli_33
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_33_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Ecoli_33.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/flye.log
        fi
        
Select jobs to execute...
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:48:22 2023]
Finished job 30.
397 of 759 steps (52%) done

[Thu Nov 23 10:48:22 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Ecoli_33.log
    jobid: 184
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Ecoli_33.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/assembly_graph.gfa
    wildcards: sample=Ecoli_33
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:48:23 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_33_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ecoli_33.log
    jobid: 93
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Ecoli_33.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_33_S.subsampled.fastq.gz
    wildcards: sample=Ecoli_33
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_33_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ecoli_33.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/consensus.fasta
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_

Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:48:23 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Ecoli_33.log
    jobid: 282
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Ecoli_33.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/assembly.fasta
    wildcards: sample=Ecoli_33
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Ecoli_33.log
        fi
        
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_

[Thu Nov 23 10:48:23 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Ecoli_33.log
    jobid: 183
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Ecoli_33.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/assembly.fasta
    wildcards: sample=Ecoli_33
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Ecoli_33.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp3ikg99_5.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:48:24 2023]
Finished job 184.
398 of 759 steps (52%) done
Select jobs to execute...

[Thu Nov 23 10:48:24 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33-sr/Ecoli_33_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Ecoli_33.log
    jobid: 723
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33-sr/Ecoli_33_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/flye.log
    wildcards: sample=Ecoli_33
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33-sr/Ecoli_33-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33-sr/Ecoli_33-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/Ecoli_33_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/Ecoli_33_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33-sr/Ecoli_33_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33-sr/Ecoli_33.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33-sr/Ecoli_33_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33-sr/Ecoli_33.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/Ecoli_33_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33-sr/Ecoli_33_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33-sr/Ecoli_33-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33-sr/Ecoli_33_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33-sr/Ecoli_33-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33-sr/Ecoli_33_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33-sr/Ecoli_33-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33-sr/Ecoli_33_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/Ecoli_33_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33-sr/Ecoli_33_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33-sr/Ecoli_33-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33-sr/Ecoli_33_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33-sr/Ecoli_33-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33-sr/Ecoli_33_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33-sr/Ecoli_33-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33-sr/Ecoli_33_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/Ecoli_33_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33-sr/Ecoli_33_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/Ecoli_33_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33-sr/Ecoli_33_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/Ecoli_33_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33-sr/Ecoli_33_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33-sr/Ecoli_33_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33-sr/Ecoli_33_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33-sr/Ecoli_33_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33-sr/Ecoli_33_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33-sr/Ecoli_33_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33-sr/Ecoli_33_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/Ecoli_33_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33-sr/Ecoli_33_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33-sr/Ecoli_33_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Ecoli_33" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33-sr/Ecoli_33_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33-sr/Ecoli_33_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Ecoli_33" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33-sr/Ecoli_33_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33-sr/Ecoli_33_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Ecoli_33" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33-sr/Ecoli_33_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33-sr/Ecoli_33_summary.txt
        fi
        
[Thu Nov 23 10:48:24 2023]
Finished job 723.
399 of 759 steps (53%) done
Select jobs to execute...
[Thu Nov 23 10:48:28 2023]
Finished job 145.
400 of 759 steps (53%) done

[Thu Nov 23 10:48:28 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bu_03-assembly-stats_flye.csv
    jobid: 326
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bu_03-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/checkv/quality_summary.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/assembly_result_table.csv
    wildcards: sample=Bu_03
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpykkh2a57.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:48:29 2023]
Finished job 326.
401 of 759 steps (53%) done
Select jobs to execute...

[Thu Nov 23 10:48:29 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bu_03-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_03-sr/Bu_03-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Bu_03.log
    jobid: 398
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_03-sr/Bu_03-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Bu_03-assembly-stats_flye.csv
    wildcards: sample=Bu_03
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpc0_4bxng.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:48:30 2023]
Finished job 398.
402 of 759 steps (53%) done
Select jobs to execute...

[Thu Nov 23 10:48:30 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_03-sr/Bu_03-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_03-sr/Bu_03.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Bu_03.log
    jobid: 397
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_03-sr/Bu_03.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_03-sr/Bu_03-genome-candidates.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/assembly.fasta
    wildcards: sample=Bu_03
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_03-sr/Bu_03-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_03-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_03-sr/Bu_03.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_03-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_03-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_03-sr/Bu_03.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:48:30 2023]
Finished job 397.
403 of 759 steps (53%) done
Select jobs to execute...

[Thu Nov 23 10:48:30 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_03-sr/Bu_03.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_03-sr/Bu_03_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_03-sr/Bu_03_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Bu_03.log
    jobid: 524
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_03-sr/Bu_03_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_03-sr/Bu_03.fasta
    wildcards: sample=Bu_03
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpqu4dcl8h.rename_genomes.py
[Thu Nov 23 10:48:31 2023]
Finished job 524.
404 of 759 steps (53%) done
Select jobs to execute...

[Thu Nov 23 10:48:31 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_03-sr/Bu_03_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/Bu_03.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/Bu_03_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/Bu_03_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/Bu_03_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/Bu_03_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/Bu_03_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_03.log
    jobid: 523
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/Bu_03_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/Bu_03_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/Bu_03_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/Bu_03.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/Bu_03_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/Bu_03_length_gc_cds_density.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_03-sr/Bu_03_genome.fasta
    wildcards: sample=Bu_03
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_03-sr/Bu_03_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_03-sr/Bu_03_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bu_03                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_03.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/Bu_03_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_03-sr/Bu_03_genome.fasta -n Bu_03_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr -p Bu_03 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:48:31 2023]
Error in rule pharokka_flye:
    jobid: 523
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_03-sr/Bu_03_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/Bu_03.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/Bu_03_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/Bu_03_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/Bu_03_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/Bu_03_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/Bu_03_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_03.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_03-sr/Bu_03_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_03-sr/Bu_03_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Bu_03                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_03.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr/Bu_03_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_03-sr/Bu_03_genome.fasta -n Bu_03_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_03-sr -p Bu_03 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Bu_03.log not found.

Select jobs to execute...
[Thu Nov 23 10:48:34 2023]
Finished job 282.
405 of 759 steps (53%) done
[Thu Nov 23 10:49:02 2023]
Finished job 183.
406 of 759 steps (53%) done

[Thu Nov 23 10:49:02 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_23_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Ec_23.log
    jobid: 39
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Ec_23.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly_graph.gfa; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_23_S.subsampled.fastq.gz
    wildcards: sample=Ec_23
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_23_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Ec_23.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:49:03 2023]
Finished job 39.
407 of 759 steps (54%) done
Select jobs to execute...

[Thu Nov 23 10:49:03 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_23-sr/Ec_23_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Ec_23.log
    jobid: 732
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_23-sr/Ec_23_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/flye.log
    wildcards: sample=Ec_23
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ec_23-sr/Ec_23-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ec_23-sr/Ec_23-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ec_23-sr/Ec_23_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ec_23-sr/Ec_23_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_23-sr/Ec_23_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ec_23-sr/Ec_23.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_23-sr/Ec_23_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ec_23-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_23-sr/Ec_23.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ec_23-sr/Ec_23_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_23-sr/Ec_23_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ec_23-sr/Ec_23-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_23-sr/Ec_23_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ec_23-sr/Ec_23-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_23-sr/Ec_23_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ec_23-sr/Ec_23-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_23-sr/Ec_23_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ec_23-sr/Ec_23_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_23-sr/Ec_23_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ec_23-sr/Ec_23-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_23-sr/Ec_23_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ec_23-sr/Ec_23-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_23-sr/Ec_23_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ec_23-sr/Ec_23-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_23-sr/Ec_23_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ec_23-sr/Ec_23_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_23-sr/Ec_23_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ec_23-sr/Ec_23_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_23-sr/Ec_23_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ec_23-sr/Ec_23_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_23-sr/Ec_23_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ec_23-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_23-sr/Ec_23_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_23-sr/Ec_23_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ec_23-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_23-sr/Ec_23_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_23-sr/Ec_23_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ec_23-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_23-sr/Ec_23_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_23-sr/Ec_23_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ec_23-sr/Ec_23_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_23-sr/Ec_23_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_23-sr/Ec_23_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Ec_23" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_23-sr/Ec_23_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_23-sr/Ec_23_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Ec_23" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_23-sr/Ec_23_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_23-sr/Ec_23_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Ec_23" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_23-sr/Ec_23_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_23-sr/Ec_23_summary.txt
        fi
        

[Thu Nov 23 10:49:03 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Ec_23.log
    jobid: 201
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Ec_23.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly.fasta
    wildcards: sample=Ec_23
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Ec_23.log
        fi
        

Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_
[Thu Nov 23 10:49:03 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_33-assembly-stats_flye.csv
    jobid: 345
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_33-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/checkv/quality_summary.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/graph_seq_details_flye.tsv
    wildcards: sample=Ecoli_33
    resources: tmpdir=/local/nala0006/2279907

[Thu Nov 23 10:49:03 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Ec_23.log
    jobid: 202
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Ec_23.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly_graph.gfa
    wildcards: sample=Ec_23
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_

[Thu Nov 23 10:49:03 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Ec_23.log
    jobid: 291
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Ec_23.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly.fasta
    wildcards: sample=Ec_23
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Ec_23.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_
[Thu Nov 23 10:49:03 2023]
Finished job 732.
408 of 759 steps (54%) done
Select jobs to execute...
Waiting at most 5 seconds for missing files.
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpy0l6r7le.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpvyrv7x0o.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
MissingOutputException in rule viralverify_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.viralverify.smk, line 37:
Job 201  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly_result_table.csv
Waiting at most 5 seconds for missing files.
MissingOutputException in rule checkv_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.checkv.smk, line 38:
Job 291  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/checkv/quality_summary.tsv
[Thu Nov 23 10:49:14 2023]
Finished job 202.
409 of 759 steps (54%) done
[Thu Nov 23 10:49:14 2023]
Finished job 345.
410 of 759 steps (54%) done

[Thu Nov 23 10:49:14 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_23_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ec_23.log
    jobid: 102
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Ec_23.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_23_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly.fasta
    wildcards: sample=Ec_23
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_23_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ec_23.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/consensus.fasta
        fi
        
Select jobs to execute...
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:49:17 2023]
Error in rule medaka:
    jobid: 102
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_23_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ec_23.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_23_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ec_23.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/consensus.fasta
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ec_23.log:
================================================================================
[10:49:16 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmpexeljcw4.
[10:49:17 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmpxn701nt2.
Creating fai index file /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly.fasta.fai
[faidx] Could not build fai index /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_23-sr/assembly.fasta.fai
================================================================================


[Thu Nov 23 10:49:17 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_13_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.CS-2_13.log
    jobid: 21
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.CS-2_13.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/assembly_info.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_13_S.subsampled.fastq.gz
    wildcards: sample=CS-2_13
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_13_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.CS-2_13.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:49:19 2023]
Finished job 21.
411 of 759 steps (54%) done
Select jobs to execute...

[Thu Nov 23 10:49:19 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_33-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33-sr/Ecoli_33-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Ecoli_33.log
    jobid: 436
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33-sr/Ecoli_33-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_33-assembly-stats_flye.csv
    wildcards: sample=Ecoli_33
    resources: tmpdir=/local/nala0006/2279907

[Thu Nov 23 10:49:19 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_13-sr/CS-2_13_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.CS-2_13.log
    jobid: 714
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_13-sr/CS-2_13_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/flye.log
    wildcards: sample=CS-2_13
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_13-sr/CS-2_13-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_13-sr/CS-2_13-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/CS-2_13_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/CS-2_13_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_13-sr/CS-2_13_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_13-sr/CS-2_13.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_13-sr/CS-2_13_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_13-sr/CS-2_13.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/CS-2_13_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_13-sr/CS-2_13_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_13-sr/CS-2_13-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_13-sr/CS-2_13_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_13-sr/CS-2_13-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_13-sr/CS-2_13_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_13-sr/CS-2_13-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_13-sr/CS-2_13_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/CS-2_13_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_13-sr/CS-2_13_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_13-sr/CS-2_13-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_13-sr/CS-2_13_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_13-sr/CS-2_13-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_13-sr/CS-2_13_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_13-sr/CS-2_13-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_13-sr/CS-2_13_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/CS-2_13_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_13-sr/CS-2_13_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/CS-2_13_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_13-sr/CS-2_13_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/CS-2_13_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_13-sr/CS-2_13_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_13-sr/CS-2_13_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_13-sr/CS-2_13_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_13-sr/CS-2_13_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_13-sr/CS-2_13_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_13-sr/CS-2_13_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_13-sr/CS-2_13_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/CS-2_13_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_13-sr/CS-2_13_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_13-sr/CS-2_13_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: CS-2_13" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_13-sr/CS-2_13_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_13-sr/CS-2_13_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: CS-2_13" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_13-sr/CS-2_13_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_13-sr/CS-2_13_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: CS-2_13" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_13-sr/CS-2_13_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_13-sr/CS-2_13_summary.txt
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_

[Thu Nov 23 10:49:19 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.CS-2_13.log
    jobid: 166
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.CS-2_13.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/assembly_info.txt
    wildcards: sample=CS-2_13
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:49:19 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.CS-2_13.log
    jobid: 273
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.CS-2_13.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/assembly.fasta
    wildcards: sample=CS-2_13
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.CS-2_13.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_

[Thu Nov 23 10:49:19 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.CS-2_13.log
    jobid: 165
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.CS-2_13.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/assembly.fasta
    wildcards: sample=CS-2_13
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.CS-2_13.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_
[Thu Nov 23 10:49:19 2023]
Finished job 714.
412 of 759 steps (54%) done
Select jobs to execute...
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpr_c62zv2.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmphdw60rgi.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:49:20 2023]
Finished job 166.
413 of 759 steps (54%) done
[Thu Nov 23 10:49:20 2023]
Finished job 436.
414 of 759 steps (55%) done

[Thu Nov 23 10:49:20 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33-sr/Ecoli_33-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33-sr/Ecoli_33.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Ecoli_33.log
    jobid: 435
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33-sr/Ecoli_33.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33-sr/Ecoli_33-genome-candidates.csv
    wildcards: sample=Ecoli_33
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33-sr/Ecoli_33-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33-sr/Ecoli_33.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33-sr/Ecoli_33.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:49:20 2023]
Finished job 435.
415 of 759 steps (55%) done
Select jobs to execute...

[Thu Nov 23 10:49:20 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33-sr/Ecoli_33.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33-sr/Ecoli_33_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33-sr/Ecoli_33_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Ecoli_33.log
    jobid: 562
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33-sr/Ecoli_33_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33-sr/Ecoli_33.fasta
    wildcards: sample=Ecoli_33
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpa53qxp1x.rename_genomes.py
[Thu Nov 23 10:49:21 2023]
Finished job 562.
416 of 759 steps (55%) done
Select jobs to execute...

[Thu Nov 23 10:49:21 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33-sr/Ecoli_33_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/Ecoli_33.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/Ecoli_33_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/Ecoli_33_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/Ecoli_33_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/Ecoli_33_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/Ecoli_33_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_33.log
    jobid: 561
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/Ecoli_33_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/Ecoli_33.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/Ecoli_33_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/Ecoli_33_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/Ecoli_33_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/Ecoli_33_top_hits_mash_inphared.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33-sr/Ecoli_33_genome.fasta
    wildcards: sample=Ecoli_33
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33-sr/Ecoli_33_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33-sr/Ecoli_33_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Ecoli_33                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_33.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/Ecoli_33_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33-sr/Ecoli_33_genome.fasta -n Ecoli_33_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr -p Ecoli_33 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:49:21 2023]
Error in rule pharokka_flye:
    jobid: 561
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33-sr/Ecoli_33_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/Ecoli_33.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/Ecoli_33_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/Ecoli_33_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/Ecoli_33_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/Ecoli_33_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/Ecoli_33_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_33.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33-sr/Ecoli_33_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33-sr/Ecoli_33_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Ecoli_33                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_33.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr/Ecoli_33_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33-sr/Ecoli_33_genome.fasta -n Ecoli_33_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33-sr -p Ecoli_33 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_33.log not found.

Select jobs to execute...
[Thu Nov 23 10:49:30 2023]
Finished job 273.
417 of 759 steps (55%) done
[Thu Nov 23 10:49:56 2023]
Finished job 165.
418 of 759 steps (55%) done

[Thu Nov 23 10:49:56 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_13_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-2_13.log
    jobid: 84
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.CS-2_13.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_13_S.subsampled.fastq.gz
    wildcards: sample=CS-2_13
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_13_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-2_13.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:50:33 2023]
Finished job 93.
419 of 759 steps (55%) done
Select jobs to execute...

[Thu Nov 23 10:50:33 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_12_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.CS-2_12.log
    jobid: 64
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.CS-2_12.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/assembly.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_12_S.subsampled.fastq.gz
    wildcards: sample=CS-2_12
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_12_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.CS-2_12.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:50:36 2023]
Finished job 64.
420 of 759 steps (55%) done
Select jobs to execute...

[Thu Nov 23 10:50:36 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12-sr/CS-2_12_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.CS-2_12.log
    jobid: 757
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12-sr/CS-2_12_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/flye.log
    wildcards: sample=CS-2_12
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12-sr/CS-2_12-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12-sr/CS-2_12-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/CS-2_12_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/CS-2_12_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12-sr/CS-2_12_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12-sr/CS-2_12.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12-sr/CS-2_12_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12-sr/CS-2_12.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/CS-2_12_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12-sr/CS-2_12_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12-sr/CS-2_12-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12-sr/CS-2_12_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12-sr/CS-2_12-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12-sr/CS-2_12_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12-sr/CS-2_12-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12-sr/CS-2_12_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/CS-2_12_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12-sr/CS-2_12_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12-sr/CS-2_12-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12-sr/CS-2_12_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12-sr/CS-2_12-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12-sr/CS-2_12_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12-sr/CS-2_12-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12-sr/CS-2_12_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/CS-2_12_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12-sr/CS-2_12_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/CS-2_12_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12-sr/CS-2_12_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/CS-2_12_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12-sr/CS-2_12_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12-sr/CS-2_12_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12-sr/CS-2_12_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12-sr/CS-2_12_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12-sr/CS-2_12_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12-sr/CS-2_12_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12-sr/CS-2_12_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/CS-2_12_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12-sr/CS-2_12_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12-sr/CS-2_12_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: CS-2_12" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12-sr/CS-2_12_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12-sr/CS-2_12_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: CS-2_12" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12-sr/CS-2_12_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12-sr/CS-2_12_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: CS-2_12" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12-sr/CS-2_12_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-2_12-sr/CS-2_12_summary.txt
        fi
        

[Thu Nov 23 10:50:36 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.CS-2_12.log
    jobid: 316
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.CS-2_12.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/assembly.fasta
    wildcards: sample=CS-2_12
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.CS-2_12.log
        fi
        
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_

[Thu Nov 23 10:50:36 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/CS-2_13-assembly-stats_flye.csv
    jobid: 336
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/CS-2_13-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/checkv/quality_summary.tsv
    wildcards: sample=CS-2_13
    resources: tmpdir=/local/nala0006/2279907

[Thu Nov 23 10:50:36 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.CS-2_12.log
    jobid: 252
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.CS-2_12.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/assembly.fasta
    wildcards: sample=CS-2_12
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:50:36 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.CS-2_12.log
    jobid: 251
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.CS-2_12.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/assembly.fasta
    wildcards: sample=CS-2_12
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.CS-2_12.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_
[Thu Nov 23 10:50:36 2023]
Finished job 757.
421 of 759 steps (55%) done
Select jobs to execute...
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpjjlo6j5a.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpjgnua06v.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:50:37 2023]
Finished job 252.
422 of 759 steps (56%) done
[Thu Nov 23 10:50:37 2023]
Finished job 336.
423 of 759 steps (56%) done

[Thu Nov 23 10:50:37 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/CS-2_13-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_13-sr/CS-2_13-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.CS-2_13.log
    jobid: 418
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_13-sr/CS-2_13-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/CS-2_13-assembly-stats_flye.csv
    wildcards: sample=CS-2_13
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp1pvwrczy.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:50:38 2023]
Finished job 418.
424 of 759 steps (56%) done
Select jobs to execute...

[Thu Nov 23 10:50:38 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_13-sr/CS-2_13-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_13-sr/CS-2_13.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.CS-2_13.log
    jobid: 417
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_13-sr/CS-2_13.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_13-sr/CS-2_13-genome-candidates.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/assembly.fasta
    wildcards: sample=CS-2_13
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_13-sr/CS-2_13-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_13-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_13-sr/CS-2_13.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_13-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_13-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_13-sr/CS-2_13.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:50:39 2023]
Finished job 417.
425 of 759 steps (56%) done
Select jobs to execute...

[Thu Nov 23 10:50:39 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_13-sr/CS-2_13.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_13-sr/CS-2_13_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_13-sr/CS-2_13_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.CS-2_13.log
    jobid: 544
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_13-sr/CS-2_13_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_13-sr/CS-2_13.fasta
    wildcards: sample=CS-2_13
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp3mplygox.rename_genomes.py
[Thu Nov 23 10:50:39 2023]
Finished job 544.
426 of 759 steps (56%) done
Select jobs to execute...

[Thu Nov 23 10:50:39 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_13-sr/CS-2_13_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/CS-2_13.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/CS-2_13_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/CS-2_13_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/CS-2_13_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/CS-2_13_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/CS-2_13_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.CS-2_13.log
    jobid: 543
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/CS-2_13_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/CS-2_13_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/CS-2_13.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/CS-2_13_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/CS-2_13_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/CS-2_13_top_hits_mash_inphared.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_13-sr/CS-2_13_genome.fasta
    wildcards: sample=CS-2_13
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_13-sr/CS-2_13_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_13-sr/CS-2_13_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p CS-2_13                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.CS-2_13.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/CS-2_13_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_13-sr/CS-2_13_genome.fasta -n CS-2_13_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr -p CS-2_13 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:50:40 2023]
Error in rule pharokka_flye:
    jobid: 543
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_13-sr/CS-2_13_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/CS-2_13.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/CS-2_13_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/CS-2_13_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/CS-2_13_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/CS-2_13_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/CS-2_13_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.CS-2_13.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_13-sr/CS-2_13_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_13-sr/CS-2_13_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p CS-2_13                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.CS-2_13.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr/CS-2_13_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_13-sr/CS-2_13_genome.fasta -n CS-2_13_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_13-sr -p CS-2_13 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.CS-2_13.log not found.

Select jobs to execute...
[Thu Nov 23 10:50:47 2023]
Finished job 84.
427 of 759 steps (56%) done

[Thu Nov 23 10:50:47 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_12_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-2_12.log
    jobid: 127
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.CS-2_12.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_12_S.subsampled.fastq.gz
    wildcards: sample=CS-2_12
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-2_12_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-2_12.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:50:47 2023]
Finished job 316.
428 of 759 steps (56%) done
Select jobs to execute...
[Thu Nov 23 10:50:56 2023]
Finished job 127.
429 of 759 steps (57%) done

[Thu Nov 23 10:50:56 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_02_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bu_02.log
    jobid: 15
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Bu_02.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly_info.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_02_S.subsampled.fastq.gz
    wildcards: sample=Bu_02
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_02_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bu_02.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:50:57 2023]
Finished job 15.
430 of 759 steps (57%) done
Select jobs to execute...

[Thu Nov 23 10:50:57 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_02-sr/Bu_02_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Bu_02.log
    jobid: 708
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_02-sr/Bu_02_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/flye.log
    wildcards: sample=Bu_02
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_02-sr/Bu_02-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_02-sr/Bu_02-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_02-sr/Bu_02_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_02-sr/Bu_02_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_02-sr/Bu_02_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_02-sr/Bu_02.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_02-sr/Bu_02_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_02-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_02-sr/Bu_02.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_02-sr/Bu_02_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_02-sr/Bu_02_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_02-sr/Bu_02-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_02-sr/Bu_02_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_02-sr/Bu_02-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_02-sr/Bu_02_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_02-sr/Bu_02-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_02-sr/Bu_02_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_02-sr/Bu_02_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_02-sr/Bu_02_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_02-sr/Bu_02-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_02-sr/Bu_02_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_02-sr/Bu_02-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_02-sr/Bu_02_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_02-sr/Bu_02-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_02-sr/Bu_02_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_02-sr/Bu_02_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_02-sr/Bu_02_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_02-sr/Bu_02_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_02-sr/Bu_02_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_02-sr/Bu_02_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_02-sr/Bu_02_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_02-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_02-sr/Bu_02_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_02-sr/Bu_02_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_02-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_02-sr/Bu_02_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_02-sr/Bu_02_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_02-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_02-sr/Bu_02_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_02-sr/Bu_02_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_02-sr/Bu_02_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_02-sr/Bu_02_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_02-sr/Bu_02_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Bu_02" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_02-sr/Bu_02_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_02-sr/Bu_02_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Bu_02" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_02-sr/Bu_02_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_02-sr/Bu_02_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Bu_02" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_02-sr/Bu_02_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_02-sr/Bu_02_summary.txt
        fi
        

[Thu Nov 23 10:50:57 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bu_02.log
    jobid: 153
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Bu_02.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly.fasta
    wildcards: sample=Bu_02
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bu_02.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_

[Thu Nov 23 10:50:57 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_02_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_02.log
    jobid: 78
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Bu_02.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_02_S.subsampled.fastq.gz
    wildcards: sample=Bu_02
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_02_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_02.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_

[Thu Nov 23 10:50:57 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Bu_02.log
    jobid: 154
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Bu_02.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly_graph.gfa
    wildcards: sample=Bu_02
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:50:57 2023]
Finished job 708.
431 of 759 steps (57%) done
Select jobs to execute...

[Thu Nov 23 10:50:57 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bu_02.log
    jobid: 267
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Bu_02.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly.fasta
    wildcards: sample=Bu_02
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bu_02.log
        fi
        
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_
Waiting at most 5 seconds for missing files.
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpvpzyvkeu.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:51:00 2023]
Error in rule medaka:
    jobid: 78
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_02_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_02.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_02_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_02.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/consensus.fasta
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_02.log:
================================================================================
[10:51:00 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmpx6ditsp3.
[10:51:00 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmp33cxcibm.
Creating fai index file /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly.fasta.fai
[faidx] Could not build fai index /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly.fasta.fai
================================================================================

MissingOutputException in rule viralverify_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.viralverify.smk, line 37:
Job 153  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/assembly_result_table.csv
Select jobs to execute...
Waiting at most 5 seconds for missing files.
MissingOutputException in rule checkv_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.checkv.smk, line 38:
Job 267  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_02-sr/checkv/quality_summary.tsv
[Thu Nov 23 10:51:08 2023]
Finished job 154.
432 of 759 steps (57%) done

[Thu Nov 23 10:51:08 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_35_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Ecoli_35.log
    jobid: 5
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Ecoli_35.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/assembly_graph.gfa; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_35_S.subsampled.fastq.gz
    wildcards: sample=Ecoli_35
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_35_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Ecoli_35.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/flye.log
        fi
        
Select jobs to execute...
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:51:10 2023]
Finished job 5.
433 of 759 steps (57%) done

[Thu Nov 23 10:51:10 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_35-sr/Ecoli_35_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Ecoli_35.log
    jobid: 698
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_35-sr/Ecoli_35_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/flye.log
    wildcards: sample=Ecoli_35
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_35-sr/Ecoli_35-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_35-sr/Ecoli_35-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/Ecoli_35_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/Ecoli_35_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_35-sr/Ecoli_35_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_35-sr/Ecoli_35.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_35-sr/Ecoli_35_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_35-sr/Ecoli_35.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/Ecoli_35_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_35-sr/Ecoli_35_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_35-sr/Ecoli_35-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_35-sr/Ecoli_35_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_35-sr/Ecoli_35-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_35-sr/Ecoli_35_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_35-sr/Ecoli_35-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_35-sr/Ecoli_35_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/Ecoli_35_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_35-sr/Ecoli_35_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_35-sr/Ecoli_35-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_35-sr/Ecoli_35_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_35-sr/Ecoli_35-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_35-sr/Ecoli_35_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_35-sr/Ecoli_35-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_35-sr/Ecoli_35_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/Ecoli_35_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_35-sr/Ecoli_35_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/Ecoli_35_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_35-sr/Ecoli_35_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/Ecoli_35_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_35-sr/Ecoli_35_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_35-sr/Ecoli_35_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_35-sr/Ecoli_35_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_35-sr/Ecoli_35_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_35-sr/Ecoli_35_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_35-sr/Ecoli_35_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_35-sr/Ecoli_35_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/Ecoli_35_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_35-sr/Ecoli_35_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_35-sr/Ecoli_35_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Ecoli_35" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_35-sr/Ecoli_35_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_35-sr/Ecoli_35_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Ecoli_35" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_35-sr/Ecoli_35_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_35-sr/Ecoli_35_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Ecoli_35" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_35-sr/Ecoli_35_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_35-sr/Ecoli_35_summary.txt
        fi
        

[Thu Nov 23 10:51:10 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_35_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ecoli_35.log
    jobid: 68
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Ecoli_35.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_35_S.subsampled.fastq.gz
    wildcards: sample=Ecoli_35
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_35_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ecoli_35.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_

[Thu Nov 23 10:51:10 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Ecoli_35.log
    jobid: 133
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Ecoli_35.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/assembly.fasta
    wildcards: sample=Ecoli_35
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Ecoli_35.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_

[Thu Nov 23 10:51:10 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Ecoli_35.log
    jobid: 134
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Ecoli_35.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/assembly_graph.gfa
    wildcards: sample=Ecoli_35
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:51:10 2023]
Finished job 698.
434 of 759 steps (57%) done
Select jobs to execute...

[Thu Nov 23 10:51:10 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Ecoli_35.log
    jobid: 257
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Ecoli_35.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/assembly.fasta
    wildcards: sample=Ecoli_35
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Ecoli_35.log
        fi
        
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpjo006v7_.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:51:11 2023]
Finished job 134.
435 of 759 steps (57%) done
Select jobs to execute...
[Thu Nov 23 10:51:16 2023]
Finished job 251.
436 of 759 steps (57%) done

[Thu Nov 23 10:51:16 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/CS-2_12-assembly-stats_flye.csv
    jobid: 379
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/CS-2_12-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/checkv/quality_summary.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/graph_seq_details_flye.tsv
    wildcards: sample=CS-2_12
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp8ogl0qk2.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:51:17 2023]
Finished job 379.
437 of 759 steps (58%) done
Select jobs to execute...

[Thu Nov 23 10:51:17 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/CS-2_12-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12-sr/CS-2_12-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.CS-2_12.log
    jobid: 504
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12-sr/CS-2_12-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/CS-2_12-assembly-stats_flye.csv
    wildcards: sample=CS-2_12
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp34met3jf.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:51:18 2023]
Finished job 504.
438 of 759 steps (58%) done
Select jobs to execute...

[Thu Nov 23 10:51:18 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12-sr/CS-2_12-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12-sr/CS-2_12.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.CS-2_12.log
    jobid: 503
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12-sr/CS-2_12.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12-sr/CS-2_12-genome-candidates.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/assembly.fasta
    wildcards: sample=CS-2_12
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12-sr/CS-2_12-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12-sr/CS-2_12.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-2_12-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12-sr/CS-2_12.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:51:18 2023]
Finished job 503.
439 of 759 steps (58%) done
Select jobs to execute...

[Thu Nov 23 10:51:18 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12-sr/CS-2_12.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12-sr/CS-2_12_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12-sr/CS-2_12_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.CS-2_12.log
    jobid: 630
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12-sr/CS-2_12_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12-sr/CS-2_12.fasta
    wildcards: sample=CS-2_12
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp1cy7yqmw.rename_genomes.py
[Thu Nov 23 10:51:19 2023]
Finished job 630.
440 of 759 steps (58%) done
Select jobs to execute...

[Thu Nov 23 10:51:19 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12-sr/CS-2_12_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/CS-2_12.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/CS-2_12_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/CS-2_12_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/CS-2_12_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/CS-2_12_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/CS-2_12_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.CS-2_12.log
    jobid: 629
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/CS-2_12_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/CS-2_12_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/CS-2_12_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/CS-2_12.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/CS-2_12_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/CS-2_12_length_gc_cds_density.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12-sr/CS-2_12_genome.fasta
    wildcards: sample=CS-2_12
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12-sr/CS-2_12_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12-sr/CS-2_12_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p CS-2_12                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.CS-2_12.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/CS-2_12_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12-sr/CS-2_12_genome.fasta -n CS-2_12_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr -p CS-2_12 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:51:19 2023]
Error in rule pharokka_flye:
    jobid: 629
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12-sr/CS-2_12_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/CS-2_12.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/CS-2_12_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/CS-2_12_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/CS-2_12_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/CS-2_12_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/CS-2_12_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.CS-2_12.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12-sr/CS-2_12_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12-sr/CS-2_12_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p CS-2_12                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.CS-2_12.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr/CS-2_12_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-2_12-sr/CS-2_12_genome.fasta -n CS-2_12_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-2_12-sr -p CS-2_12 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.CS-2_12.log not found.

Select jobs to execute...
[Thu Nov 23 10:51:22 2023]
Finished job 257.
441 of 759 steps (58%) done
[Thu Nov 23 10:51:47 2023]
Finished job 133.
442 of 759 steps (58%) done

[Thu Nov 23 10:51:47 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_10_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.CS-1_10.log
    jobid: 23
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.CS-1_10.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/flye.log; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_10_S.subsampled.fastq.gz
    wildcards: sample=CS-1_10
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_10_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.CS-1_10.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:51:49 2023]
Finished job 23.
443 of 759 steps (58%) done
Select jobs to execute...

[Thu Nov 23 10:51:49 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_10-sr/CS-1_10_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.CS-1_10.log
    jobid: 716
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_10-sr/CS-1_10_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/flye.log
    wildcards: sample=CS-1_10
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_10-sr/CS-1_10-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_10-sr/CS-1_10-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/CS-1_10_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/CS-1_10_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_10-sr/CS-1_10_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_10-sr/CS-1_10.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_10-sr/CS-1_10_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_10-sr/CS-1_10.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/CS-1_10_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_10-sr/CS-1_10_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_10-sr/CS-1_10-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_10-sr/CS-1_10_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_10-sr/CS-1_10-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_10-sr/CS-1_10_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_10-sr/CS-1_10-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_10-sr/CS-1_10_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/CS-1_10_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_10-sr/CS-1_10_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_10-sr/CS-1_10-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_10-sr/CS-1_10_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_10-sr/CS-1_10-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_10-sr/CS-1_10_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_10-sr/CS-1_10-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_10-sr/CS-1_10_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/CS-1_10_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_10-sr/CS-1_10_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/CS-1_10_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_10-sr/CS-1_10_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/CS-1_10_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_10-sr/CS-1_10_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_10-sr/CS-1_10_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_10-sr/CS-1_10_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_10-sr/CS-1_10_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_10-sr/CS-1_10_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_10-sr/CS-1_10_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_10-sr/CS-1_10_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/CS-1_10_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_10-sr/CS-1_10_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_10-sr/CS-1_10_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: CS-1_10" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_10-sr/CS-1_10_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_10-sr/CS-1_10_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: CS-1_10" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_10-sr/CS-1_10_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_10-sr/CS-1_10_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: CS-1_10" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_10-sr/CS-1_10_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_10-sr/CS-1_10_summary.txt
        fi
        

[Thu Nov 23 10:51:49 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_35-assembly-stats_flye.csv
    jobid: 320
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_35-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/checkv/quality_summary.tsv
    wildcards: sample=Ecoli_35
    resources: tmpdir=/local/nala0006/2279907

[Thu Nov 23 10:51:49 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.CS-1_10.log
    jobid: 170
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.CS-1_10.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/assembly_graph.gfa
    wildcards: sample=CS-1_10
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_

[Thu Nov 23 10:51:49 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.CS-1_10.log
    jobid: 275
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.CS-1_10.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/assembly.fasta
    wildcards: sample=CS-1_10
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.CS-1_10.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_

[Thu Nov 23 10:51:49 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.CS-1_10.log
    jobid: 169
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.CS-1_10.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/assembly.fasta
    wildcards: sample=CS-1_10
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.CS-1_10.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_
[Thu Nov 23 10:51:49 2023]
Finished job 716.
444 of 759 steps (58%) done
Select jobs to execute...
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpxpgu8q1i.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmptzb0grf6.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:51:50 2023]
Finished job 170.
445 of 759 steps (59%) done
[Thu Nov 23 10:51:50 2023]
Finished job 320.
446 of 759 steps (59%) done

[Thu Nov 23 10:51:50 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_35-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_35-sr/Ecoli_35-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.Ecoli_35.log
    jobid: 386
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_35-sr/Ecoli_35-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/Ecoli_35-assembly-stats_flye.csv
    wildcards: sample=Ecoli_35
    resources: tmpdir=/local/nala0006/2279907

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpjd6qbr34.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:51:52 2023]
Finished job 386.
447 of 759 steps (59%) done
Select jobs to execute...

[Thu Nov 23 10:51:52 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_35-sr/Ecoli_35-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_35-sr/Ecoli_35.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.Ecoli_35.log
    jobid: 385
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_35-sr/Ecoli_35.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_35-sr/Ecoli_35-genome-candidates.csv
    wildcards: sample=Ecoli_35
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_35-sr/Ecoli_35-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_35-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_35-sr/Ecoli_35.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_35-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_35-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_35-sr/Ecoli_35.fasta ; done 
        
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_
[Thu Nov 23 10:51:52 2023]
Finished job 385.
448 of 759 steps (59%) done
Select jobs to execute...

[Thu Nov 23 10:51:52 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_35-sr/Ecoli_35.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_35-sr/Ecoli_35_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_35-sr/Ecoli_35_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.Ecoli_35.log
    jobid: 512
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_35-sr/Ecoli_35_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_35-sr/Ecoli_35.fasta
    wildcards: sample=Ecoli_35
    resources: tmpdir=/local/nala0006/2279907

/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpur2f9s09.rename_genomes.py
[Thu Nov 23 10:51:52 2023]
Finished job 512.
449 of 759 steps (59%) done
Select jobs to execute...

[Thu Nov 23 10:51:52 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_35-sr/Ecoli_35_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/Ecoli_35.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/Ecoli_35_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/Ecoli_35_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/Ecoli_35_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/Ecoli_35_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/Ecoli_35_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_35.log
    jobid: 511
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/Ecoli_35_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/Ecoli_35_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/Ecoli_35.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/Ecoli_35_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/Ecoli_35_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/Ecoli_35_top_hits_mash_inphared.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_35-sr/Ecoli_35_genome.fasta
    wildcards: sample=Ecoli_35
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_35-sr/Ecoli_35_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_35-sr/Ecoli_35_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Ecoli_35                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_35.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/Ecoli_35_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_35-sr/Ecoli_35_genome.fasta -n Ecoli_35_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr -p Ecoli_35 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:51:53 2023]
Error in rule pharokka_flye:
    jobid: 511
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_35-sr/Ecoli_35_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/Ecoli_35.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/Ecoli_35_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/Ecoli_35_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/Ecoli_35_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/Ecoli_35_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/Ecoli_35_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_35.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_35-sr/Ecoli_35_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_35-sr/Ecoli_35_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p Ecoli_35                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_35.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr/Ecoli_35_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_35-sr/Ecoli_35_genome.fasta -n Ecoli_35_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_35-sr -p Ecoli_35 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.Ecoli_35.log not found.

Select jobs to execute...
[Thu Nov 23 10:52:02 2023]
Finished job 275.
450 of 759 steps (59%) done
[Thu Nov 23 10:52:14 2023]
Finished job 68.
451 of 759 steps (59%) done

[Thu Nov 23 10:52:14 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_10_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-1_10.log
    jobid: 86
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.CS-1_10.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_10_S.subsampled.fastq.gz
    wildcards: sample=CS-1_10
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_10_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-1_10.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:52:26 2023]
Finished job 169.
452 of 759 steps (60%) done
Select jobs to execute...

[Thu Nov 23 10:52:26 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_9_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.CS-1_9.log
    jobid: 45
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.CS-1_9.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_9_S.subsampled.fastq.gz
    wildcards: sample=CS-1_9
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_9_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.CS-1_9.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:52:28 2023]
Finished job 45.
453 of 759 steps (60%) done
Select jobs to execute...

[Thu Nov 23 10:52:28 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_9-sr/CS-1_9_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.CS-1_9.log
    jobid: 738
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_9-sr/CS-1_9_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/flye.log
    wildcards: sample=CS-1_9
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_9-sr/CS-1_9-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_9-sr/CS-1_9-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_9-sr/CS-1_9_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_9-sr/CS-1_9_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_9-sr/CS-1_9_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_9-sr/CS-1_9.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_9-sr/CS-1_9_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_9-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_9-sr/CS-1_9.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_9-sr/CS-1_9_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_9-sr/CS-1_9_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_9-sr/CS-1_9-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_9-sr/CS-1_9_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_9-sr/CS-1_9-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_9-sr/CS-1_9_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_9-sr/CS-1_9-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_9-sr/CS-1_9_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_9-sr/CS-1_9_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_9-sr/CS-1_9_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_9-sr/CS-1_9-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_9-sr/CS-1_9_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_9-sr/CS-1_9-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_9-sr/CS-1_9_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_9-sr/CS-1_9-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_9-sr/CS-1_9_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_9-sr/CS-1_9_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_9-sr/CS-1_9_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_9-sr/CS-1_9_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_9-sr/CS-1_9_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_9-sr/CS-1_9_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_9-sr/CS-1_9_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_9-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_9-sr/CS-1_9_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_9-sr/CS-1_9_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_9-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_9-sr/CS-1_9_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_9-sr/CS-1_9_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_9-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_9-sr/CS-1_9_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_9-sr/CS-1_9_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_9-sr/CS-1_9_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_9-sr/CS-1_9_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_9-sr/CS-1_9_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: CS-1_9" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_9-sr/CS-1_9_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_9-sr/CS-1_9_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: CS-1_9" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_9-sr/CS-1_9_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_9-sr/CS-1_9_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: CS-1_9" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_9-sr/CS-1_9_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_9-sr/CS-1_9_summary.txt
        fi
        

[Thu Nov 23 10:52:28 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.CS-1_9.log
    jobid: 213
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.CS-1_9.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly.fasta
    wildcards: sample=CS-1_9
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.CS-1_9.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_

[Thu Nov 23 10:52:28 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.CS-1_9.log
    jobid: 297
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.CS-1_9.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly.fasta
    wildcards: sample=CS-1_9
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.CS-1_9.log
        fi
        
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_

[Thu Nov 23 10:52:28 2023]
rule join_assembly_stats_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/graph_seq_details_flye.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/checkv/quality_summary.tsv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/CS-1_10-assembly-stats_flye.csv
    jobid: 338
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/CS-1_10-assembly-stats_flye.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/assembly_result_table.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/checkv/quality_summary.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/graph_seq_details_flye.tsv
    wildcards: sample=CS-1_10
    resources: tmpdir=/local/nala0006/2279907

[Thu Nov 23 10:52:28 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.CS-1_9.log
    jobid: 214
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.CS-1_9.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly.fasta
    wildcards: sample=CS-1_9
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:52:28 2023]
Finished job 738.
454 of 759 steps (60%) done
Select jobs to execute...
Waiting at most 5 seconds for missing files.
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmptlgeqqsj.joining_stats.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpg20nsw0v.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
MissingOutputException in rule viralverify_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.viralverify.smk, line 37:
Job 213  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly_result_table.csv
Waiting at most 5 seconds for missing files.
MissingOutputException in rule checkv_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.checkv.smk, line 38:
Job 297  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/checkv/quality_summary.tsv
[Thu Nov 23 10:52:38 2023]
Finished job 214.
455 of 759 steps (60%) done
[Thu Nov 23 10:52:38 2023]
Finished job 338.
456 of 759 steps (60%) done

[Thu Nov 23 10:52:38 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_9_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-1_9.log
    jobid: 108
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.CS-1_9.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_9_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly.fasta
    wildcards: sample=CS-1_9
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_9_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-1_9.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/consensus.fasta
        fi
        
Select jobs to execute...
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:52:41 2023]
Error in rule medaka:
    jobid: 108
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_9_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-1_9.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_9_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-1_9.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/consensus.fasta
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-1_9.log:
================================================================================
[10:52:40 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmp6_0011ma.
[10:52:41 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmpbbn0gw4c.
Creating fai index file /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly.fasta.fai
[faidx] Could not build fai index /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_9-sr/assembly.fasta.fai
================================================================================


[Thu Nov 23 10:52:41 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_25_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Ec_25.log
    jobid: 22
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Ec_25.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly_graph.gfa; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_25_S.subsampled.fastq.gz
    wildcards: sample=Ec_25
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_25_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Ec_25.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:52:42 2023]
Finished job 22.
457 of 759 steps (60%) done
Select jobs to execute...

[Thu Nov 23 10:52:42 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_25-sr/Ec_25_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Ec_25.log
    jobid: 715
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_25-sr/Ec_25_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/flye.log
    wildcards: sample=Ec_25
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ec_25-sr/Ec_25-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ec_25-sr/Ec_25-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ec_25-sr/Ec_25_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ec_25-sr/Ec_25_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_25-sr/Ec_25_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ec_25-sr/Ec_25.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_25-sr/Ec_25_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ec_25-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_25-sr/Ec_25.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ec_25-sr/Ec_25_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_25-sr/Ec_25_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ec_25-sr/Ec_25-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_25-sr/Ec_25_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ec_25-sr/Ec_25-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_25-sr/Ec_25_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ec_25-sr/Ec_25-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_25-sr/Ec_25_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ec_25-sr/Ec_25_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_25-sr/Ec_25_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ec_25-sr/Ec_25-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_25-sr/Ec_25_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ec_25-sr/Ec_25-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_25-sr/Ec_25_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ec_25-sr/Ec_25-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_25-sr/Ec_25_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ec_25-sr/Ec_25_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_25-sr/Ec_25_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ec_25-sr/Ec_25_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_25-sr/Ec_25_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ec_25-sr/Ec_25_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_25-sr/Ec_25_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ec_25-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_25-sr/Ec_25_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_25-sr/Ec_25_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ec_25-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_25-sr/Ec_25_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_25-sr/Ec_25_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ec_25-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_25-sr/Ec_25_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_25-sr/Ec_25_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ec_25-sr/Ec_25_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_25-sr/Ec_25_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_25-sr/Ec_25_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Ec_25" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_25-sr/Ec_25_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_25-sr/Ec_25_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Ec_25" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_25-sr/Ec_25_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_25-sr/Ec_25_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Ec_25" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_25-sr/Ec_25_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ec_25-sr/Ec_25_summary.txt
        fi
        

[Thu Nov 23 10:52:42 2023]
localrule genomes_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/CS-1_10-assembly-stats_flye.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_10-sr/CS-1_10-genome-candidates.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/picking_contigs.CS-1_10.log
    jobid: 422
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_10-sr/CS-1_10-genome-candidates.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/CS-1_10-assembly-stats_flye.csv
    wildcards: sample=CS-1_10
    resources: tmpdir=/local/nala0006/2279907

[Thu Nov 23 10:52:42 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Ec_25.log
    jobid: 168
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Ec_25.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly_graph.gfa
    wildcards: sample=Ec_25
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_

[Thu Nov 23 10:52:42 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Ec_25.log
    jobid: 167
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Ec_25.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly.fasta
    wildcards: sample=Ec_25
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Ec_25.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_

Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_
[Thu Nov 23 10:52:42 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Ec_25.log
    jobid: 274
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Ec_25.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly.fasta
    wildcards: sample=Ec_25
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Ec_25.log
        fi
        
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_
[Thu Nov 23 10:52:42 2023]
Finished job 715.
458 of 759 steps (60%) done
Select jobs to execute...
Waiting at most 5 seconds for missing files.
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpj0ith5hv.pick_phage_contigs.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpyrlx8ujx.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
MissingOutputException in rule viralverify_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.viralverify.smk, line 37:
Job 167  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly_result_table.csv
Waiting at most 5 seconds for missing files.
MissingOutputException in rule checkv_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.checkv.smk, line 38:
Job 274  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/checkv/quality_summary.tsv
[Thu Nov 23 10:52:53 2023]
Finished job 168.
459 of 759 steps (60%) done
[Thu Nov 23 10:52:53 2023]
Finished job 422.
460 of 759 steps (61%) done
[Thu Nov 23 10:52:53 2023]
Finished job 86.
461 of 759 steps (61%) done

[Thu Nov 23 10:52:53 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_06_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bu_06.log
    jobid: 60
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Bu_06.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly_info.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_06_S.subsampled.fastq.gz
    wildcards: sample=Bu_06
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_06_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bu_06.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_

[Thu Nov 23 10:52:53 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_25_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ec_25.log
    jobid: 85
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Ec_25.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_25_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly.fasta
    wildcards: sample=Ec_25
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_25_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ec_25.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/consensus.fasta
        fi
        
Select jobs to execute...
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:52:54 2023]
Finished job 60.
462 of 759 steps (61%) done

[Thu Nov 23 10:52:54 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_06-sr/Bu_06_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Bu_06.log
    jobid: 753
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_06-sr/Bu_06_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/flye.log
    wildcards: sample=Bu_06
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_06-sr/Bu_06-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_06-sr/Bu_06-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_06-sr/Bu_06_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_06-sr/Bu_06_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_06-sr/Bu_06_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_06-sr/Bu_06.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_06-sr/Bu_06_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_06-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_06-sr/Bu_06.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_06-sr/Bu_06_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_06-sr/Bu_06_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_06-sr/Bu_06-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_06-sr/Bu_06_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_06-sr/Bu_06-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_06-sr/Bu_06_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_06-sr/Bu_06-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_06-sr/Bu_06_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_06-sr/Bu_06_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_06-sr/Bu_06_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_06-sr/Bu_06-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_06-sr/Bu_06_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_06-sr/Bu_06-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_06-sr/Bu_06_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_06-sr/Bu_06-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_06-sr/Bu_06_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_06-sr/Bu_06_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_06-sr/Bu_06_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_06-sr/Bu_06_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_06-sr/Bu_06_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_06-sr/Bu_06_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_06-sr/Bu_06_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_06-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_06-sr/Bu_06_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_06-sr/Bu_06_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_06-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_06-sr/Bu_06_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_06-sr/Bu_06_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_06-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_06-sr/Bu_06_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_06-sr/Bu_06_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_06-sr/Bu_06_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_06-sr/Bu_06_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_06-sr/Bu_06_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Bu_06" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_06-sr/Bu_06_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_06-sr/Bu_06_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Bu_06" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_06-sr/Bu_06_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_06-sr/Bu_06_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Bu_06" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_06-sr/Bu_06_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_06-sr/Bu_06_summary.txt
        fi
        

[Thu Nov 23 10:52:54 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Bu_06.log
    jobid: 244
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Bu_06.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly_info.txt
    wildcards: sample=Bu_06
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:52:54 2023]
rule genomes_extract_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_10-sr/CS-1_10-genome-candidates.csv
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_10-sr/CS-1_10.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/samtools.CS-1_10.log
    jobid: 421
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_10-sr/CS-1_10.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_10-sr/CS-1_10-genome-candidates.csv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/assembly.fasta
    wildcards: sample=CS-1_10
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        #get the contig or contigs name from the csv file, and run samtools 
        awk -F, 'NR>1 {print $2}' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_10-sr/CS-1_10-genome-candidates.csv > ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_10-sr/phage-genome-contig

        touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_10-sr/CS-1_10.fasta
        
        #extracting the contigs from the assembly
        for f in `cat ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_10-sr/phage-genome-contig`; do samtools faidx ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_10-sr/assembly.fasta "$f" >> ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_10-sr/CS-1_10.fasta ; done 
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/88b512fa6c8662e1ee00979df064c0a5_

[Thu Nov 23 10:52:54 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bu_06.log
    jobid: 243
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Bu_06.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly.fasta
    wildcards: sample=Bu_06
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bu_06.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_
[Thu Nov 23 10:52:54 2023]
Finished job 753.
463 of 759 steps (61%) done
Select jobs to execute...

[Thu Nov 23 10:52:54 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bu_06.log
    jobid: 312
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Bu_06.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly.fasta
    wildcards: sample=Bu_06
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bu_06.log
        fi
        
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_
Waiting at most 5 seconds for missing files.
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp31z8md0c.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:52:55 2023]
Error in rule medaka:
    jobid: 85
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_25_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ec_25.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ec_25_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ec_25.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/consensus.fasta
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ec_25.log:
================================================================================
[10:52:55 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmpjrsvh_d8.
[10:52:55 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmpzv815w_a.
Creating fai index file /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly.fasta.fai
[faidx] Could not build fai index /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ec_25-sr/assembly.fasta.fai
================================================================================

MissingOutputException in rule viralverify_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.viralverify.smk, line 37:
Job 243  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly_result_table.csv
Select jobs to execute...
[Thu Nov 23 10:52:59 2023]
Finished job 421.
464 of 759 steps (61%) done
Waiting at most 5 seconds for missing files.
MissingOutputException in rule checkv_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.checkv.smk, line 38:
Job 312  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/checkv/quality_summary.tsv
[Thu Nov 23 10:53:04 2023]
Finished job 244.
465 of 759 steps (61%) done

[Thu Nov 23 10:53:04 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_26_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Ecoli_26.log
    jobid: 17
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Ecoli_26.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly_graph.gfa; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_26_S.subsampled.fastq.gz
    wildcards: sample=Ecoli_26
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_26_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Ecoli_26.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/flye.log
        fi
        

Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:53:04 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_06_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_06.log
    jobid: 123
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Bu_06.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_06_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly.fasta
    wildcards: sample=Bu_06
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_06_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_06.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/consensus.fasta
        fi
        
Select jobs to execute...
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:53:06 2023]
Finished job 17.
466 of 759 steps (61%) done

[Thu Nov 23 10:53:06 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_26-sr/Ecoli_26_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Ecoli_26.log
    jobid: 710
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_26-sr/Ecoli_26_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/flye.log
    wildcards: sample=Ecoli_26
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_26-sr/Ecoli_26-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_26-sr/Ecoli_26-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_26-sr/Ecoli_26_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_26-sr/Ecoli_26_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_26-sr/Ecoli_26_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_26-sr/Ecoli_26.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_26-sr/Ecoli_26_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_26-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_26-sr/Ecoli_26.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_26-sr/Ecoli_26_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_26-sr/Ecoli_26_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_26-sr/Ecoli_26-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_26-sr/Ecoli_26_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_26-sr/Ecoli_26-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_26-sr/Ecoli_26_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_26-sr/Ecoli_26-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_26-sr/Ecoli_26_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_26-sr/Ecoli_26_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_26-sr/Ecoli_26_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_26-sr/Ecoli_26-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_26-sr/Ecoli_26_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_26-sr/Ecoli_26-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_26-sr/Ecoli_26_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_26-sr/Ecoli_26-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_26-sr/Ecoli_26_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_26-sr/Ecoli_26_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_26-sr/Ecoli_26_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_26-sr/Ecoli_26_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_26-sr/Ecoli_26_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_26-sr/Ecoli_26_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_26-sr/Ecoli_26_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_26-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_26-sr/Ecoli_26_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_26-sr/Ecoli_26_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_26-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_26-sr/Ecoli_26_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_26-sr/Ecoli_26_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_26-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_26-sr/Ecoli_26_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_26-sr/Ecoli_26_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_26-sr/Ecoli_26_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_26-sr/Ecoli_26_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_26-sr/Ecoli_26_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Ecoli_26" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_26-sr/Ecoli_26_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_26-sr/Ecoli_26_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Ecoli_26" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_26-sr/Ecoli_26_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_26-sr/Ecoli_26_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Ecoli_26" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_26-sr/Ecoli_26_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_26-sr/Ecoli_26_summary.txt
        fi
        

[Thu Nov 23 10:53:06 2023]
localrule rename_contigs_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_10-sr/CS-1_10.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_10-sr/CS-1_10_genome.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_10-sr/CS-1_10_temp.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/rename-contigs.CS-1_10.log
    jobid: 548
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_10-sr/CS-1_10_genome.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_10-sr/CS-1_10.fasta
    wildcards: sample=CS-1_10
    resources: tmpdir=/local/nala0006/2279907

[Thu Nov 23 10:53:06 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Ecoli_26.log
    jobid: 269
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Ecoli_26.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly.fasta
    wildcards: sample=Ecoli_26
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Ecoli_26.log
        fi
        
/home/nala0006/miniconda3/envs/sphae/bin/python3.11 /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpke0i3c2p.rename_genomes.py
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_

[Thu Nov 23 10:53:06 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Ecoli_26.log
    jobid: 157
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Ecoli_26.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly.fasta
    wildcards: sample=Ecoli_26
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Ecoli_26.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_

[Thu Nov 23 10:53:06 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Ecoli_26.log
    jobid: 158
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Ecoli_26.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly_graph.gfa
    wildcards: sample=Ecoli_26
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:53:06 2023]
Finished job 710.
467 of 759 steps (62%) done
Select jobs to execute...
[Thu Nov 23 10:53:06 2023]
Finished job 548.
468 of 759 steps (62%) done

[Thu Nov 23 10:53:06 2023]
rule pharokka_flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_10-sr/CS-1_10_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/CS-1_10.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/CS-1_10_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/CS-1_10_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/CS-1_10_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/CS-1_10_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/CS-1_10_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.CS-1_10.log
    jobid: 547
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/CS-1_10_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/CS-1_10_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/CS-1_10.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/CS-1_10_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/CS-1_10_length_gc_cds_density.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/CS-1_10_pharokka_plot.png; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_10-sr/CS-1_10_genome.fasta
    wildcards: sample=CS-1_10
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_10-sr/CS-1_10_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_10-sr/CS-1_10_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p CS-1_10                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.CS-1_10.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/CS-1_10_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_10-sr/CS-1_10_genome.fasta -n CS-1_10_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr -p CS-1_10 -f
        fi
        
Activating conda environment: sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
Waiting at most 5 seconds for missing files.
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp1y0uz9q5.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
/usr/bin/bash: -c: line 1: syntax error in conditional expression: unexpected token `;'
[Thu Nov 23 10:53:06 2023]
Error in rule pharokka_flye:
    jobid: 547
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_10-sr/CS-1_10_genome.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/CS-1_10.gbk, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/CS-1_10_pharokka_plot.png, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/top_hits_card.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/top_hits_vfdb.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/CS-1_10_minced_spacers.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/CS-1_10_top_hits_mash_inphared.tsv, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/CS-1_10_dnaapler_reoriented.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/CS-1_10_length_gc_cds_density.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.CS-1_10.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/0795089d14530694325b61c8ef787c16_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_10-sr/CS-1_10_genome.fasta]]; then
            pharokka.py                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_10-sr/CS-1_10_genome.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr                 -d /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/pharokka_db                 -t 8                 --dnaapler                 -f -p CS-1_10                2> ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.CS-1_10.log

            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr/CS-1_10_dnaapler_reoriented.fasta

            pharokka_plotter.py -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_10-sr/CS-1_10_genome.fasta -n CS-1_10_pharokka_plot -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_10-sr -p CS-1_10 -f
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/pharokka.CS-1_10.log not found.

[Thu Nov 23 10:53:07 2023]
Error in rule medaka:
    jobid: 123
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_06_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_06.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_06_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_06.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/consensus.fasta
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_06.log:
================================================================================
[10:53:06 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmpwqrt47iv.
[10:53:07 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmpyec3mxir.
Creating fai index file /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly.fasta.fai
[faidx] Could not build fai index /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_06-sr/assembly.fasta.fai
================================================================================

MissingOutputException in rule viralverify_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.viralverify.smk, line 37:
Job 157  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly_result_table.csv
Waiting at most 5 seconds for missing files.
MissingOutputException in rule checkv_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.checkv.smk, line 38:
Job 269  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/checkv/quality_summary.tsv
Select jobs to execute...
[Thu Nov 23 10:53:16 2023]
Finished job 158.
469 of 759 steps (62%) done

[Thu Nov 23 10:53:16 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_26_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ecoli_26.log
    jobid: 80
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Ecoli_26.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_26_S.subsampled.fastq.gz
    wildcards: sample=Ecoli_26
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_26_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ecoli_26.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_

[Thu Nov 23 10:53:16 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_39_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Ecoli_39.log
    jobid: 35
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Ecoli_39.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly_graph.gfa; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_39_S.subsampled.fastq.gz
    wildcards: sample=Ecoli_39
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_39_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Ecoli_39.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/flye.log
        fi
        
Select jobs to execute...
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:53:17 2023]
Finished job 35.
470 of 759 steps (62%) done

[Thu Nov 23 10:53:17 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_39-sr/Ecoli_39_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Ecoli_39.log
    jobid: 728
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_39-sr/Ecoli_39_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/flye.log
    wildcards: sample=Ecoli_39
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_39-sr/Ecoli_39-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_39-sr/Ecoli_39-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_39-sr/Ecoli_39_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_39-sr/Ecoli_39_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_39-sr/Ecoli_39_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_39-sr/Ecoli_39.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_39-sr/Ecoli_39_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_39-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_39-sr/Ecoli_39.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_39-sr/Ecoli_39_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_39-sr/Ecoli_39_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_39-sr/Ecoli_39-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_39-sr/Ecoli_39_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_39-sr/Ecoli_39-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_39-sr/Ecoli_39_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_39-sr/Ecoli_39-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_39-sr/Ecoli_39_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_39-sr/Ecoli_39_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_39-sr/Ecoli_39_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_39-sr/Ecoli_39-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_39-sr/Ecoli_39_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_39-sr/Ecoli_39-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_39-sr/Ecoli_39_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_39-sr/Ecoli_39-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_39-sr/Ecoli_39_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_39-sr/Ecoli_39_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_39-sr/Ecoli_39_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_39-sr/Ecoli_39_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_39-sr/Ecoli_39_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_39-sr/Ecoli_39_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_39-sr/Ecoli_39_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_39-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_39-sr/Ecoli_39_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_39-sr/Ecoli_39_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_39-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_39-sr/Ecoli_39_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_39-sr/Ecoli_39_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_39-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_39-sr/Ecoli_39_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_39-sr/Ecoli_39_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_39-sr/Ecoli_39_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_39-sr/Ecoli_39_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_39-sr/Ecoli_39_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Ecoli_39" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_39-sr/Ecoli_39_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_39-sr/Ecoli_39_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Ecoli_39" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_39-sr/Ecoli_39_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_39-sr/Ecoli_39_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Ecoli_39" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_39-sr/Ecoli_39_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_39-sr/Ecoli_39_summary.txt
        fi
        

[Thu Nov 23 10:53:17 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Ecoli_39.log
    jobid: 193
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Ecoli_39.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly.fasta
    wildcards: sample=Ecoli_39
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Ecoli_39.log
        fi
        

Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_
[Thu Nov 23 10:53:17 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Ecoli_39.log
    jobid: 194
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Ecoli_39.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly_graph.gfa
    wildcards: sample=Ecoli_39
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:53:17 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Ecoli_39.log
    jobid: 287
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Ecoli_39.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly.fasta
    wildcards: sample=Ecoli_39
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Ecoli_39.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_
[Thu Nov 23 10:53:17 2023]
Finished job 728.
471 of 759 steps (62%) done
Select jobs to execute...
Waiting at most 5 seconds for missing files.
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp5m63ux8z.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:53:19 2023]
Error in rule medaka:
    jobid: 80
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_26_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ecoli_26.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_26_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ecoli_26.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/consensus.fasta
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ecoli_26.log:
================================================================================
[10:53:18 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmp5e4jfc36.
[10:53:19 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmppffqgjbf.
Creating fai index file /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly.fasta.fai
[faidx] Could not build fai index /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_26-sr/assembly.fasta.fai
================================================================================

MissingOutputException in rule viralverify_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.viralverify.smk, line 37:
Job 193  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly_result_table.csv
Waiting at most 5 seconds for missing files.
MissingOutputException in rule checkv_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.checkv.smk, line 38:
Job 287  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/checkv/quality_summary.tsv
[Thu Nov 23 10:53:27 2023]
Finished job 194.
472 of 759 steps (62%) done

[Thu Nov 23 10:53:27 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_13_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bu_13.log
    jobid: 7
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Bu_13.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_13_S.subsampled.fastq.gz
    wildcards: sample=Bu_13
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_13_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Bu_13.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_

[Thu Nov 23 10:53:27 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_39_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ecoli_39.log
    jobid: 98
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Ecoli_39.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_39_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly.fasta
    wildcards: sample=Ecoli_39
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_39_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ecoli_39.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/consensus.fasta
        fi
        
Select jobs to execute...
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:53:29 2023]
Finished job 7.
473 of 759 steps (62%) done

[Thu Nov 23 10:53:29 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_13-sr/Bu_13_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Bu_13.log
    jobid: 700
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_13-sr/Bu_13_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/flye.log
    wildcards: sample=Bu_13
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_13-sr/Bu_13-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_13-sr/Bu_13-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_13-sr/Bu_13_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_13-sr/Bu_13_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_13-sr/Bu_13_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_13-sr/Bu_13.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_13-sr/Bu_13_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_13-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_13-sr/Bu_13.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_13-sr/Bu_13_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_13-sr/Bu_13_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_13-sr/Bu_13-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_13-sr/Bu_13_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_13-sr/Bu_13-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_13-sr/Bu_13_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_13-sr/Bu_13-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_13-sr/Bu_13_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_13-sr/Bu_13_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_13-sr/Bu_13_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_13-sr/Bu_13-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_13-sr/Bu_13_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_13-sr/Bu_13-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_13-sr/Bu_13_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Bu_13-sr/Bu_13-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_13-sr/Bu_13_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_13-sr/Bu_13_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_13-sr/Bu_13_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_13-sr/Bu_13_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_13-sr/Bu_13_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_13-sr/Bu_13_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_13-sr/Bu_13_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_13-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_13-sr/Bu_13_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_13-sr/Bu_13_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_13-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_13-sr/Bu_13_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_13-sr/Bu_13_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_13-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_13-sr/Bu_13_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_13-sr/Bu_13_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Bu_13-sr/Bu_13_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_13-sr/Bu_13_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_13-sr/Bu_13_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Bu_13" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_13-sr/Bu_13_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_13-sr/Bu_13_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Bu_13" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_13-sr/Bu_13_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_13-sr/Bu_13_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Bu_13" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_13-sr/Bu_13_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Bu_13-sr/Bu_13_summary.txt
        fi
        

[Thu Nov 23 10:53:29 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bu_13.log
    jobid: 137
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Bu_13.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly.fasta
    wildcards: sample=Bu_13
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Bu_13.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_

[Thu Nov 23 10:53:29 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Bu_13.log
    jobid: 138
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Bu_13.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly.fasta
    wildcards: sample=Bu_13
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:53:29 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bu_13.log
    jobid: 259
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Bu_13.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly.fasta
    wildcards: sample=Bu_13
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Bu_13.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_
[Thu Nov 23 10:53:29 2023]
Finished job 700.
474 of 759 steps (62%) done
Select jobs to execute...
Waiting at most 5 seconds for missing files.
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmppya81nvl.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:53:30 2023]
Error in rule medaka:
    jobid: 98
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_39_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ecoli_39.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_39_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ecoli_39.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/consensus.fasta
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ecoli_39.log:
================================================================================
[10:53:30 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmpnoged9kx.
[10:53:30 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmpwnnyo2xj.
Creating fai index file /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly.fasta.fai
[faidx] Could not build fai index /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_39-sr/assembly.fasta.fai
================================================================================

MissingOutputException in rule viralverify_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.viralverify.smk, line 37:
Job 137  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly_result_table.csv
Waiting at most 5 seconds for missing files.
MissingOutputException in rule checkv_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.checkv.smk, line 38:
Job 259  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/checkv/quality_summary.tsv
[Thu Nov 23 10:53:39 2023]
Finished job 138.
475 of 759 steps (63%) done

[Thu Nov 23 10:53:39 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_7_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.CS-1_7.log
    jobid: 19
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.CS-1_7.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly_info.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_7_S.subsampled.fastq.gz
    wildcards: sample=CS-1_7
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_7_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.CS-1_7.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_

[Thu Nov 23 10:53:39 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_13_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_13.log
    jobid: 70
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Bu_13.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_13_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly.fasta
    wildcards: sample=Bu_13
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_13_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_13.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/consensus.fasta
        fi
        
Select jobs to execute...
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:53:40 2023]
Finished job 19.
476 of 759 steps (63%) done

[Thu Nov 23 10:53:40 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_7-sr/CS-1_7_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.CS-1_7.log
    jobid: 712
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_7-sr/CS-1_7_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/flye.log
    wildcards: sample=CS-1_7
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_7-sr/CS-1_7-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_7-sr/CS-1_7-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_7-sr/CS-1_7_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_7-sr/CS-1_7_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_7-sr/CS-1_7_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_7-sr/CS-1_7.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_7-sr/CS-1_7_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_7-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_7-sr/CS-1_7.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_7-sr/CS-1_7_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_7-sr/CS-1_7_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_7-sr/CS-1_7-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_7-sr/CS-1_7_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_7-sr/CS-1_7-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_7-sr/CS-1_7_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_7-sr/CS-1_7-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_7-sr/CS-1_7_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_7-sr/CS-1_7_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_7-sr/CS-1_7_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_7-sr/CS-1_7-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_7-sr/CS-1_7_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_7-sr/CS-1_7-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_7-sr/CS-1_7_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_7-sr/CS-1_7-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_7-sr/CS-1_7_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_7-sr/CS-1_7_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_7-sr/CS-1_7_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_7-sr/CS-1_7_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_7-sr/CS-1_7_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_7-sr/CS-1_7_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_7-sr/CS-1_7_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_7-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_7-sr/CS-1_7_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_7-sr/CS-1_7_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_7-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_7-sr/CS-1_7_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_7-sr/CS-1_7_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_7-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_7-sr/CS-1_7_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_7-sr/CS-1_7_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_7-sr/CS-1_7_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_7-sr/CS-1_7_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_7-sr/CS-1_7_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: CS-1_7" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_7-sr/CS-1_7_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_7-sr/CS-1_7_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: CS-1_7" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_7-sr/CS-1_7_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_7-sr/CS-1_7_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: CS-1_7" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_7-sr/CS-1_7_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_7-sr/CS-1_7_summary.txt
        fi
        

[Thu Nov 23 10:53:40 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.CS-1_7.log
    jobid: 161
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.CS-1_7.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly.fasta
    wildcards: sample=CS-1_7
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.CS-1_7.log
        fi
        

Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_
[Thu Nov 23 10:53:40 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.CS-1_7.log
    jobid: 162
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.CS-1_7.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly_info.txt
    wildcards: sample=CS-1_7
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:53:40 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.CS-1_7.log
    jobid: 271
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.CS-1_7.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly.fasta
    wildcards: sample=CS-1_7
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.CS-1_7.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_
[Thu Nov 23 10:53:40 2023]
Finished job 712.
477 of 759 steps (63%) done
Select jobs to execute...
Waiting at most 5 seconds for missing files.
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp53kr_v9t.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:53:42 2023]
Error in rule medaka:
    jobid: 70
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_13_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_13.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Bu_13_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_13.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/consensus.fasta
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Bu_13.log:
================================================================================
[10:53:41 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmppl_imow2.
[10:53:42 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmpbz1ud6q8.
Creating fai index file /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly.fasta.fai
[faidx] Could not build fai index /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Bu_13-sr/assembly.fasta.fai
================================================================================

MissingOutputException in rule viralverify_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.viralverify.smk, line 37:
Job 161  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly_result_table.csv
Waiting at most 5 seconds for missing files.
MissingOutputException in rule checkv_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.checkv.smk, line 38:
Job 271  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/checkv/quality_summary.tsv
[Thu Nov 23 10:53:51 2023]
Finished job 162.
478 of 759 steps (63%) done

[Thu Nov 23 10:53:51 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_6_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.CS-1_6.log
    jobid: 32
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.CS-1_6.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/flye.log; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_6_S.subsampled.fastq.gz
    wildcards: sample=CS-1_6
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_6_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.CS-1_6.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_

[Thu Nov 23 10:53:51 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_7_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-1_7.log
    jobid: 82
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.CS-1_7.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_7_S.subsampled.fastq.gz
    wildcards: sample=CS-1_7
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_7_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-1_7.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/consensus.fasta
        fi
        
Select jobs to execute...
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:53:52 2023]
Finished job 32.
479 of 759 steps (63%) done

[Thu Nov 23 10:53:52 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_6-sr/CS-1_6_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.CS-1_6.log
    jobid: 725
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_6-sr/CS-1_6_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/flye.log
    wildcards: sample=CS-1_6
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_6-sr/CS-1_6-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_6-sr/CS-1_6-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_6-sr/CS-1_6_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_6-sr/CS-1_6_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_6-sr/CS-1_6_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_6-sr/CS-1_6.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_6-sr/CS-1_6_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_6-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_6-sr/CS-1_6.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_6-sr/CS-1_6_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_6-sr/CS-1_6_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_6-sr/CS-1_6-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_6-sr/CS-1_6_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_6-sr/CS-1_6-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_6-sr/CS-1_6_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_6-sr/CS-1_6-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_6-sr/CS-1_6_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_6-sr/CS-1_6_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_6-sr/CS-1_6_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_6-sr/CS-1_6-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_6-sr/CS-1_6_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_6-sr/CS-1_6-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_6-sr/CS-1_6_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_6-sr/CS-1_6-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_6-sr/CS-1_6_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_6-sr/CS-1_6_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_6-sr/CS-1_6_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_6-sr/CS-1_6_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_6-sr/CS-1_6_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_6-sr/CS-1_6_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_6-sr/CS-1_6_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_6-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_6-sr/CS-1_6_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_6-sr/CS-1_6_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_6-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_6-sr/CS-1_6_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_6-sr/CS-1_6_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_6-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_6-sr/CS-1_6_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_6-sr/CS-1_6_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_6-sr/CS-1_6_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_6-sr/CS-1_6_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_6-sr/CS-1_6_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: CS-1_6" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_6-sr/CS-1_6_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_6-sr/CS-1_6_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: CS-1_6" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_6-sr/CS-1_6_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_6-sr/CS-1_6_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: CS-1_6" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_6-sr/CS-1_6_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_6-sr/CS-1_6_summary.txt
        fi
        

[Thu Nov 23 10:53:52 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.CS-1_6.log
    jobid: 188
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.CS-1_6.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly_info.txt
    wildcards: sample=CS-1_6
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:53:52 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.CS-1_6.log
    jobid: 284
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.CS-1_6.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly.fasta
    wildcards: sample=CS-1_6
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.CS-1_6.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_

[Thu Nov 23 10:53:52 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.CS-1_6.log
    jobid: 187
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.CS-1_6.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly.fasta
    wildcards: sample=CS-1_6
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.CS-1_6.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_
[Thu Nov 23 10:53:52 2023]
Finished job 725.
480 of 759 steps (63%) done
Select jobs to execute...
Waiting at most 5 seconds for missing files.
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmps8k21cij.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:53:53 2023]
Error in rule medaka:
    jobid: 82
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_7_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-1_7.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_7_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-1_7.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/consensus.fasta
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-1_7.log:
================================================================================
[10:53:53 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmpn3sxl2n6.
[10:53:53 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmpcpty2vww.
Creating fai index file /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly.fasta.fai
[faidx] Could not build fai index /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_7-sr/assembly.fasta.fai
================================================================================

MissingOutputException in rule checkv_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.checkv.smk, line 38:
Job 284  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/checkv/quality_summary.tsv
Waiting at most 5 seconds for missing files.
MissingOutputException in rule viralverify_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.viralverify.smk, line 37:
Job 187  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly_result_table.csv
[Thu Nov 23 10:54:02 2023]
Finished job 188.
481 of 759 steps (63%) done

[Thu Nov 23 10:54:02 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Lg_25_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Lg_25.log
    jobid: 24
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Lg_25.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly_info.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Lg_25_S.subsampled.fastq.gz
    wildcards: sample=Lg_25
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Lg_25_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Lg_25.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_

[Thu Nov 23 10:54:02 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_6_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-1_6.log
    jobid: 95
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.CS-1_6.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_6_S.subsampled.fastq.gz
    wildcards: sample=CS-1_6
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_6_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-1_6.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/consensus.fasta
        fi
        
Select jobs to execute...
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:54:03 2023]
Finished job 24.
482 of 759 steps (64%) done

[Thu Nov 23 10:54:03 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Lg_25-sr/Lg_25_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Lg_25.log
    jobid: 717
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Lg_25-sr/Lg_25_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/flye.log
    wildcards: sample=Lg_25
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Lg_25-sr/Lg_25-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Lg_25-sr/Lg_25-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Lg_25-sr/Lg_25_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Lg_25-sr/Lg_25_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Lg_25-sr/Lg_25_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Lg_25-sr/Lg_25.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Lg_25-sr/Lg_25_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Lg_25-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Lg_25-sr/Lg_25.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Lg_25-sr/Lg_25_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Lg_25-sr/Lg_25_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Lg_25-sr/Lg_25-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Lg_25-sr/Lg_25_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Lg_25-sr/Lg_25-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Lg_25-sr/Lg_25_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Lg_25-sr/Lg_25-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Lg_25-sr/Lg_25_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Lg_25-sr/Lg_25_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Lg_25-sr/Lg_25_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Lg_25-sr/Lg_25-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Lg_25-sr/Lg_25_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Lg_25-sr/Lg_25-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Lg_25-sr/Lg_25_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Lg_25-sr/Lg_25-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Lg_25-sr/Lg_25_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Lg_25-sr/Lg_25_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Lg_25-sr/Lg_25_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Lg_25-sr/Lg_25_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Lg_25-sr/Lg_25_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Lg_25-sr/Lg_25_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Lg_25-sr/Lg_25_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Lg_25-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Lg_25-sr/Lg_25_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Lg_25-sr/Lg_25_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Lg_25-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Lg_25-sr/Lg_25_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Lg_25-sr/Lg_25_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Lg_25-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Lg_25-sr/Lg_25_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Lg_25-sr/Lg_25_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Lg_25-sr/Lg_25_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Lg_25-sr/Lg_25_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Lg_25-sr/Lg_25_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Lg_25" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Lg_25-sr/Lg_25_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Lg_25-sr/Lg_25_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Lg_25" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Lg_25-sr/Lg_25_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Lg_25-sr/Lg_25_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Lg_25" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Lg_25-sr/Lg_25_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Lg_25-sr/Lg_25_summary.txt
        fi
        

[Thu Nov 23 10:54:03 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Lg_25.log
    jobid: 276
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Lg_25.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly.fasta
    wildcards: sample=Lg_25
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Lg_25.log
        fi
        

Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_
[Thu Nov 23 10:54:03 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Lg_25.log
    jobid: 172
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Lg_25.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly_info.txt
    wildcards: sample=Lg_25
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:54:03 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Lg_25.log
    jobid: 171
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Lg_25.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly.fasta
    wildcards: sample=Lg_25
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Lg_25.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_
[Thu Nov 23 10:54:03 2023]
Finished job 717.
483 of 759 steps (64%) done
Select jobs to execute...
Waiting at most 5 seconds for missing files.
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpxu5bbdku.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:54:05 2023]
Error in rule medaka:
    jobid: 95
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_6_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-1_6.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_6_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-1_6.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/consensus.fasta
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-1_6.log:
================================================================================
[10:54:04 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmpdx0qj9x5.
[10:54:05 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmpgmy73057.
Creating fai index file /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly.fasta.fai
[faidx] Could not build fai index /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_6-sr/assembly.fasta.fai
================================================================================

MissingOutputException in rule checkv_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.checkv.smk, line 38:
Job 276  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/checkv/quality_summary.tsv
[Thu Nov 23 10:54:08 2023]
Finished job 172.
484 of 759 steps (64%) done
Waiting at most 5 seconds for missing files.
MissingOutputException in rule viralverify_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.viralverify.smk, line 37:
Job 171  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly_result_table.csv

[Thu Nov 23 10:54:13 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_3_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.CS-1_3.log
    jobid: 62
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.CS-1_3.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_3_S.subsampled.fastq.gz
    wildcards: sample=CS-1_3
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_3_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.CS-1_3.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/flye.log
        fi
        
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_

[Thu Nov 23 10:54:13 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Lg_25_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Lg_25.log
    jobid: 87
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Lg_25.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Lg_25_S.subsampled.fastq.gz
    wildcards: sample=Lg_25
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Lg_25_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Lg_25.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/consensus.fasta
        fi
        
Select jobs to execute...
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:54:14 2023]
Finished job 62.
485 of 759 steps (64%) done

[Thu Nov 23 10:54:14 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_3-sr/CS-1_3_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.CS-1_3.log
    jobid: 755
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_3-sr/CS-1_3_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/flye.log
    wildcards: sample=CS-1_3
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_3-sr/CS-1_3-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_3-sr/CS-1_3-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_3-sr/CS-1_3_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_3-sr/CS-1_3_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_3-sr/CS-1_3_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_3-sr/CS-1_3.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_3-sr/CS-1_3_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_3-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_3-sr/CS-1_3.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_3-sr/CS-1_3_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_3-sr/CS-1_3_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_3-sr/CS-1_3-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_3-sr/CS-1_3_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_3-sr/CS-1_3-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_3-sr/CS-1_3_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_3-sr/CS-1_3-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_3-sr/CS-1_3_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_3-sr/CS-1_3_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_3-sr/CS-1_3_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_3-sr/CS-1_3-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_3-sr/CS-1_3_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_3-sr/CS-1_3-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_3-sr/CS-1_3_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_3-sr/CS-1_3-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_3-sr/CS-1_3_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_3-sr/CS-1_3_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_3-sr/CS-1_3_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_3-sr/CS-1_3_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_3-sr/CS-1_3_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_3-sr/CS-1_3_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_3-sr/CS-1_3_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_3-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_3-sr/CS-1_3_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_3-sr/CS-1_3_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_3-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_3-sr/CS-1_3_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_3-sr/CS-1_3_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_3-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_3-sr/CS-1_3_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_3-sr/CS-1_3_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_3-sr/CS-1_3_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_3-sr/CS-1_3_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_3-sr/CS-1_3_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: CS-1_3" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_3-sr/CS-1_3_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_3-sr/CS-1_3_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: CS-1_3" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_3-sr/CS-1_3_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_3-sr/CS-1_3_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: CS-1_3" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_3-sr/CS-1_3_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_3-sr/CS-1_3_summary.txt
        fi
        

[Thu Nov 23 10:54:14 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.CS-1_3.log
    jobid: 314
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.CS-1_3.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly.fasta
    wildcards: sample=CS-1_3
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.CS-1_3.log
        fi
        
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_

[Thu Nov 23 10:54:14 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.CS-1_3.log
    jobid: 248
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.CS-1_3.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly.fasta
    wildcards: sample=CS-1_3
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:54:14 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.CS-1_3.log
    jobid: 247
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.CS-1_3.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly.fasta
    wildcards: sample=CS-1_3
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.CS-1_3.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:54:14 2023]
Finished job 755.
486 of 759 steps (64%) done
Select jobs to execute...
Waiting at most 5 seconds for missing files.
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmps5nvw_k8.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:54:16 2023]
Error in rule medaka:
    jobid: 87
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Lg_25_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Lg_25.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Lg_25_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Lg_25.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/consensus.fasta
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Lg_25.log:
================================================================================
[10:54:16 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmpnytsslc3.
[10:54:16 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmpd3sht7fy.
Creating fai index file /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly.fasta.fai
[faidx] Could not build fai index /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Lg_25-sr/assembly.fasta.fai
================================================================================

MissingOutputException in rule checkv_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.checkv.smk, line 38:
Job 314  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/checkv/quality_summary.tsv
Waiting at most 5 seconds for missing files.
MissingOutputException in rule viralverify_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.viralverify.smk, line 37:
Job 247  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly_result_table.csv
[Thu Nov 23 10:54:25 2023]
Finished job 248.
487 of 759 steps (64%) done

[Thu Nov 23 10:54:25 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_3_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-1_3.log
    jobid: 125
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.CS-1_3.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_3_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly.fasta
    wildcards: sample=CS-1_3
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_3_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-1_3.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_

[Thu Nov 23 10:54:25 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_1_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.CS-1_1.log
    jobid: 31
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.CS-1_1.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly_info.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_1_S.subsampled.fastq.gz
    wildcards: sample=CS-1_1
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_1_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.CS-1_1.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/flye.log
        fi
        
Select jobs to execute...
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:54:26 2023]
Finished job 31.
488 of 759 steps (64%) done

[Thu Nov 23 10:54:26 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_1-sr/CS-1_1_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.CS-1_1.log
    jobid: 724
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_1-sr/CS-1_1_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/flye.log
    wildcards: sample=CS-1_1
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_1-sr/CS-1_1-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_1-sr/CS-1_1-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_1-sr/CS-1_1_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_1-sr/CS-1_1_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_1-sr/CS-1_1_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_1-sr/CS-1_1.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_1-sr/CS-1_1_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_1-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_1-sr/CS-1_1.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_1-sr/CS-1_1_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_1-sr/CS-1_1_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_1-sr/CS-1_1-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_1-sr/CS-1_1_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_1-sr/CS-1_1-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_1-sr/CS-1_1_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_1-sr/CS-1_1-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_1-sr/CS-1_1_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_1-sr/CS-1_1_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_1-sr/CS-1_1_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_1-sr/CS-1_1-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_1-sr/CS-1_1_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_1-sr/CS-1_1-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_1-sr/CS-1_1_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_1-sr/CS-1_1-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_1-sr/CS-1_1_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_1-sr/CS-1_1_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_1-sr/CS-1_1_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_1-sr/CS-1_1_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_1-sr/CS-1_1_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_1-sr/CS-1_1_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_1-sr/CS-1_1_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_1-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_1-sr/CS-1_1_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_1-sr/CS-1_1_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_1-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_1-sr/CS-1_1_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_1-sr/CS-1_1_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_1-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_1-sr/CS-1_1_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_1-sr/CS-1_1_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_1-sr/CS-1_1_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_1-sr/CS-1_1_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_1-sr/CS-1_1_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: CS-1_1" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_1-sr/CS-1_1_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_1-sr/CS-1_1_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: CS-1_1" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_1-sr/CS-1_1_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_1-sr/CS-1_1_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: CS-1_1" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_1-sr/CS-1_1_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_1-sr/CS-1_1_summary.txt
        fi
        

[Thu Nov 23 10:54:26 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.CS-1_1.log
    jobid: 185
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.CS-1_1.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly.fasta
    wildcards: sample=CS-1_1
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.CS-1_1.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_

[Thu Nov 23 10:54:26 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.CS-1_1.log
    jobid: 186
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.CS-1_1.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly_info.txt
    wildcards: sample=CS-1_1
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:54:26 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.CS-1_1.log
    jobid: 283
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.CS-1_1.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly.fasta
    wildcards: sample=CS-1_1
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.CS-1_1.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_
[Thu Nov 23 10:54:26 2023]
Finished job 724.
489 of 759 steps (64%) done
Select jobs to execute...
Waiting at most 5 seconds for missing files.
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmposl50t4p.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:54:28 2023]
Error in rule medaka:
    jobid: 125
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_3_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-1_3.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_3_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-1_3.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/consensus.fasta
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-1_3.log:
================================================================================
[10:54:27 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmpbh9mlct2.
[10:54:28 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmpt9ixwfbk.
Creating fai index file /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly.fasta.fai
[faidx] Could not build fai index /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_3-sr/assembly.fasta.fai
================================================================================

MissingOutputException in rule viralverify_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.viralverify.smk, line 37:
Job 185  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly_result_table.csv
Waiting at most 5 seconds for missing files.
MissingOutputException in rule checkv_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.checkv.smk, line 38:
Job 283  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/checkv/quality_summary.tsv
[Thu Nov 23 10:54:36 2023]
Finished job 186.
490 of 759 steps (65%) done

[Thu Nov 23 10:54:36 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_8_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.CS-1_8.log
    jobid: 48
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.CS-1_8.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly_info.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_8_S.subsampled.fastq.gz
    wildcards: sample=CS-1_8
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_8_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.CS-1_8.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/flye.log
        fi
        

Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:54:36 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_1_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-1_1.log
    jobid: 94
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.CS-1_1.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_1_S.subsampled.fastq.gz
    wildcards: sample=CS-1_1
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_1_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-1_1.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/consensus.fasta
        fi
        
Select jobs to execute...
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:54:37 2023]
Finished job 48.
491 of 759 steps (65%) done

[Thu Nov 23 10:54:37 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_8-sr/CS-1_8_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.CS-1_8.log
    jobid: 741
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_8-sr/CS-1_8_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/flye.log
    wildcards: sample=CS-1_8
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_8-sr/CS-1_8-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_8-sr/CS-1_8-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_8-sr/CS-1_8_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_8-sr/CS-1_8_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_8-sr/CS-1_8_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_8-sr/CS-1_8.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_8-sr/CS-1_8_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_8-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_8-sr/CS-1_8.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_8-sr/CS-1_8_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_8-sr/CS-1_8_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_8-sr/CS-1_8-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_8-sr/CS-1_8_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_8-sr/CS-1_8-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_8-sr/CS-1_8_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_8-sr/CS-1_8-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_8-sr/CS-1_8_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_8-sr/CS-1_8_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_8-sr/CS-1_8_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_8-sr/CS-1_8-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_8-sr/CS-1_8_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_8-sr/CS-1_8-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_8-sr/CS-1_8_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_8-sr/CS-1_8-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_8-sr/CS-1_8_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_8-sr/CS-1_8_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_8-sr/CS-1_8_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_8-sr/CS-1_8_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_8-sr/CS-1_8_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_8-sr/CS-1_8_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_8-sr/CS-1_8_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_8-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_8-sr/CS-1_8_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_8-sr/CS-1_8_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_8-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_8-sr/CS-1_8_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_8-sr/CS-1_8_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_8-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_8-sr/CS-1_8_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_8-sr/CS-1_8_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_8-sr/CS-1_8_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_8-sr/CS-1_8_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_8-sr/CS-1_8_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: CS-1_8" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_8-sr/CS-1_8_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_8-sr/CS-1_8_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: CS-1_8" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_8-sr/CS-1_8_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_8-sr/CS-1_8_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: CS-1_8" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_8-sr/CS-1_8_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_8-sr/CS-1_8_summary.txt
        fi
        

[Thu Nov 23 10:54:37 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.CS-1_8.log
    jobid: 220
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.CS-1_8.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly_info.txt
    wildcards: sample=CS-1_8
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:54:37 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.CS-1_8.log
    jobid: 300
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.CS-1_8.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly.fasta
    wildcards: sample=CS-1_8
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.CS-1_8.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_

[Thu Nov 23 10:54:37 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.CS-1_8.log
    jobid: 219
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.CS-1_8.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly.fasta
    wildcards: sample=CS-1_8
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.CS-1_8.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_
[Thu Nov 23 10:54:37 2023]
Finished job 741.
492 of 759 steps (65%) done
Select jobs to execute...
Waiting at most 5 seconds for missing files.
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp8bwjzxs4.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:54:39 2023]
Error in rule medaka:
    jobid: 94
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_1_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-1_1.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_1_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-1_1.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/consensus.fasta
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-1_1.log:
================================================================================
[10:54:38 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmp0dw2tkda.
[10:54:39 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmpc6laaluo.
Creating fai index file /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly.fasta.fai
[faidx] Could not build fai index /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_1-sr/assembly.fasta.fai
================================================================================

MissingOutputException in rule checkv_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.checkv.smk, line 38:
Job 300  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/checkv/quality_summary.tsv
Waiting at most 5 seconds for missing files.
MissingOutputException in rule viralverify_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.viralverify.smk, line 37:
Job 219  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly_result_table.csv
[Thu Nov 23 10:54:47 2023]
Finished job 220.
493 of 759 steps (65%) done

[Thu Nov 23 10:54:47 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_8_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-1_8.log
    jobid: 111
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.CS-1_8.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_8_S.subsampled.fastq.gz
    wildcards: sample=CS-1_8
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_8_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-1_8.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_

[Thu Nov 23 10:54:47 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_4_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.CS-1_4.log
    jobid: 51
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.CS-1_4.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_4_S.subsampled.fastq.gz
    wildcards: sample=CS-1_4
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_4_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.CS-1_4.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/flye.log
        fi
        
Select jobs to execute...
Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:54:48 2023]
Finished job 51.
494 of 759 steps (65%) done

[Thu Nov 23 10:54:48 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_4-sr/CS-1_4_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.CS-1_4.log
    jobid: 744
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_4-sr/CS-1_4_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/flye.log
    wildcards: sample=CS-1_4
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_4-sr/CS-1_4-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_4-sr/CS-1_4-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_4-sr/CS-1_4_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_4-sr/CS-1_4_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_4-sr/CS-1_4_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_4-sr/CS-1_4.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_4-sr/CS-1_4_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_4-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_4-sr/CS-1_4.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_4-sr/CS-1_4_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_4-sr/CS-1_4_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_4-sr/CS-1_4-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_4-sr/CS-1_4_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_4-sr/CS-1_4-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_4-sr/CS-1_4_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_4-sr/CS-1_4-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_4-sr/CS-1_4_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_4-sr/CS-1_4_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_4-sr/CS-1_4_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_4-sr/CS-1_4-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_4-sr/CS-1_4_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_4-sr/CS-1_4-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_4-sr/CS-1_4_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/CS-1_4-sr/CS-1_4-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_4-sr/CS-1_4_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_4-sr/CS-1_4_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_4-sr/CS-1_4_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_4-sr/CS-1_4_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_4-sr/CS-1_4_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_4-sr/CS-1_4_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_4-sr/CS-1_4_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_4-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_4-sr/CS-1_4_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_4-sr/CS-1_4_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_4-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_4-sr/CS-1_4_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_4-sr/CS-1_4_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_4-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_4-sr/CS-1_4_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_4-sr/CS-1_4_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/CS-1_4-sr/CS-1_4_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_4-sr/CS-1_4_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_4-sr/CS-1_4_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: CS-1_4" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_4-sr/CS-1_4_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_4-sr/CS-1_4_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: CS-1_4" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_4-sr/CS-1_4_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_4-sr/CS-1_4_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: CS-1_4" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_4-sr/CS-1_4_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/CS-1_4-sr/CS-1_4_summary.txt
        fi
        

[Thu Nov 23 10:54:48 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.CS-1_4.log
    jobid: 225
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.CS-1_4.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly.fasta
    wildcards: sample=CS-1_4
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.CS-1_4.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_

[Thu Nov 23 10:54:48 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.CS-1_4.log
    jobid: 226
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.CS-1_4.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly.fasta
    wildcards: sample=CS-1_4
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

[Thu Nov 23 10:54:48 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.CS-1_4.log
    jobid: 303
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.CS-1_4.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly.fasta
    wildcards: sample=CS-1_4
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.CS-1_4.log
        fi
        
python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_
[Thu Nov 23 10:54:48 2023]
Finished job 744.
495 of 759 steps (65%) done
Select jobs to execute...
Waiting at most 5 seconds for missing files.
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmpmpipmf8_.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:54:50 2023]
Error in rule medaka:
    jobid: 111
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_8_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-1_8.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_8_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-1_8.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/consensus.fasta
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-1_8.log:
================================================================================
[10:54:50 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmplv3t9rle.
[10:54:50 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmp590xdvmu.
Creating fai index file /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly.fasta.fai
[faidx] Could not build fai index /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_8-sr/assembly.fasta.fai
================================================================================

MissingOutputException in rule viralverify_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.viralverify.smk, line 37:
Job 225  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly_result_table.csv
Waiting at most 5 seconds for missing files.
MissingOutputException in rule checkv_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.checkv.smk, line 38:
Job 303  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/checkv/quality_summary.tsv
[Thu Nov 23 10:54:58 2023]
Finished job 226.
496 of 759 steps (65%) done

[Thu Nov 23 10:54:58 2023]
rule flye:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_33_1_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/flye.log
    log: ../nanopore/nanoporeSDSU.spae.out/logs/flye.Ecoli_33_1.log
    jobid: 57
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/flye.Ecoli_33_1.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/flye.log, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly_graph.gfa; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_33_1_S.subsampled.fastq.gz
    wildcards: sample=Ecoli_33_1
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if flye             --nano-hq             ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_33_1_S.subsampled.fastq.gz             --threads 32              --asm-coverage 50             --genome-size 44k             --out-dir ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr             2> ../nanopore/nanoporeSDSU.spae.out/logs/flye.Ecoli_33_1.log; then
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/flye.log
            else
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly.fasta
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly_graph.gfa
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly_info.txt
                touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/flye.log
        fi
        

Activating conda environment: sphae/workflow/conda/e3ff9c3d87005289bde76110d8ccdc5d_
[Thu Nov 23 10:54:59 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_4_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-1_4.log
    jobid: 114
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.CS-1_4.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_4_S.subsampled.fastq.gz, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly.fasta
    wildcards: sample=CS-1_4
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_4_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-1_4.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:54:59 2023]
Finished job 57.
497 of 759 steps (65%) done
Select jobs to execute...

[Thu Nov 23 10:54:59 2023]
localrule summarize_longread:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/flye.log
    output: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33_1-sr/Ecoli_33_1_summary.txt
    log: ../nanopore/nanoporeSDSU.spae.out/logs/final_summary.Ecoli_33_1.log
    jobid: 750
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33_1-sr/Ecoli_33_1_summary.txt; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/flye.log
    wildcards: sample=Ecoli_33_1
    resources: tmpdir=/local/nala0006/2279907


        #first checking if the assembly worked
        if tail -n 1 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/flye.log | grep 'INFO: Final assembly:' ; then

            if [[ -f "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33_1-sr/Ecoli_33_1-genome-candidates.csv" ]]; then
                line_count=$(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33_1-sr/Ecoli_33_1-genome-candidates.csv")
                if [ "$line_count" -gt 1 ]; then
                    #copying  the final files over
                    if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33_1-sr/Ecoli_33_1_dnaapler_reoriented.fasta ]]; then
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33_1-sr/Ecoli_33_1_dnaapler_reoriented.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33_1-sr/Ecoli_33_1_genome.fasta
                    else
                        cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33_1-sr/Ecoli_33_1.fasta ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33_1-sr/Ecoli_33_1_genome.fasta
                    fi
                

                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33_1-sr/phynteny/phynteny.gbk ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33_1-sr/Ecoli_33_1.gbk
                    cp -r ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33_1-sr/Ecoli_33_1_pharokka_plot.png ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33_1-sr/Ecoli_33_1_pharokka_plot.png

                    echo "Sample: $(sed -n '2p' ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33_1-sr/Ecoli_33_1-genome-candidates.csv | cut -d ',' -f 2)" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33_1-sr/Ecoli_33_1_summary.txt
                    
                    line_count=$(wc -l < ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33_1-sr/Ecoli_33_1-genome-candidates.csv)

                    if [ "$line_count" -gt 2 ]; then
                        echo "Genome is incomplete or contaminated, includes mutliple contigs" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33_1-sr/Ecoli_33_1_summary.txt
                    else
                        echo "Length: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33_1-sr/Ecoli_33_1-genome-candidates.csv | cut -d ',' -f 13)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33_1-sr/Ecoli_33_1_summary.txt
                        echo "Coding density: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33_1-sr/Ecoli_33_1_length_gc_cds_density.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33_1-sr/Ecoli_33_1_summary.txt
                        echo "Circular: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33_1-sr/Ecoli_33_1-genome-candidates.csv | cut -d ',' -f 14)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33_1-sr/Ecoli_33_1_summary.txt
                        echo "Completeness: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33_1-sr/Ecoli_33_1-genome-candidates.csv | cut -d ',' -f 21)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33_1-sr/Ecoli_33_1_summary.txt
                        echo "Contamination: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/genome/Ecoli_33_1-sr/Ecoli_33_1-genome-candidates.csv | cut -d ',' -f 23)" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33_1-sr/Ecoli_33_1_summary.txt
                        echo "Accession: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33_1-sr/Ecoli_33_1_top_hits_mash_inphared.tsv | cut -f 2 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33_1-sr/Ecoli_33_1_summary.txt
                        echo "Taxa mash hits: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33_1-sr/Ecoli_33_1_top_hits_mash_inphared.tsv | cut -f 5 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33_1-sr/Ecoli_33_1_summary.txt
                        echo "Taxa_Name: $(tail -n +2 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33_1-sr/Ecoli_33_1_top_hits_mash_inphared.tsv | cut -f 6 )" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33_1-sr/Ecoli_33_1_summary.txt
                    fi

                    if grep -q "int" ../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33_1-sr/phynteny/phynteny.gbk; then
                        echo "Integrase found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33_1-sr/Ecoli_33_1_summary.txt
                    else
                        echo "No integrase" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33_1-sr/Ecoli_33_1_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33_1-sr/top_hits_card.tsv") -eq 1 ]]; then
                        echo "No AMR genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33_1-sr/Ecoli_33_1_summary.txt
                    else
                        echo "AMR genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33_1-sr/Ecoli_33_1_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33_1-sr/top_hits_vfdb.tsv") -eq 1 ]]; then
                        echo "No virulence factor genes" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33_1-sr/Ecoli_33_1_summary.txt
                    else
                        echo "Virulence factor genes found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33_1-sr/Ecoli_33_1_summary.txt
                    fi

                    if [[ $(wc -l < "../nanopore/nanoporeSDSU.spae.out/PROCESSING/pharokka/Ecoli_33_1-sr/Ecoli_33_1_minced_spacers.txt") -gt 2 ]]; then
                        echo "CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33_1-sr/Ecoli_33_1_summary.txt
                    else
                        echo "No CRISPR spacers found" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33_1-sr/Ecoli_33_1_summary.txt
                    fi
                else
                    #this is if the assembly is too fragmented
                    echo "Sample: Ecoli_33_1" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33_1-sr/Ecoli_33_1_summary.txt
                    echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33_1-sr/Ecoli_33_1_summary.txt
                fi
            
            else
                #this is if the assembly is too fragmented
                echo "Sample: Ecoli_33_1" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33_1-sr/Ecoli_33_1_summary.txt
                echo "Assembly likely too fragmented or none of the contigs were assigned viral" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33_1-sr/Ecoli_33_1_summary.txt
            fi
        
        else
            #this is if the assembly failed then
            echo "Sample: Ecoli_33_1" > ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33_1-sr/Ecoli_33_1_summary.txt
            echo "Failed during assembly" >> ../nanopore/nanoporeSDSU.spae.out/RESULTS/Ecoli_33_1-sr/Ecoli_33_1_summary.txt
        fi
        

[Thu Nov 23 10:54:59 2023]
rule viralverify_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly.fasta, /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly_result_table.csv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Ecoli_33_1.log
    jobid: 237
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/viralverify_flye_nano.Ecoli_33_1.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly_result_table.csv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly.fasta
    wildcards: sample=Ecoli_33_1
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly.fasta ]]
        then
            viralverify                 -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly.fasta                 --hmm /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/Pfam35.0/Pfam-A.hmm.gz                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/viralverify_flye_nano.Ecoli_33_1.log
        fi
        
Activating conda environment: sphae/workflow/conda/d9cd3342e36b62c24e780b9d55be160e_

[Thu Nov 23 10:54:59 2023]
rule checkv_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly.fasta
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/checkv/quality_summary.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Ecoli_33_1.log
    jobid: 309
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/checkv_flye_nano.Ecoli_33_1.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/checkv/quality_summary.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly.fasta
    wildcards: sample=Ecoli_33_1
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480


        export CHECKVDB=/scratch/user/nala0006/spae-paper/sphae/sphae/workflow/databases/checkv-db-v1.5
        if [[ -s ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly.fasta ]]
        then
            checkv end_to_end                ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly.fasta                 ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/checkv                 -t 8                 &> ../nanopore/nanoporeSDSU.spae.out/logs/checkv_flye_nano.Ecoli_33_1.log
        fi
        
Activating conda environment: sphae/workflow/conda/a4d2d492cde88381b68d5529e4f01bae_

[Thu Nov 23 10:54:59 2023]
rule components_flye_nano:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly_graph.gfa, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly_info.txt
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/graph_seq_details_flye.tsv
    log: ../nanopore/nanoporeSDSU.spae.out/logs/components_flye_nano.Ecoli_33_1.log
    jobid: 238
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/components_flye_nano.Ecoli_33_1.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/graph_seq_details_flye.tsv; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly_info.txt, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly_graph.gfa
    wildcards: sample=Ecoli_33_1
    threads: 8
    resources: tmpdir=/local/nala0006/2279907, mem_mb=16000, mem_mib=15259, time=480

python -c "from __future__ import print_function; import sys, json; print(json.dumps([sys.version_info.major, sys.version_info.minor]))"
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:54:59 2023]
Finished job 750.
498 of 759 steps (66%) done
Select jobs to execute...
Waiting at most 5 seconds for missing files.
python /scratch/user/nala0006/spae-paper/sphae/.snakemake/scripts/tmp4ju5r4b0.components.py
Activating conda environment: sphae/workflow/conda/34295c2554fefa68c17c056cf86a9e1a_
[Thu Nov 23 10:55:01 2023]
Error in rule medaka:
    jobid: 114
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_4_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-1_4.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/CS-1_4_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-1_4.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/consensus.fasta
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/medaka.CS-1_4.log:
================================================================================
[10:55:01 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmpu7cdotry.
[10:55:01 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmp2c_8t1gl.
Creating fai index file /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly.fasta.fai
[faidx] Could not build fai index /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/CS-1_4-sr/assembly.fasta.fai
================================================================================

MissingOutputException in rule viralverify_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.viralverify.smk, line 37:
Job 237  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly_result_table.csv
Waiting at most 5 seconds for missing files.
MissingOutputException in rule checkv_flye_nano in file /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/rules/5.checkv.smk, line 38:
Job 309  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/checkv/quality_summary.tsv
[Thu Nov 23 10:55:10 2023]
Finished job 238.
499 of 759 steps (66%) done

[Thu Nov 23 10:55:10 2023]
rule medaka:
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_33_1_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ecoli_33_1.log
    jobid: 120
    benchmark: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/bench/medaka.Ecoli_33_1.txt
    reason: Missing output files: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/consensus.fasta; Input files updated by another job: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_33_1_S.subsampled.fastq.gz
    wildcards: sample=Ecoli_33_1
    threads: 32
    resources: tmpdir=/local/nala0006/2279907, mem_mb=64000, mem_mib=61036, time=480


        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_33_1_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ecoli_33_1.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/consensus.fasta
        fi
        
Activating conda environment: sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
[Thu Nov 23 10:55:12 2023]
Error in rule medaka:
    jobid: 120
    input: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly.fasta, ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_33_1_S.subsampled.fastq.gz
    output: ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/consensus.fasta
    log: ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ecoli_33_1.log (check log file(s) for error details)
    conda-env: /scratch/user/nala0006/spae-paper/sphae/sphae/workflow/conda/2c939cb56b3d22c5781e34f0c34d8112_
    shell:
        
        if [[ -f ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly.fasta ]]; then
            medaka_consensus                 -i ../nanopore/nanoporeSDSU.spae.out/PROCESSING/results/filtlong/Ecoli_33_1_S.subsampled.fastq.gz                 -d ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly.fasta                 -o ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr                 -m r1041_e82_400bps_sup_v4.2.0                 -t 32                 2> ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ecoli_33_1.log
        else
            touch ../nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/consensus.fasta
        fi
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
Logfile ../nanopore/nanoporeSDSU.spae.out/logs/medaka.Ecoli_33_1.log:
================================================================================
[10:55:12 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmp02hgafoq.
[10:55:12 - MdlStrTF] Successfully removed temporary files from /local/nala0006/2279907/tmp5zpk84jo.
Creating fai index file /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly.fasta.fai
[faidx] Could not build fai index /scratch/user/nala0006/spae-paper/nanopore/nanoporeSDSU.spae.out/PROCESSING/assembly/flye/Ecoli_33_1-sr/assembly.fasta.fai
================================================================================

Exiting because a job execution failed. Look above for error message
Complete log: .snakemake/log/2023-11-23T094630.957470.snakemake.log
[2023:11:23 10:55:13] ERROR: Snakemake failed
